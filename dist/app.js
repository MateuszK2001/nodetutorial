/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/app.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./middleware/isAuth.ts":
/*!******************************!*\
  !*** ./middleware/isAuth.ts ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ((req, res, next) => {\r\n    if (!req.user) {\r\n        return res.redirect('/login');\r\n    }\r\n    next();\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9taWRkbGV3YXJlL2lzQXV0aC50cz8wM2Q0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBO0FBQWUsZ0VBQUMsR0FBVyxFQUFFLEdBQVksRUFBRSxJQUFpQixFQUFDLEVBQUU7SUFDM0QsSUFBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUM7UUFDVCxPQUFPLEdBQUcsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7S0FDakM7SUFDRCxJQUFJLEVBQUUsQ0FBQztBQUNYLENBQUMiLCJmaWxlIjoiLi9taWRkbGV3YXJlL2lzQXV0aC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7UmVxdWVzdCwgUmVzcG9uc2UsIE5leHRGdW5jdGlvbn0gZnJvbSAnZXhwcmVzcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAocmVxOlJlcXVlc3QsIHJlczpSZXNwb25zZSwgbmV4dDpOZXh0RnVuY3Rpb24pPT57XHJcbiAgICBpZighcmVxLnVzZXIpe1xyXG4gICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy9sb2dpbicpO1xyXG4gICAgfVxyXG4gICAgbmV4dCgpO1xyXG59XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./middleware/isAuth.ts\n");

/***/ }),

/***/ "./middleware/isNotAuth.ts":
/*!*********************************!*\
  !*** ./middleware/isNotAuth.ts ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ((redirectPath) => (req, res, next) => {\r\n    if (req.user) {\r\n        return res.redirect(redirectPath);\r\n    }\r\n    next();\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9taWRkbGV3YXJlL2lzTm90QXV0aC50cz81NjEzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBO0FBQWUsZ0VBQUMsWUFBbUIsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUMsRUFBRTtJQUNwRixJQUFHLEdBQUcsQ0FBQyxJQUFJLEVBQUM7UUFDUixPQUFPLEdBQUcsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7S0FDckM7SUFDRCxJQUFJLEVBQUUsQ0FBQztBQUNYLENBQUMiLCJmaWxlIjoiLi9taWRkbGV3YXJlL2lzTm90QXV0aC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7UmVxdWVzdCwgUmVzcG9uc2UsIE5leHRGdW5jdGlvbn0gZnJvbSAnZXhwcmVzcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAocmVkaXJlY3RQYXRoOnN0cmluZykgPT4gKHJlcTpSZXF1ZXN0LCByZXM6UmVzcG9uc2UsIG5leHQ6TmV4dEZ1bmN0aW9uKT0+e1xyXG4gICAgaWYocmVxLnVzZXIpe1xyXG4gICAgICAgIHJldHVybiByZXMucmVkaXJlY3QocmVkaXJlY3RQYXRoKTtcclxuICAgIH1cclxuICAgIG5leHQoKTtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./middleware/isNotAuth.ts\n");

/***/ }),

/***/ "./src/app.ts":
/*!********************!*\
  !*** ./src/app.ts ***!
  \********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dotenv */ \"dotenv\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var body_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! body-parser */ \"body-parser\");\n/* harmony import */ var body_parser__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(body_parser__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _routes_admin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./routes/admin */ \"./src/routes/admin.ts\");\n/* harmony import */ var _routes_shop__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./routes/shop */ \"./src/routes/shop.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./models/User */ \"./src/models/User.ts\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _controllers_errors__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./controllers/errors */ \"./src/controllers/errors.ts\");\n/* harmony import */ var _routes_auth__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./routes/auth */ \"./src/routes/auth.ts\");\n/* harmony import */ var express_session__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! express-session */ \"express-session\");\n/* harmony import */ var express_session__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(express_session__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var connect_mongodb_session__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! connect-mongodb-session */ \"connect-mongodb-session\");\n/* harmony import */ var connect_mongodb_session__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(connect_mongodb_session__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var csurf__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! csurf */ \"csurf\");\n/* harmony import */ var csurf__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(csurf__WEBPACK_IMPORTED_MODULE_12__);\n/* harmony import */ var connect_flash__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! connect-flash */ \"connect-flash\");\n/* harmony import */ var connect_flash__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(connect_flash__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @sendgrid/mail */ \"@sendgrid/mail\");\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(_sendgrid_mail__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! multer */ \"multer\");\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(multer__WEBPACK_IMPORTED_MODULE_15__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\nObject(dotenv__WEBPACK_IMPORTED_MODULE_0__[\"config\"])();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst MongoDBStore = connect_mongodb_session__WEBPACK_IMPORTED_MODULE_11___default()(express_session__WEBPACK_IMPORTED_MODULE_10___default.a);\r\n\r\n\r\n\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI;\r\n_sendgrid_mail__WEBPACK_IMPORTED_MODULE_14___default.a.setApiKey(process.env.SENDGRID_API_KEY);\r\nconst app = express__WEBPACK_IMPORTED_MODULE_2___default()();\r\nconst store = new MongoDBStore({\r\n    uri: MONGODB_URI,\r\n    collection: 'sessions',\r\n});\r\napp.set('view engine', 'ejs');\r\napp.set('views', Object(path__WEBPACK_IMPORTED_MODULE_1__[\"resolve\"])('views'));\r\nconst fileStorage = multer__WEBPACK_IMPORTED_MODULE_15___default.a.diskStorage({\r\n    destination: (req, file, cb) => {\r\n        cb(null, 'images');\r\n    },\r\n    filename: (req, file, cb) => {\r\n        cb(null, `${file.originalname}`);\r\n    },\r\n});\r\napp.use(body_parser__WEBPACK_IMPORTED_MODULE_3___default.a.urlencoded({ extended: true }));\r\napp.use(multer__WEBPACK_IMPORTED_MODULE_15___default()({\r\n    storage: fileStorage,\r\n    fileFilter: (req, file, cb) => {\r\n        const accept = ['image/png', 'image/jpg', 'image/jpeg'].includes(file.mimetype);\r\n        cb(null, accept);\r\n    }\r\n}).single('image'));\r\napp.use(express__WEBPACK_IMPORTED_MODULE_2___default.a.static(Object(path__WEBPACK_IMPORTED_MODULE_1__[\"resolve\"])('public')));\r\napp.use(express_session__WEBPACK_IMPORTED_MODULE_10___default()({\r\n    secret: 'my secret',\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    store\r\n}));\r\napp.use(csurf__WEBPACK_IMPORTED_MODULE_12___default()());\r\napp.use((err, req, res, next) => {\r\n    if (err.code !== 'EBADCSRFTOKEN')\r\n        return next(err);\r\n    // handle CSRF token errors here\r\n    res.status(403);\r\n    res.send('form tampered with');\r\n});\r\napp.use(connect_flash__WEBPACK_IMPORTED_MODULE_13___default()());\r\napp.use((req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    if (req.session.userId) {\r\n        const user = yield _models_User__WEBPACK_IMPORTED_MODULE_6__[\"default\"].findById(req.session.userId);\r\n        if (!user) {\r\n            console.log(\"ERROR: nie istnieje user!!!\");\r\n            next(new Error('ERROR: nie istnieje user!!!'));\r\n            return;\r\n        }\r\n        req.user = user;\r\n    }\r\n    next();\r\n}));\r\n// app.use((req, res, next)=>{\r\n//     res.locals\r\n// });\r\napp.use('/admin', _routes_admin__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\r\napp.use(_routes_shop__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\napp.use(_routes_auth__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\r\napp.use(_controllers_errors__WEBPACK_IMPORTED_MODULE_8__[\"use500\"]);\r\napp.use(_controllers_errors__WEBPACK_IMPORTED_MODULE_8__[\"use404\"]);\r\nconst start = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    try {\r\n        yield mongoose__WEBPACK_IMPORTED_MODULE_7___default.a.connect(MONGODB_URI, {\r\n            useNewUrlParser: true,\r\n            useUnifiedTopology: true\r\n        });\r\n        if (!(yield _models_User__WEBPACK_IMPORTED_MODULE_6__[\"default\"].findOne())) {\r\n            const user = new _models_User__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({\r\n                name: 'Max',\r\n                email: 'max@test.com',\r\n                cart: {\r\n                    products: []\r\n                }\r\n            });\r\n            yield user.save();\r\n        }\r\n        app.listen(3000);\r\n    }\r\n    catch (error) {\r\n        console.log(\"ERROR\", error.message);\r\n    }\r\n});\r\nstart();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYXBwLnRzPzA2NmUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUM3QyxxREFBWSxFQUFFLENBQUM7QUFFZ0I7QUFDb0M7QUFDOUI7QUFDSTtBQUNGO0FBQ0s7QUFDWjtBQUN5QjtBQUNsQjtBQUNEO0FBRW9CO0FBQzFELE1BQU0sWUFBWSxHQUFHLCtEQUFtQixDQUFDLHVEQUFPLENBQUMsQ0FBQztBQUN6QjtBQUNTO0FBQ0k7QUFDVjtBQWU1QixNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVksQ0FBQztBQUM3QyxzREFBUSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFpQixDQUFDLENBQUM7QUFFbEQsTUFBTSxHQUFHLEdBQUcsOENBQU8sRUFBRSxDQUFDO0FBRXRCLE1BQU0sS0FBSyxHQUFHLElBQUksWUFBWSxDQUFDO0lBQzNCLEdBQUcsRUFBRSxXQUFXO0lBQ2hCLFVBQVUsRUFBRSxVQUFVO0NBQ3pCLENBQUMsQ0FBQztBQUdILEdBQUcsQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQzlCLEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLG9EQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUVuQyxNQUFNLFdBQVcsR0FBRyw4Q0FBTSxDQUFDLFdBQVcsQ0FBQztJQUNuQyxXQUFXLEVBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBQyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDdkIsQ0FBQztJQUNELFFBQVEsRUFBRSxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFDLEVBQUU7UUFDdkIsRUFBRSxDQUFDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7Q0FDSixDQUFDLENBQUM7QUFFSCxHQUFHLENBQUMsR0FBRyxDQUFDLGtEQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztBQUNuRCxHQUFHLENBQUMsR0FBRyxDQUFDLDhDQUFNLENBQUM7SUFDWCxPQUFPLEVBQUUsV0FBVztJQUNwQixVQUFVLEVBQUUsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBQyxFQUFFO1FBQ3pCLE1BQU0sTUFBTSxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hGLEVBQUUsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDO0lBQ3BCLENBQUM7Q0FDSixDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFDcEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyw4Q0FBTyxDQUFDLE1BQU0sQ0FBQyxvREFBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzQyxHQUFHLENBQUMsR0FBRyxDQUFDLHVEQUFPLENBQUM7SUFDWixNQUFNLEVBQUUsV0FBVztJQUNuQixNQUFNLEVBQUUsS0FBSztJQUNiLGlCQUFpQixFQUFFLEtBQUs7SUFDeEIsS0FBSztDQUNSLENBQUMsQ0FBQyxDQUFDO0FBQ0osR0FBRyxDQUFDLEdBQUcsQ0FBQyw2Q0FBSSxFQUFFLENBQUMsQ0FBQztBQUNoQixHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBTyxFQUFFLEdBQVcsRUFBRSxHQUFZLEVBQUUsSUFBaUIsRUFBQyxFQUFFO0lBQzdELElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxlQUFlO1FBQUUsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDO0lBRWxELGdDQUFnQztJQUNoQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztJQUNmLEdBQUcsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUM7QUFDaEMsQ0FBQyxDQUFDO0FBRUosR0FBRyxDQUFDLEdBQUcsQ0FBQyxxREFBSyxFQUFFLENBQUMsQ0FBQztBQUVqQixHQUFHLENBQUMsR0FBRyxDQUFDLENBQU8sR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRTtJQUM3QixJQUFHLEdBQUcsQ0FBQyxPQUFRLENBQUMsTUFBTSxFQUFDO1FBQ25CLE1BQU0sSUFBSSxHQUFHLE1BQU0sb0RBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN0RCxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1lBQzNDLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDLENBQUM7WUFDL0MsT0FBTztTQUNWO1FBQ0QsR0FBRyxDQUFDLElBQUksR0FBRyxJQUFLLENBQUM7S0FDcEI7SUFDRCxJQUFJLEVBQUUsQ0FBQztBQUNYLENBQUMsRUFBQyxDQUFDO0FBQ0gsOEJBQThCO0FBQzlCLGlCQUFpQjtBQUNqQixNQUFNO0FBQ04sR0FBRyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUscURBQVcsQ0FBQyxDQUFDO0FBQy9CLEdBQUcsQ0FBQyxHQUFHLENBQUMsb0RBQVUsQ0FBQyxDQUFDO0FBQ3BCLEdBQUcsQ0FBQyxHQUFHLENBQUMsb0RBQVUsQ0FBQyxDQUFDO0FBRXBCLEdBQUcsQ0FBQyxHQUFHLENBQUMsMERBQXVCLENBQUMsQ0FBQztBQUNqQyxHQUFHLENBQUMsR0FBRyxDQUFDLDBEQUF1QixDQUFDLENBQUM7QUFHakMsTUFBTSxLQUFLLEdBQUcsR0FBUyxFQUFFO0lBQ3JCLElBQUk7UUFDQSxNQUFNLCtDQUFRLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRTtZQUNoQyxlQUFlLEVBQUUsSUFBSTtZQUNyQixrQkFBa0IsRUFBRSxJQUFJO1NBQzNCLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxDQUFDLE1BQU0sb0RBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxFQUFFO1lBQ3pCLE1BQU0sSUFBSSxHQUFHLElBQUksb0RBQUksQ0FBQztnQkFDbEIsSUFBSSxFQUFFLEtBQUs7Z0JBQ1gsS0FBSyxFQUFFLGNBQWM7Z0JBQ3JCLElBQUksRUFBRTtvQkFDRixRQUFRLEVBQUUsRUFBRTtpQkFDZjthQUNKLENBQUMsQ0FBQztZQUNILE1BQU0sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ3JCO1FBQ0QsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNwQjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ1osT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUcsS0FBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQ2xEO0FBQ0wsQ0FBQyxFQUFDO0FBQ0YsS0FBSyxFQUFFLENBQUMiLCJmaWxlIjoiLi9zcmMvYXBwLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtjb25maWcgYXMgZG90ZW52Q29uZmlnfSBmcm9tJ2RvdGVudic7XHJcbmRvdGVudkNvbmZpZygpO1xyXG5cclxuaW1wb3J0IHsgcmVzb2x2ZSB9IGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgZXhwcmVzcywgeyBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCBib2R5UGFyc2VyIGZyb20gJ2JvZHktcGFyc2VyJztcclxuaW1wb3J0IGFkbWluUm91dGVyIGZyb20gJy4vcm91dGVzL2FkbWluJztcclxuaW1wb3J0IHNob3BSb3V0ZXIgZnJvbSAnLi9yb3V0ZXMvc2hvcCc7XHJcbmltcG9ydCBVc2VyLCB7IElVc2VyIH0gZnJvbSAnLi9tb2RlbHMvVXNlcic7XHJcbmltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XHJcbmltcG9ydCAqIGFzIGVycm9yc0NvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVycy9lcnJvcnMnO1xyXG5pbXBvcnQgYXV0aFJvdXRlciBmcm9tICcuL3JvdXRlcy9hdXRoJztcclxuaW1wb3J0IHNlc3Npb24gZnJvbSAnZXhwcmVzcy1zZXNzaW9uJztcclxuaW1wb3J0ICogYXMgRXhwcmVzcyBmcm9tICdleHByZXNzJztcclxuaW1wb3J0IGNvbm5lY3RNb25nb1Nlc3Npb24gZnJvbSAnY29ubmVjdC1tb25nb2RiLXNlc3Npb24nO1xyXG5jb25zdCBNb25nb0RCU3RvcmUgPSBjb25uZWN0TW9uZ29TZXNzaW9uKHNlc3Npb24pO1xyXG5pbXBvcnQgY3NyZiBmcm9tICdjc3VyZic7XHJcbmltcG9ydCBmbGFzaCBmcm9tICdjb25uZWN0LWZsYXNoJztcclxuaW1wb3J0IHNlbmRncmlkIGZyb20gJ0BzZW5kZ3JpZC9tYWlsJztcclxuaW1wb3J0IG11bHRlciBmcm9tICdtdWx0ZXInO1xyXG5cclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgbmFtZXNwYWNlIEV4cHJlc3Mge1xyXG4gICAgICAgIGludGVyZmFjZSBSZXF1ZXN0IHtcclxuICAgICAgICAgICAgdXNlcj86IElVc2VyO1xyXG4gICAgICAgICAgICBpc0xvZ2dlZEluOiBib29sZWFuO1xyXG4gICAgICAgICAgICBjc3JmVG9rZW46ICgpPT5zdHJpbmc7IFxyXG4gICAgICAgIH1cclxuICAgICAgICBpbnRlcmZhY2UgU2Vzc2lvbiB7XHJcbiAgICAgICAgICAgIGlzTG9nZ2VkSW4/OiBib29sZWFuLFxyXG4gICAgICAgICAgICB1c2VySWQ/OnN0cmluZztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSSE7XHJcbnNlbmRncmlkLnNldEFwaUtleShwcm9jZXNzLmVudi5TRU5ER1JJRF9BUElfS0VZISk7XHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcblxyXG5jb25zdCBzdG9yZSA9IG5ldyBNb25nb0RCU3RvcmUoe1xyXG4gICAgdXJpOiBNT05HT0RCX1VSSSxcclxuICAgIGNvbGxlY3Rpb246ICdzZXNzaW9ucycsXHJcbn0pO1xyXG5cclxuXHJcbmFwcC5zZXQoJ3ZpZXcgZW5naW5lJywgJ2VqcycpO1xyXG5hcHAuc2V0KCd2aWV3cycsIHJlc29sdmUoJ3ZpZXdzJykpO1xyXG5cclxuY29uc3QgZmlsZVN0b3JhZ2UgPSBtdWx0ZXIuZGlza1N0b3JhZ2Uoe1xyXG4gICAgZGVzdGluYXRpb246KHJlcSwgZmlsZSwgY2IpPT57XHJcbiAgICAgICAgY2IobnVsbCwgJ2ltYWdlcycpO1xyXG4gICAgfSxcclxuICAgIGZpbGVuYW1lOiAocmVxLCBmaWxlLCBjYik9PntcclxuICAgICAgICBjYihudWxsLCBgJHtmaWxlLm9yaWdpbmFsbmFtZX1gKTtcclxuICAgIH0sXHJcbn0pO1xyXG5cclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbmFwcC51c2UobXVsdGVyKHtcclxuICAgIHN0b3JhZ2U6IGZpbGVTdG9yYWdlLCBcclxuICAgIGZpbGVGaWx0ZXI6IChyZXEsIGZpbGUsIGNiKT0+e1xyXG4gICAgICAgIGNvbnN0IGFjY2VwdCA9IFsnaW1hZ2UvcG5nJywgJ2ltYWdlL2pwZycsICdpbWFnZS9qcGVnJ10uaW5jbHVkZXMoZmlsZS5taW1ldHlwZSk7XHJcbiAgICAgICAgY2IobnVsbCwgYWNjZXB0KVxyXG4gICAgfVxyXG59KS5zaW5nbGUoJ2ltYWdlJykpO1xyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKHJlc29sdmUoJ3B1YmxpYycpKSk7XHJcbmFwcC51c2Uoc2Vzc2lvbih7XHJcbiAgICBzZWNyZXQ6ICdteSBzZWNyZXQnLFxyXG4gICAgcmVzYXZlOiBmYWxzZSxcclxuICAgIHNhdmVVbmluaXRpYWxpemVkOiBmYWxzZSxcclxuICAgIHN0b3JlXHJcbn0pKTtcclxuYXBwLnVzZShjc3JmKCkpO1xyXG5hcHAudXNlKChlcnI6YW55LCByZXE6UmVxdWVzdCwgcmVzOlJlc3BvbnNlLCBuZXh0Ok5leHRGdW5jdGlvbik9PiB7XHJcbiAgICBpZiAoZXJyLmNvZGUgIT09ICdFQkFEQ1NSRlRPS0VOJykgcmV0dXJuIG5leHQoZXJyKVxyXG4gIFxyXG4gICAgLy8gaGFuZGxlIENTUkYgdG9rZW4gZXJyb3JzIGhlcmVcclxuICAgIHJlcy5zdGF0dXMoNDAzKVxyXG4gICAgcmVzLnNlbmQoJ2Zvcm0gdGFtcGVyZWQgd2l0aCcpXHJcbiAgfSlcclxuXHJcbmFwcC51c2UoZmxhc2goKSk7XHJcblxyXG5hcHAudXNlKGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gICAgaWYocmVxLnNlc3Npb24hLnVzZXJJZCl7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnNlc3Npb24hLnVzZXJJZCk7XHJcbiAgICAgICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IG5pZSBpc3RuaWVqZSB1c2VyISEhXCIpO1xyXG4gICAgICAgICAgICBuZXh0KG5ldyBFcnJvcignRVJST1I6IG5pZSBpc3RuaWVqZSB1c2VyISEhJykpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlcS51c2VyID0gdXNlciE7XHJcbiAgICB9XHJcbiAgICBuZXh0KCk7XHJcbn0pO1xyXG4vLyBhcHAudXNlKChyZXEsIHJlcywgbmV4dCk9PntcclxuLy8gICAgIHJlcy5sb2NhbHNcclxuLy8gfSk7XHJcbmFwcC51c2UoJy9hZG1pbicsIGFkbWluUm91dGVyKTtcclxuYXBwLnVzZShzaG9wUm91dGVyKTtcclxuYXBwLnVzZShhdXRoUm91dGVyKTtcclxuXHJcbmFwcC51c2UoZXJyb3JzQ29udHJvbGxlci51c2U1MDApO1xyXG5hcHAudXNlKGVycm9yc0NvbnRyb2xsZXIudXNlNDA0KTtcclxuXHJcblxyXG5jb25zdCBzdGFydCA9IGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSSSwge1xyXG4gICAgICAgICAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXHJcbiAgICAgICAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICghKGF3YWl0IFVzZXIuZmluZE9uZSgpKSkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXIoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ01heCcsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogJ21heEB0ZXN0LmNvbScsXHJcbiAgICAgICAgICAgICAgICBjYXJ0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHM6IFtdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXBwLmxpc3RlbigzMDAwKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUlwiLCAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG59O1xyXG5zdGFydCgpO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/app.ts\n");

/***/ }),

/***/ "./src/controllers/admin.ts":
/*!**********************************!*\
  !*** ./src/controllers/admin.ts ***!
  \**********************************/
/*! exports provided: getAddProduct, postAddProduct, getAdminProducts, getEditProduct, postEditProduct, postDeleteProduct */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAddProduct\", function() { return getAddProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postAddProduct\", function() { return postAddProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAdminProducts\", function() { return getAdminProducts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEditProduct\", function() { return getEditProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postEditProduct\", function() { return postEditProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postDeleteProduct\", function() { return postDeleteProduct; });\n/* harmony import */ var _models_product__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/product */ \"./src/models/product.ts\");\n/* harmony import */ var _util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/ResponseHelper */ \"./src/util/ResponseHelper.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../models/User */ \"./src/models/User.ts\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_3__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\nconst getAddProduct = (req, res, next) => {\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"renderHelper\"])(req, res, 'admin/edit-product', {\r\n        docTitle: 'Add Product',\r\n        path: 'admin/add-product'\r\n    });\r\n};\r\nconst postAddProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    var _a, _b;\r\n    const errors = Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"getValidationMsg\"])(req);\r\n    if (errors) {\r\n        Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"renderHelper\"])(req, res.status(422), 'admin/edit-product', Object.assign({ docTitle: 'Add Product', path: 'admin/add-product', product: {\r\n                title: req.body.title,\r\n                description: req.body.description,\r\n                price: req.body.price,\r\n                imageUrl: (_a = req === null || req === void 0 ? void 0 : req.file) === null || _a === void 0 ? void 0 : _a.path,\r\n            } }, errors));\r\n        return;\r\n    }\r\n    yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create({\r\n        title: req.body.title,\r\n        price: Number(req.body.price),\r\n        description: req.body.description,\r\n        imageUrl: ((_b = req === null || req === void 0 ? void 0 : req.file) === null || _b === void 0 ? void 0 : _b.path) || undefined,\r\n        ownerId: req.user._id\r\n    });\r\n    res.redirect('/');\r\n});\r\nconst getAdminProducts = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].find({ ownerId: req.user._id });\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"renderHelper\"])(req, res, 'admin/products', {\r\n        products: products,\r\n        docTitle: 'Admin Products',\r\n    });\r\n});\r\nconst getEditProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.params.id;\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({ _id: id, ownerId: req.user._id });\r\n    if (!product) {\r\n        console.log(\"ERROR: admin: getEditProduct --- product not found\");\r\n        res.redirect('/admin/products');\r\n        return;\r\n    }\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"renderHelper\"])(req, res, 'admin/edit-product', {\r\n        docTitle: 'Edit product',\r\n        editingMode: true,\r\n        product: product\r\n    });\r\n});\r\nconst postEditProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    var _c, _d;\r\n    const id = req.params.id;\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({ _id: id, ownerId: req.user._id });\r\n    if (!product) {\r\n        console.log(\"ERROR: admin: postEditProduct --- product not found\");\r\n        res.redirect('/admin/products');\r\n        return;\r\n    }\r\n    const errors = Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"getValidationMsg\"])(req);\r\n    if (errors) {\r\n        return Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_1__[\"renderHelper\"])(req, res, 'admin/edit-product', Object.assign({ docTitle: 'Edit product', editingMode: true, product: {\r\n                _id: id,\r\n                title: req.body.title,\r\n                price: req.body.price,\r\n                imageUrl: (_c = req === null || req === void 0 ? void 0 : req.file) === null || _c === void 0 ? void 0 : _c.path,\r\n                description: req.body.description\r\n            } }, errors));\r\n    }\r\n    product.title = req.body.title;\r\n    product.price = Number(req.body.price);\r\n    product.description = req.body.description;\r\n    product.imageUrl = (_d = req === null || req === void 0 ? void 0 : req.file) === null || _d === void 0 ? void 0 : _d.path;\r\n    yield product.save();\r\n    res.redirect('/admin/products');\r\n});\r\nconst postDeleteProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.params.id;\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({ _id: id, ownerId: req.user._id });\r\n    if (!product) {\r\n        res.redirect('/admin/products');\r\n        return;\r\n    }\r\n    yield product.remove();\r\n    yield _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].updateMany({}, { $pull: { 'cart.products': { 'productId': new mongoose__WEBPACK_IMPORTED_MODULE_3__[\"Types\"].ObjectId(id) } } }, { multi: true });\r\n    res.redirect('/admin/products');\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvYWRtaW4udHM/NmU5MiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDc0Q7QUFDa0I7QUFDdEM7QUFDRDtBQUkxQixNQUFNLGFBQWEsR0FBRyxDQUFDLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQzdFLHlFQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxvQkFBb0IsRUFBRTtRQUN6QyxRQUFRLEVBQUUsYUFBYTtRQUN2QixJQUFJLEVBQUUsbUJBQW1CO0tBQzVCLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQUNLLE1BQU0sY0FBYyxHQUFHLENBQU8sR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7O0lBQ3BGLE1BQU0sTUFBTSxHQUFHLDZFQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3JDLElBQUcsTUFBTSxFQUFDO1FBQ04seUVBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxvQkFBb0Isa0JBQ25ELFFBQVEsRUFBRSxhQUFhLEVBQ3ZCLElBQUksRUFBRSxtQkFBbUIsRUFDekIsT0FBTyxFQUFDO2dCQUNKLEtBQUssRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUs7Z0JBQ3JCLFdBQVcsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVc7Z0JBQ2pDLEtBQUssRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUs7Z0JBQ3JCLFFBQVEsUUFBRSxHQUFHLGFBQUgsR0FBRyx1QkFBSCxHQUFHLENBQUUsSUFBSSwwQ0FBRSxJQUFJO2FBQzVCLElBQ0UsTUFBTSxFQUNYLENBQUM7UUFDSCxPQUFRO0tBQ1g7SUFDRCxNQUFNLHVEQUFPLENBQUMsTUFBTSxDQUFDO1FBQ2pCLEtBQUssRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUs7UUFDckIsS0FBSyxFQUFF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QUssRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO0lBRW5CLEdBQUcsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUNwQyxDQUFDIiwiZmlsZSI6Ii4vc3JjL2NvbnRyb2xsZXJzL2FkbWluLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXNwb25zZSwgUmVxdWVzdCB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCBQcm9kdWN0LCB7IElQcm9kdWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9kdWN0XCI7XHJcbmltcG9ydCB7IHJlbmRlckhlbHBlciwgZ2V0VmFsaWRhdGlvbk1zZyB9IGZyb20gXCIuLi91dGlsL1Jlc3BvbnNlSGVscGVyXCI7XHJcbmltcG9ydCBVc2VyIGZyb20gXCIuLi9tb2RlbHMvVXNlclwiO1xyXG5pbXBvcnQgeyBUeXBlcyB9IGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0QWRkUHJvZHVjdCA9IChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnYWRtaW4vZWRpdC1wcm9kdWN0Jywge1xyXG4gICAgICAgIGRvY1RpdGxlOiAnQWRkIFByb2R1Y3QnLFxyXG4gICAgICAgIHBhdGg6ICdhZG1pbi9hZGQtcHJvZHVjdCdcclxuICAgIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcG9zdEFkZFByb2R1Y3QgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGVycm9ycyA9IGdldFZhbGlkYXRpb25Nc2cocmVxKTtcclxuICAgIGlmKGVycm9ycyl7XHJcbiAgICAgICAgcmVuZGVySGVscGVyKHJlcSwgcmVzLnN0YXR1cyg0MjIpLCAnYWRtaW4vZWRpdC1wcm9kdWN0Jywge1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogJ0FkZCBQcm9kdWN0JyxcclxuICAgICAgICAgICAgcGF0aDogJ2FkbWluL2FkZC1wcm9kdWN0JyxcclxuICAgICAgICAgICAgcHJvZHVjdDp7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLmJvZHkudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcmVxLmJvZHkuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBwcmljZTogcmVxLmJvZHkucHJpY2UsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcmVxPy5maWxlPy5wYXRoLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAuLi5lcnJvcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIDtcclxuICAgIH1cclxuICAgIGF3YWl0IFByb2R1Y3QuY3JlYXRlKHtcclxuICAgICAgICB0aXRsZTogcmVxLmJvZHkudGl0bGUsXHJcbiAgICAgICAgcHJpY2U6IE51bWJlcihyZXEuYm9keS5wcmljZSksXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHJlcS5ib2R5LmRlc2NyaXB0aW9uLFxyXG4gICAgICAgIGltYWdlVXJsOiByZXE/LmZpbGU/LnBhdGggfHwgdW5kZWZpbmVkLFxyXG4gICAgICAgIG93bmVySWQ6IHJlcS51c2VyIS5faWRcclxuICAgIH0pO1xyXG4gICAgcmVzLnJlZGlyZWN0KCcvJyk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBnZXRBZG1pblByb2R1Y3RzID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3QuZmluZCh7b3duZXJJZDogcmVxLnVzZXIhLl9pZH0pO1xyXG4gICAgcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnYWRtaW4vcHJvZHVjdHMnLCB7XHJcbiAgICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzLFxyXG4gICAgICAgIGRvY1RpdGxlOiAnQWRtaW4gUHJvZHVjdHMnLFxyXG4gICAgfSk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBnZXRFZGl0UHJvZHVjdCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZE9uZSh7X2lkOiBpZCwgb3duZXJJZDogcmVxLnVzZXIhLl9pZH0pO1xyXG4gICAgaWYgKCFwcm9kdWN0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUjogYWRtaW46IGdldEVkaXRQcm9kdWN0IC0tLSBwcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy9hZG1pbi9wcm9kdWN0cycpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdhZG1pbi9lZGl0LXByb2R1Y3QnLCB7XHJcbiAgICAgICAgZG9jVGl0bGU6ICdFZGl0IHByb2R1Y3QnLFxyXG4gICAgICAgIGVkaXRpbmdNb2RlOiB0cnVlLFxyXG4gICAgICAgIHByb2R1Y3Q6IHByb2R1Y3RcclxuICAgIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcG9zdEVkaXRQcm9kdWN0ID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBpZCA9IHJlcS5wYXJhbXMuaWQ7XHJcbiAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kT25lKHtfaWQ6IGlkLCBvd25lcklkOiByZXEudXNlciEuX2lkfSk7XHJcbiAgICBpZiAoIXByb2R1Y3QpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVSUk9SOiBhZG1pbjogcG9zdEVkaXRQcm9kdWN0IC0tLSBwcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy9hZG1pbi9wcm9kdWN0cycpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGVycm9ycyA9IGdldFZhbGlkYXRpb25Nc2cocmVxKTtcclxuICAgIFxyXG4gICAgaWYoZXJyb3JzKXtcclxuICAgICAgICByZXR1cm4gcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnYWRtaW4vZWRpdC1wcm9kdWN0Jywge1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogJ0VkaXQgcHJvZHVjdCcsXHJcbiAgICAgICAgICAgIGVkaXRpbmdNb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICBwcm9kdWN0OiB7XHJcbiAgICAgICAgICAgICAgICBfaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IHJlcS5ib2R5LnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgcHJpY2U6IHJlcS5ib2R5LnByaWNlLFxyXG4gICAgICAgICAgICAgICAgaW1hZ2VVcmw6IHJlcT8uZmlsZT8ucGF0aCxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZXEuYm9keS5kZXNjcmlwdGlvblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAuLi5lcnJvcnNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHByb2R1Y3QudGl0bGUgPSByZXEuYm9keS50aXRsZTtcclxuICAgIHByb2R1Y3QucHJpY2UgPSBOdW1iZXIocmVxLmJvZHkucHJpY2UpO1xyXG4gICAgcHJvZHVjdC5kZXNjcmlwdGlvbiA9IHJlcS5ib2R5LmRlc2NyaXB0aW9uO1xyXG4gICAgcHJvZHVjdC5pbWFnZVVybCA9IHJlcT8uZmlsZT8ucGF0aDtcclxuICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xyXG5cclxuICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3Byb2R1Y3RzJyk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBwb3N0RGVsZXRlUHJvZHVjdCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkO1xyXG5cclxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRPbmUoeyBfaWQ6IGlkLCBvd25lcklkOiByZXEudXNlciEuX2lkIH0pO1xyXG4gICAgaWYoIXByb2R1Y3Qpe1xyXG4gICAgICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3Byb2R1Y3RzJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgcHJvZHVjdC5yZW1vdmUoKTtcclxuICAgIGF3YWl0IFVzZXIudXBkYXRlTWFueSh7fSxcclxuICAgICAgICB7JHB1bGw6eydjYXJ0LnByb2R1Y3RzJzogeydwcm9kdWN0SWQnOiBuZXcgVHlwZXMuT2JqZWN0SWQoaWQpfX19LFxyXG4gICAgICAgIHttdWx0aTogdHJ1ZX0pO1xyXG5cclxuICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3Byb2R1Y3RzJyk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/controllers/admin.ts\n");

/***/ }),

/***/ "./src/controllers/auth.ts":
/*!*********************************!*\
  !*** ./src/controllers/auth.ts ***!
  \*********************************/
/*! exports provided: getLogin, postLogin, postLogout, getSignup, postSignup, getResetPassword, postResetPassword, getNewPassword, postNewPassword */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLogin\", function() { return getLogin; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postLogin\", function() { return postLogin; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postLogout\", function() { return postLogout; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSignup\", function() { return getSignup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postSignup\", function() { return postSignup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getResetPassword\", function() { return getResetPassword; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postResetPassword\", function() { return postResetPassword; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getNewPassword\", function() { return getNewPassword; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postNewPassword\", function() { return postNewPassword; });\n/* harmony import */ var _util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/ResponseHelper */ \"./src/util/ResponseHelper.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/User */ \"./src/models/User.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sendgrid/mail */ \"@sendgrid/mail\");\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\nconst getLogin = (req, res, next) => {\r\n    const infoMessage = String(req.flash('info')) || undefined;\r\n    const errorMessage = String(req.flash('error')) || undefined;\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, 'auth/login', {\r\n        docTitle: 'Login',\r\n        errorMessage,\r\n        infoMessage\r\n    });\r\n};\r\nconst postLogin = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const email = req.body.email;\r\n    const password = req.body.password;\r\n    const user = yield _models_User__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({ email: email });\r\n    if (!user || !(yield bcryptjs__WEBPACK_IMPORTED_MODULE_2__[\"compare\"](password, user.pass))) {\r\n        req.flash('error', 'Invalid email or password.');\r\n        return Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, 'auth/login', {\r\n            docTitle: 'Login',\r\n            errorMessage: \"Invalid email or password\",\r\n            oldInput: { email, password }\r\n        });\r\n    }\r\n    req.session.isLoggedIn = true;\r\n    req.session.userId = user._id;\r\n    req.session.save(err => {\r\n        if (err)\r\n            console.log(err);\r\n        res.redirect('/');\r\n    });\r\n});\r\nconst postLogout = (req, res, next) => {\r\n    req.session.destroy((err) => {\r\n        if (err)\r\n            console.log(err);\r\n        res.redirect('/');\r\n    });\r\n};\r\nconst getSignup = (req, res, next) => {\r\n    const errorMessage = String(req.flash('error')) || undefined;\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, 'auth/signup', {\r\n        docTitle: 'Sign up',\r\n        errorMessage\r\n    });\r\n};\r\nconst postSignup = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const email = req.body.email;\r\n    const password = req.body.password;\r\n    const confirmPassword = req.body.confirmPassword;\r\n    const errors = Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"getValidationMsg\"])(req);\r\n    if (errors) {\r\n        Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res.status(422), 'auth/signup', Object.assign({ docTitle: 'Sign up', oldInput: { email, password, confirmPassword } }, errors));\r\n        return;\r\n    }\r\n    // if(password !== confirmPassword){\r\n    //     req.flash(\"error\", \"Given passwords are different.\");\r\n    //     return res.redirect('/signup');\r\n    // }\r\n    // if(await User.findOne({email: email})){\r\n    //     req.flash(\"error\", \"User with this email already exists.\");\r\n    //     return res.redirect('/signup');\r\n    // }\r\n    // zrobione w walidacji\r\n    const usr = yield _models_User__WEBPACK_IMPORTED_MODULE_1__[\"default\"].create({\r\n        name: 'Jolla',\r\n        email: email,\r\n        pass: yield bcryptjs__WEBPACK_IMPORTED_MODULE_2__[\"hash\"](password, 12),\r\n        orders: [],\r\n        cart: { products: [] }\r\n    });\r\n    const msg = {\r\n        to: email,\r\n        from: 'mateusz.kisiel.mk@gmail.com',\r\n        subject: 'Confirm your email',\r\n        // text: 'and easy to do anywhere, even with Node.js',\r\n        html: '<strong>Click to confirm your email</strong>',\r\n    };\r\n    _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default.a.send(msg).catch(error => console.log(error));\r\n    req.session.isLoggedIn = true;\r\n    req.session.userId = usr.id;\r\n    req.session.save(err => {\r\n        console.log(err);\r\n        res.redirect('/');\r\n    });\r\n});\r\nconst getResetPassword = (req, res, next) => {\r\n    const errorMessage = String(req.flash('error')) || undefined;\r\n    const infoMessage = String(req.flash('info')) || undefined;\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, 'auth/reset-password', {\r\n        docTitle: 'Reset password',\r\n        errorMessage,\r\n        infoMessage\r\n    });\r\n};\r\nconst postResetPassword = (req, res, next) => {\r\n    crypto__WEBPACK_IMPORTED_MODULE_4___default.a.randomBytes(32, (err, buffer) => __awaiter(void 0, void 0, void 0, function* () {\r\n        if (err) {\r\n            console.log(err);\r\n            req.flash('error', \"Unexpected error occured\");\r\n            return res.redirect('/reset-password');\r\n        }\r\n        const token = buffer.toString('hex');\r\n        const user = yield _models_User__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({ email: req.body.email });\r\n        if (!user) {\r\n            req.flash('error', \"Email doesn't exists\");\r\n            return res.redirect('/reset-password');\r\n        }\r\n        user.resetToken = token;\r\n        user.resetTokenExpiration = new Date(Date.now() + 3600000);\r\n        yield user.save();\r\n        _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default.a.send({\r\n            from: 'mateusz.kisiel.mk@gmail.com',\r\n            to: user.email,\r\n            subject: 'Password reset',\r\n            html: `<p>You requested password reset</p>\r\n                Click <a href=\"http://localhost:3000/new-password/${token}\">link</a> to reset password`\r\n        });\r\n        req.flash('info', 'Check your email to reset password.');\r\n        res.redirect('/login');\r\n    }));\r\n};\r\nconst getNewPassword = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const errorMessage = String(req.flash('error')) || undefined;\r\n    const token = req.params.token;\r\n    const user = yield _models_User__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({\r\n        resetToken: token,\r\n        resetTokenExpiration: { $gt: new Date() }\r\n    });\r\n    if (!user) {\r\n        req.flash('error', 'Timeout expired');\r\n        return res.redirect('/reset-password');\r\n    }\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, 'auth/new-password', {\r\n        docTitle: 'New password',\r\n        token: token,\r\n        errorMessage\r\n    });\r\n});\r\nconst postNewPassword = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const password = req.body.password;\r\n    const confirmPassword = req.body.confirmPassword;\r\n    const token = req.body.token;\r\n    const user = yield _models_User__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({\r\n        resetToken: token,\r\n        resetTokenExpiration: { $gt: new Date() }\r\n    });\r\n    if (!user) {\r\n        req.flash('error', \"Timeout expired\");\r\n        return res.redirect('/reset-password');\r\n    }\r\n    if (password !== confirmPassword) {\r\n        req.flash('error', 'Passwords are different');\r\n        return res.redirect(`/new-password/${token}`);\r\n    }\r\n    user.pass = yield bcryptjs__WEBPACK_IMPORTED_MODULE_2__[\"hash\"](password, 12);\r\n    user.resetToken = undefined;\r\n    user.resetTokenExpiration = undefined;\r\n    yield user.save();\r\n    req.flash('info', 'Your password was changed.');\r\n    res.redirect('/login');\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvYXV0aC50cz8xNGRiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUN3RTtBQUN0QztBQUNDO0FBQ0c7QUFDVjtBQUlyQixNQUFNLFFBQVEsR0FBRyxDQUFDLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQ3hFLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUUsU0FBUyxDQUFDO0lBQ3pELE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUUsU0FBUyxDQUFDO0lBRTNELHlFQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUM7UUFDaEMsUUFBUSxFQUFFLE9BQU87UUFDakIsWUFBWTtRQUNaLFdBQVc7S0FDZCxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUM7QUFFSyxNQUFNLFNBQVMsR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQy9FLE1BQU0sS0FBSyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQzdCLE1BQU0sUUFBUSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO0lBQ25DLE1BQU0sSUFBSSxHQUFHLE1BQU0sb0RBQUksQ0FBQyxPQUFPLENBQUMsRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTSxnREFBYyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUM7UUFDbkQsR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsNEJBQTRCLENBQUMsQ0FBQztRQUNqRCxPQUFPLHlFQUFZLENBQUMsR0FBRyxFQUFF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QUFDLElBQUksRUFBQztRQUNMLEdBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLGlCQUFpQixDQUFDLENBQUM7UUFDdEMsT0FBTyxHQUFHLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLENBQUM7S0FDMUM7SUFFRCxJQUFHLFFBQVEsS0FBSyxlQUFlLEVBQUM7UUFDNUIsR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUseUJBQXlCLENBQUMsQ0FBQztRQUM5QyxPQUFPLEdBQUcsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLEtBQUssRUFBRSxDQUFDO0tBQ2hEO0lBRUQsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLDZDQUFXLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzVDLElBQUksQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO0lBQzVCLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxTQUFTLENBQUM7SUFDdEMsTUFBTSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFFbEIsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsNEJBQTRCLENBQUMsQ0FBQztJQUVoRCxHQUFHLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzNCLENBQUMiLCJmaWxlIjoiLi9zcmMvY29udHJvbGxlcnMvYXV0aC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgeyByZW5kZXJIZWxwZXIsIGdldFZhbGlkYXRpb25Nc2cgfSBmcm9tIFwiLi4vdXRpbC9SZXNwb25zZUhlbHBlclwiO1xyXG5pbXBvcnQgVXNlciBmcm9tIFwiLi4vbW9kZWxzL1VzZXJcIjtcclxuaW1wb3J0ICogYXMgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcclxuaW1wb3J0IHNlbmRncmlkIGZyb20gJ0BzZW5kZ3JpZC9tYWlsJztcclxuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xyXG5pbXBvcnQgeyBzZXJpYWxpemUgfSBmcm9tIFwidjhcIjtcclxuaW1wb3J0IHt2YWxpZGF0aW9uUmVzdWx0fSBmcm9tICdleHByZXNzLXZhbGlkYXRvcic7XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0TG9naW4gPSAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGluZm9NZXNzYWdlID0gU3RyaW5nKHJlcS5mbGFzaCgnaW5mbycpKXx8dW5kZWZpbmVkO1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gU3RyaW5nKHJlcS5mbGFzaCgnZXJyb3InKSl8fHVuZGVmaW5lZDtcclxuXHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdhdXRoL2xvZ2luJyx7XHJcbiAgICAgICAgZG9jVGl0bGU6ICdMb2dpbicsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlLFxyXG4gICAgICAgIGluZm9NZXNzYWdlXHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3N0TG9naW4gPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGVtYWlsID0gcmVxLmJvZHkuZW1haWw7XHJcbiAgICBjb25zdCBwYXNzd29yZCA9IHJlcS5ib2R5LnBhc3N3b3JkO1xyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7ZW1haWw6IGVtYWlsfSk7XHJcbiAgICBpZighdXNlciB8fCAhYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzcykpe1xyXG4gICAgICAgIHJlcS5mbGFzaCgnZXJyb3InLCAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZC4nKTtcclxuICAgICAgICByZXR1cm4gcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnYXV0aC9sb2dpbicse1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogJ0xvZ2luJyxcclxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmRcIixcclxuICAgICAgICAgICAgb2xkSW5wdXQ6IHtlbWFpbCwgcGFzc3dvcmR9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXEuc2Vzc2lvbiEuaXNMb2dnZWRJbiA9IHRydWU7XHJcbiAgICByZXEuc2Vzc2lvbiEudXNlcklkID0gdXNlci5faWQ7XHJcbiAgICByZXEuc2Vzc2lvbiEuc2F2ZShlcnI9PntcclxuICAgICAgICBpZihlcnIpIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICB9KTtcclxufTtcclxuZXhwb3J0IGNvbnN0IHBvc3RMb2dvdXQgPSAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIHJlcS5zZXNzaW9uIS5kZXN0cm95KChlcnIpPT57XHJcbiAgICAgICAgaWYoZXJyKSBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0U2lnbnVwID0gKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBTdHJpbmcocmVxLmZsYXNoKCdlcnJvcicpKSB8fCB1bmRlZmluZWQ7XHJcbiAgICBcclxuXHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdhdXRoL3NpZ251cCcse1xyXG4gICAgICAgIGRvY1RpdGxlOiAnU2lnbiB1cCcsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlXHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3N0U2lnbnVwID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBlbWFpbCA9IHJlcS5ib2R5LmVtYWlsO1xyXG4gICAgY29uc3QgcGFzc3dvcmQgPSByZXEuYm9keS5wYXNzd29yZDtcclxuICAgIGNvbnN0IGNvbmZpcm1QYXNzd29yZCA9IHJlcS5ib2R5LmNvbmZpcm1QYXNzd29yZDtcclxuICAgIFxyXG4gICAgY29uc3QgZXJyb3JzID0gZ2V0VmFsaWRhdGlvbk1zZyhyZXEpO1xyXG4gICAgaWYoZXJyb3JzKXtcclxuICAgICAgICByZW5kZXJIZWxwZXIocmVxLCByZXMuc3RhdHVzKDQyMiksICdhdXRoL3NpZ251cCcse1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogJ1NpZ24gdXAnLFxyXG4gICAgICAgICAgICBvbGRJbnB1dDoge2VtYWlsLCBwYXNzd29yZCwgY29uZmlybVBhc3N3b3JkfSxcclxuICAgICAgICAgICAgLi4uZXJyb3JzXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBpZihwYXNzd29yZCAhPT0gY29uZmlybVBhc3N3b3JkKXtcclxuICAgIC8vICAgICByZXEuZmxhc2goXCJlcnJvclwiLCBcIkdpdmVuIHBhc3N3b3JkcyBhcmUgZGlmZmVyZW50LlwiKTtcclxuICAgIC8vICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvc2lnbnVwJyk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyBpZihhd2FpdCBVc2VyLmZpbmRPbmUoe2VtYWlsOiBlbWFpbH0pKXtcclxuICAgIC8vICAgICByZXEuZmxhc2goXCJlcnJvclwiLCBcIlVzZXIgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzLlwiKTtcclxuICAgIC8vICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvc2lnbnVwJyk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyB6cm9iaW9uZSB3IHdhbGlkYWNqaVxyXG5cclxuICAgIGNvbnN0IHVzciA9IGF3YWl0IFVzZXIuY3JlYXRlKHtcclxuICAgICAgICBuYW1lOidKb2xsYScsXHJcbiAgICAgICAgZW1haWw6IGVtYWlsLFxyXG4gICAgICAgIHBhc3M6IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMiksXHJcbiAgICAgICAgb3JkZXJzOiBbXSxcclxuICAgICAgICBjYXJ0OiB7cHJvZHVjdHM6IFtdfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbXNnID0ge1xyXG4gICAgICAgIHRvOiBlbWFpbCxcclxuICAgICAgICBmcm9tOiAnbWF0ZXVzei5raXNpZWwubWtAZ21haWwuY29tJyxcclxuICAgICAgICBzdWJqZWN0OiAnQ29uZmlybSB5b3VyIGVtYWlsJyxcclxuICAgICAgICAvLyB0ZXh0OiAnYW5kIGVhc3kgdG8gZG8gYW55d2hlcmUsIGV2ZW4gd2l0aCBOb2RlLmpzJyxcclxuICAgICAgICBodG1sOiAnPHN0cm9uZz5DbGljayB0byBjb25maXJtIHlvdXIgZW1haWw8L3N0cm9uZz4nLFxyXG4gICAgfTtcclxuICAgIHNlbmRncmlkLnNlbmQobXNnKS5jYXRjaChlcnJvcj0+Y29uc29sZS5sb2coZXJyb3IpKTtcclxuXHJcblxyXG4gICAgcmVxLnNlc3Npb24hLmlzTG9nZ2VkSW4gPSB0cnVlO1xyXG4gICAgcmVxLnNlc3Npb24hLnVzZXJJZCA9IHVzci5pZDtcclxuICAgIHJlcS5zZXNzaW9uIS5zYXZlKGVycj0+e1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJyk7ICAgICBcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFJlc2V0UGFzc3dvcmQgPSAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IFN0cmluZyhyZXEuZmxhc2goJ2Vycm9yJykpfHx1bmRlZmluZWQ7XHJcbiAgICBjb25zdCBpbmZvTWVzc2FnZSA9IFN0cmluZyhyZXEuZmxhc2goJ2luZm8nKSl8fHVuZGVmaW5lZDtcclxuXHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdhdXRoL3Jlc2V0LXBhc3N3b3JkJyx7XHJcbiAgICAgICAgZG9jVGl0bGU6ICdSZXNldCBwYXNzd29yZCcsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlLFxyXG4gICAgICAgIGluZm9NZXNzYWdlXHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHBvc3RSZXNldFBhc3N3b3JkID0gKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIsYXN5bmMgKGVyciwgYnVmZmVyKT0+e1xyXG4gICAgICAgIGlmKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICByZXEuZmxhc2goJ2Vycm9yJywgXCJVbmV4cGVjdGVkIGVycm9yIG9jY3VyZWRcIik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoJy9yZXNldC1wYXNzd29yZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0b2tlbiA9IGJ1ZmZlci50b1N0cmluZygnaGV4Jyk7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7ZW1haWw6IHJlcS5ib2R5LmVtYWlsfSk7XHJcbiAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICByZXEuZmxhc2goJ2Vycm9yJywgXCJFbWFpbCBkb2Vzbid0IGV4aXN0c1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnL3Jlc2V0LXBhc3N3b3JkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVzZXIucmVzZXRUb2tlbiA9IHRva2VuO1xyXG4gICAgICAgIHVzZXIucmVzZXRUb2tlbkV4cGlyYXRpb24gPSBuZXcgRGF0ZShEYXRlLm5vdygpKzM2MDAwMDApO1xyXG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xyXG4gICAgICAgIHNlbmRncmlkLnNlbmQoe1xyXG4gICAgICAgICAgICBmcm9tOiAnbWF0ZXVzei5raXNpZWwubWtAZ21haWwuY29tJyxcclxuICAgICAgICAgICAgdG86IHVzZXIuZW1haWwsXHJcbiAgICAgICAgICAgIHN1YmplY3Q6ICdQYXNzd29yZCByZXNldCcsXHJcbiAgICAgICAgICAgIGh0bWw6IGA8cD5Zb3UgcmVxdWVzdGVkIHBhc3N3b3JkIHJlc2V0PC9wPlxyXG4gICAgICAgICAgICAgICAgQ2xpY2sgPGEgaHJlZj1cImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9uZXctcGFzc3dvcmQvJHt0b2tlbn1cIj5saW5rPC9hPiB0byByZXNldCBwYXNzd29yZGBcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXEuZmxhc2goJ2luZm8nLCAnQ2hlY2sgeW91ciBlbWFpbCB0byByZXNldCBwYXNzd29yZC4nKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy9sb2dpbicpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXROZXdQYXNzd29yZCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gU3RyaW5nKHJlcS5mbGFzaCgnZXJyb3InKSl8fHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IHRva2VuID0gcmVxLnBhcmFtcy50b2tlbjtcclxuICAgIFxyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7XHJcbiAgICAgICAgcmVzZXRUb2tlbjogdG9rZW4sXHJcbiAgICAgICAgcmVzZXRUb2tlbkV4cGlyYXRpb246IHskZ3Q6bmV3IERhdGUoKX1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZighdXNlcil7XHJcbiAgICAgICAgcmVxLmZsYXNoKCdlcnJvcicsICdUaW1lb3V0IGV4cGlyZWQnKTtcclxuICAgICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KCcvcmVzZXQtcGFzc3dvcmQnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnYXV0aC9uZXctcGFzc3dvcmQnLHtcclxuICAgICAgICBkb2NUaXRsZTogJ05ldyBwYXNzd29yZCcsXHJcbiAgICAgICAgdG9rZW46IHRva2VuLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwb3N0TmV3UGFzc3dvcmQgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IHBhc3N3b3JkID0gcmVxLmJvZHkucGFzc3dvcmQ7XHJcbiAgICBjb25zdCBjb25maXJtUGFzc3dvcmQgPSByZXEuYm9keS5jb25maXJtUGFzc3dvcmQ7XHJcbiAgICBjb25zdCB0b2tlbiA9IHJlcS5ib2R5LnRva2VuO1xyXG5cclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoe1xyXG4gICAgICAgIHJlc2V0VG9rZW46IHRva2VuLFxyXG4gICAgICAgIHJlc2V0VG9rZW5FeHBpcmF0aW9uOiB7JGd0Om5ldyBEYXRlKCl9XHJcbiAgICB9KTtcclxuICAgIGlmKCF1c2VyKXtcclxuICAgICAgICByZXEuZmxhc2goJ2Vycm9yJywgXCJUaW1lb3V0IGV4cGlyZWRcIik7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5yZWRpcmVjdCgnL3Jlc2V0LXBhc3N3b3JkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYocGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCl7XHJcbiAgICAgICAgcmVxLmZsYXNoKCdlcnJvcicsICdQYXNzd29yZHMgYXJlIGRpZmZlcmVudCcpO1xyXG4gICAgICAgIHJldHVybiByZXMucmVkaXJlY3QoYC9uZXctcGFzc3dvcmQvJHt0b2tlbn1gKVxyXG4gICAgfVxyXG5cclxuICAgIHVzZXIucGFzcyA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMik7XHJcbiAgICB1c2VyLnJlc2V0VG9rZW4gPSB1bmRlZmluZWQ7XHJcbiAgICB1c2VyLnJlc2V0VG9rZW5FeHBpcmF0aW9uID0gdW5kZWZpbmVkO1xyXG4gICAgYXdhaXQgdXNlci5zYXZlKCk7XHJcblxyXG4gICAgcmVxLmZsYXNoKCdpbmZvJywgJ1lvdXIgcGFzc3dvcmQgd2FzIGNoYW5nZWQuJyk7XHJcbiAgICBcclxuICAgIHJlcy5yZWRpcmVjdCgnL2xvZ2luJyk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/controllers/auth.ts\n");

/***/ }),

/***/ "./src/controllers/errors.ts":
/*!***********************************!*\
  !*** ./src/controllers/errors.ts ***!
  \***********************************/
/*! exports provided: use404, use500 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"use404\", function() { return use404; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"use500\", function() { return use500; });\n/* harmony import */ var _util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/ResponseHelper */ \"./src/util/ResponseHelper.ts\");\n\r\nconst use404 = (req, res, next) => {\r\n    res = res.status(404);\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_0__[\"renderHelper\"])(req, res, '404', {\r\n        docTitle: \"Page Not Found\"\r\n    });\r\n};\r\nconst use500 = (err, req, res, next) => {\r\n    console.log(err);\r\n    res = res.status(500);\r\n    res.render('500', {\r\n        docTitle: \"Server issue\",\r\n        path: \"500\",\r\n        isAuthenticated: false\r\n    });\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvZXJyb3JzLnRzPzJiMjIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBc0Q7QUFFL0MsTUFBTSxNQUFNLEdBQUcsQ0FBQyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNuRSxHQUFHLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0Qix5RUFBWSxDQUFDLEdBQUcsRUFBQyxHQUFHLEVBQUMsS0FBSyxFQUFDO1FBQ3ZCLFFBQVEsRUFBRSxnQkFBZ0I7S0FDN0IsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUVNLE1BQU0sTUFBTSxHQUFHLENBQUMsR0FBUyxFQUFFLEdBQVcsRUFBRSxHQUFZLEVBQUUsSUFBaUIsRUFBRSxFQUFFO0lBQzlFLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakIsR0FBRyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdEIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUU7UUFDZCxRQUFRLEVBQUUsY0FBYztRQUN4QixJQUFJLEVBQUUsS0FBSztRQUNYLGVBQWUsRUFBRSxLQUFLO0tBQ3pCLENBQUMsQ0FBQztBQUNQLENBQUMiLCJmaWxlIjoiLi9zcmMvY29udHJvbGxlcnMvZXJyb3JzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCB7IHJlbmRlckhlbHBlciB9IGZyb20gXCIuLi91dGlsL1Jlc3BvbnNlSGVscGVyXCI7XHJcblxyXG5leHBvcnQgY29uc3QgdXNlNDA0ID0gKHJlcTpSZXF1ZXN0LCByZXM6UmVzcG9uc2UsIG5leHQ6TmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICByZXMgPSByZXMuc3RhdHVzKDQwNCk7XHJcbiAgICByZW5kZXJIZWxwZXIocmVxLHJlcywnNDA0Jyx7XHJcbiAgICAgICAgZG9jVGl0bGU6IFwiUGFnZSBOb3QgRm91bmRcIlxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1c2U1MDAgPSAoZXJyOkVycm9yLCByZXE6UmVxdWVzdCwgcmVzOlJlc3BvbnNlLCBuZXh0Ok5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIHJlcyA9IHJlcy5zdGF0dXMoNTAwKTtcclxuICAgIHJlcy5yZW5kZXIoJzUwMCcsIHtcclxuICAgICAgICBkb2NUaXRsZTogXCJTZXJ2ZXIgaXNzdWVcIixcclxuICAgICAgICBwYXRoOiBcIjUwMFwiLFxyXG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2VcclxuICAgIH0pO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/controllers/errors.ts\n");

/***/ }),

/***/ "./src/controllers/shop.ts":
/*!*********************************!*\
  !*** ./src/controllers/shop.ts ***!
  \*********************************/
/*! exports provided: getIndex, getProducts, getProduct, getCart, postCart, postCartDeleteItem, postCartDeleteItems, postCreateOrder, getOrders */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getIndex\", function() { return getIndex; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getProducts\", function() { return getProducts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getProduct\", function() { return getProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCart\", function() { return getCart; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCart\", function() { return postCart; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCartDeleteItem\", function() { return postCartDeleteItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCartDeleteItems\", function() { return postCartDeleteItems; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCreateOrder\", function() { return postCreateOrder; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getOrders\", function() { return getOrders; });\n/* harmony import */ var _models_product__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/product */ \"./src/models/product.ts\");\n/* harmony import */ var _models_cartHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/cartHelper */ \"./src/models/cartHelper.ts\");\n/* harmony import */ var _models_order__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../models/order */ \"./src/models/order.ts\");\n/* harmony import */ var _util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/ResponseHelper */ \"./src/util/ResponseHelper.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n//// USERS\r\nconst getIndex = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].find();\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__[\"renderHelper\"])(req, res, 'shop/index', {\r\n        products: products,\r\n        docTitle: 'My Shop',\r\n    });\r\n});\r\nconst getProducts = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].find();\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__[\"renderHelper\"])(req, res, 'shop/product-list', {\r\n        products: products,\r\n        docTitle: 'Products',\r\n    });\r\n});\r\nconst getProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.params.id;\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(id);\r\n    if (!product) {\r\n        console.log(\"ERROR: shop: getProduct --- product not found\");\r\n        res.redirect('/');\r\n        return;\r\n    }\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__[\"renderHelper\"])(req, res, 'shop/product-detail', {\r\n        product: yield product,\r\n        docTitle: product.title,\r\n    });\r\n});\r\nconst getCart = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const user = (yield req.user\r\n        .populate('cart.products.productId')\r\n        .execPopulate());\r\n    const cartProducts = user.cart.products;\r\n    const price = _models_cartHelper__WEBPACK_IMPORTED_MODULE_1__[\"default\"].countPrice(cartProducts);\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__[\"renderHelper\"])(req, res, 'shop/cart', {\r\n        docTitle: 'My Cart',\r\n        products: cartProducts,\r\n        price: price\r\n    });\r\n});\r\nconst postCart = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.body.productId;\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(id);\r\n    if (!product) {\r\n        console.log(\"ERROR: shop: postCart --- product not found\");\r\n        res.redirect('/');\r\n        return;\r\n    }\r\n    yield req.user.addToCart(product);\r\n    res.redirect(\"/cart\");\r\n});\r\n// export const getCheckout = async (req: Request, res: Response, next: NextFunction) => {\r\n//     res.render('shop/checkout', {\r\n//         // products: await Product.fetchAll(), \r\n//         docTitle: 'My Cart',\r\n//         path: '/shop/checkout'\r\n//     });\r\n// };\r\nconst postCartDeleteItem = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.body.id;\r\n    yield req.user.removeFromCartOne(id);\r\n    res.redirect(\"/cart\");\r\n});\r\nconst postCartDeleteItems = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.body.id;\r\n    yield req.user.removeFromCartAll(id);\r\n    res.redirect(\"/cart\");\r\n});\r\nconst postCreateOrder = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const user = yield req.user.populate('cart.products.productId').execPopulate();\r\n    yield _models_order__WEBPACK_IMPORTED_MODULE_2__[\"default\"].create({\r\n        userId: req.user._id,\r\n        products: user.cart.products.map(p => ({\r\n            cnt: p.cnt,\r\n            product: {\r\n                price: p.productId.price,\r\n                productId: p.productId._id,\r\n                title: p.productId.title\r\n            },\r\n        })),\r\n        price: _models_cartHelper__WEBPACK_IMPORTED_MODULE_1__[\"default\"].countPrice(user.cart.products)\r\n    });\r\n    yield user.removeFromCartAll();\r\n    res.redirect('/orders');\r\n});\r\nconst getOrders = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const orders = yield _models_order__WEBPACK_IMPORTED_MODULE_2__[\"default\"].find({ userId: req.user.id })\r\n        // .populate('products.product.productId')\r\n        .exec();\r\n    Object(_util_ResponseHelper__WEBPACK_IMPORTED_MODULE_3__[\"renderHelper\"])(req, res, 'shop/orders', {\r\n        orders: orders,\r\n        docTitle: 'My orders',\r\n    });\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvc2hvcC50cz85OWNjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ3dDO0FBQ007QUFFRTtBQUNNO0FBRXRELFVBQVU7QUFFSCxNQUFNLFFBQVEsR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQzlFLE1BQU0sUUFBUSxHQUFHLE1BQU0sdURBQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN0Qyx5RUFBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFDO1FBQ2hDLFFBQVEsRUFBRSxRQUFRO1FBQ2xCLFFBQVEsRUFBRSxTQUFTO0tBQ3RCLENBQUMsQ0FBQztBQUNQLENBQUMsRUFBQztBQUVLLE1BQU0sV0FBVyxHQUFHLENBQU8sR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7SUFDakYsTUFBTSxRQUFRLEdBQUcsTUFBTSx1REFBTyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3RDLHlFQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxtQkFBbUIsRUFBQztRQUN2QyxRQUFRLEVBQUUsUUFBUTtRQUNsQixRQUFRLEVBQUUsVUFBVTtLQUN2QixDQUFDLENBQUM7QUFDUCxDQUFDLEVBQUM7QUFFSyxNQUFNLFVBQVUsR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQ2hGLE1BQU0sRUFBRSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO0lBQ3pCLE1BQU0sT0FBTyxHQUFHLE1BQU0sdURBQU8sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDM0MsSUFBSSxDQUFDLE9BQU8sRUFBRTtRQUNWLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0NBQStDLENBQUMsQ0FBQztRQUM3RCxHQUFHLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLE9BQU87S0FDVjtJQUNELHlFQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxxQkFBcUIsRUFBQztRQUN6QyxPQUFPLEVBQUUsTUFBTSxPQUFPO1FBQ3RCLFFBQVEsRUFBRSxPQUFPLENBQUMsS0FBSztLQUMxQixDQUFDLENBQUM7QUFDUCxDQUFDLEVBQUM7QUFFSyxNQUFNLE9BQU8sR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQzdFLE1BQU0sSUFBSSxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSztTQUN4QixRQUFRLENBQUMseUJBQXlCLENBQUM7U0FDbkMsWUFBWSxFQUFFLENBQW1CLENBQUM7SUFDdkMsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDeEMsTUFBTSxLQUFLLEdBQUcsMERBQVUsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7SUFFbEQseUVBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBQztRQUMvQixRQUFRLEVBQUUsU0FBUztRQUNuQixRQUFRLEVBQUUsWUFBWTtRQUN0QixLQUFLLEVBQUUsS0FBSztLQUNmLENBQUMsQ0FBQztBQUNQLENBQUMsRUFBQztBQUNLLE1BQU0sUUFBUSxHQUFHLENBQU8sR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7SUFDOUUsTUFBTSxFQUFFLEdBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDL0IsTUFBTSxPQUFPLEdBQUcsTUFBTSx1REFBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMzQyxJQUFHLENBQUMsT0FBTyxFQUFDO1FBQ1IsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2Q0FBNkMsQ0FBQyxDQUFDO1FBQzNELEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbEIsT0FBTztLQUNWO0lBQ0QsTUFBTSxHQUFHLENBQUMsSUFBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNuQyxHQUFHLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzFCLENBQUMsRUFBQztBQUNGLDBGQUEwRjtBQUMxRixvQ0FBb0M7QUFDcEMsa0RBQWtEO0FBQ2xELCtCQUErQjtBQUMvQixpQ0FBaUM7QUFDakMsVUFBVTtBQUNWLEtBQUs7QUFNRSxNQUFNLGtCQUFrQixHQUFHLENBQU8sR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7SUFDeEYsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7SUFDdkIsTUFBTSxHQUFHLENBQUMsSUFBSyxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLEdBQUcsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUNNLE1BQU0sbUJBQW1CLEdBQUcsQ0FBTyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQWtCLEVBQUUsRUFBRTtJQUN6RixNQUFNLEVBQUUsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUN2QixNQUFNLEdBQUcsQ0FBQyxJQUFLLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdEMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUMxQixDQUFDO0FBRU0sTUFBTSxlQUFlLEdBQUcsQ0FBTyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQWtCLEVBQUUsRUFBRTtJQUNyRixNQUFNLElBQUksR0FBRyxNQUFNLEdBQUcsQ0FBQyxJQUFLLENBQUMsUUFBUSxDQUFDLHlCQUF5QixDQUFDLENBQUMsWUFBWSxFQUFvQixDQUFDO0lBRWxHLE1BQU0scURBQUssQ0FBQyxNQUFNLENBQUM7UUFDZixNQUFNLEVBQUUsR0FBRyxDQUFDLElBQUssQ0FBQyxHQUFHO1FBQ3JCLFFBQVEsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFFLEVBQUM7WUFDakMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHO1lBQ1YsT0FBTyxFQUFFO2dCQUNMLEtBQUssRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUs7Z0JBQ3hCLFNBQVMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUc7Z0JBQzFCLEtBQUssRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUs7YUFDM0I7U0FDSixDQUFDLENBQUM7UUFDSCxLQUFLLEVBQUUsMERBQVUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7S0FDekMsQ0FBQyxDQUFDO0lBQ2IsTUFBTSxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUMvQixHQUFHLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzVCLENBQUM7QUFFTSxNQUFNLFNBQVMsR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQy9FLE1BQU0sTUFBTSxHQUFHLE1BQU0scURBQUssQ0FBQyxJQUFJLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLElBQUssQ0FBQyxFQUFFLEVBQUMsQ0FBQztRQUNuRCwwQ0FBMEM7U0FDekMsSUFBSSxFQUFFLENBQUM7SUFHWix5RUFBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsYUFBYSxFQUFDO1FBQ2pDLE1BQU0sRUFBRSxNQUFNO1FBQ2QsUUFBUSxFQUFFLFdBQVc7S0FDeEIsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxFQUFDIiwiZmlsZSI6Ii4vc3JjL2NvbnRyb2xsZXJzL3Nob3AudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIsIE5leHRGdW5jdGlvbiwgUmVzcG9uc2UsIFJlcXVlc3QgfSBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgUHJvZHVjdCBmcm9tIFwiLi4vbW9kZWxzL3Byb2R1Y3RcIjtcclxuaW1wb3J0IENhcnRIZWxwZXIgZnJvbSBcIi4uL21vZGVscy9jYXJ0SGVscGVyXCI7XHJcbmltcG9ydCB7IElVc2VyUG9wdWxhdGVkIH0gZnJvbSBcIi4uL21vZGVscy9Vc2VyXCI7XHJcbmltcG9ydCBPcmRlciwgeyBJT3JkZXIgfSBmcm9tIFwiLi4vbW9kZWxzL29yZGVyXCI7XHJcbmltcG9ydCB7IHJlbmRlckhlbHBlciB9IGZyb20gXCIuLi91dGlsL1Jlc3BvbnNlSGVscGVyXCI7XHJcblxyXG4vLy8vIFVTRVJTXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5kZXggPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdC5maW5kKCk7XHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdzaG9wL2luZGV4Jyx7XHJcbiAgICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzLFxyXG4gICAgICAgIGRvY1RpdGxlOiAnTXkgU2hvcCcsXHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRQcm9kdWN0cyA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0LmZpbmQoKTtcclxuICAgIHJlbmRlckhlbHBlcihyZXEsIHJlcywgJ3Nob3AvcHJvZHVjdC1saXN0Jyx7XHJcbiAgICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzLFxyXG4gICAgICAgIGRvY1RpdGxlOiAnUHJvZHVjdHMnLFxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0UHJvZHVjdCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoaWQpO1xyXG4gICAgaWYgKCFwcm9kdWN0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUjogc2hvcDogZ2V0UHJvZHVjdCAtLS0gcHJvZHVjdCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmVuZGVySGVscGVyKHJlcSwgcmVzLCAnc2hvcC9wcm9kdWN0LWRldGFpbCcse1xyXG4gICAgICAgIHByb2R1Y3Q6IGF3YWl0IHByb2R1Y3QsXHJcbiAgICAgICAgZG9jVGl0bGU6IHByb2R1Y3QudGl0bGUsXHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRDYXJ0ID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gKGF3YWl0IHJlcS51c2VyIVxyXG4gICAgICAgIC5wb3B1bGF0ZSgnY2FydC5wcm9kdWN0cy5wcm9kdWN0SWQnKVxyXG4gICAgICAgIC5leGVjUG9wdWxhdGUoKSkgYXMgSVVzZXJQb3B1bGF0ZWQ7XHJcbiAgICBjb25zdCBjYXJ0UHJvZHVjdHMgPSB1c2VyLmNhcnQucHJvZHVjdHM7XHJcbiAgICBjb25zdCBwcmljZSA9IENhcnRIZWxwZXIuY291bnRQcmljZShjYXJ0UHJvZHVjdHMpO1xyXG5cclxuICAgIHJlbmRlckhlbHBlcihyZXEsIHJlcywgJ3Nob3AvY2FydCcse1xyXG4gICAgICAgIGRvY1RpdGxlOiAnTXkgQ2FydCcsXHJcbiAgICAgICAgcHJvZHVjdHM6IGNhcnRQcm9kdWN0cyxcclxuICAgICAgICBwcmljZTogcHJpY2VcclxuICAgIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcG9zdENhcnQgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGlkID0gIHJlcS5ib2R5LnByb2R1Y3RJZDtcclxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGlkKTtcclxuICAgIGlmKCFwcm9kdWN0KXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVSUk9SOiBzaG9wOiBwb3N0Q2FydCAtLS0gcHJvZHVjdCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgcmVxLnVzZXIhLmFkZFRvQ2FydChwcm9kdWN0KTtcclxuICAgIHJlcy5yZWRpcmVjdChcIi9jYXJ0XCIpO1xyXG59O1xyXG4vLyBleHBvcnQgY29uc3QgZ2V0Q2hlY2tvdXQgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuLy8gICAgIHJlcy5yZW5kZXIoJ3Nob3AvY2hlY2tvdXQnLCB7XHJcbi8vICAgICAgICAgLy8gcHJvZHVjdHM6IGF3YWl0IFByb2R1Y3QuZmV0Y2hBbGwoKSwgXHJcbi8vICAgICAgICAgZG9jVGl0bGU6ICdNeSBDYXJ0JyxcclxuLy8gICAgICAgICBwYXRoOiAnL3Nob3AvY2hlY2tvdXQnXHJcbi8vICAgICB9KTtcclxuLy8gfTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgY29uc3QgcG9zdENhcnREZWxldGVJdGVtID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBpZCA9IHJlcS5ib2R5LmlkO1xyXG4gICAgYXdhaXQgcmVxLnVzZXIhLnJlbW92ZUZyb21DYXJ0T25lKGlkKTtcclxuICAgIHJlcy5yZWRpcmVjdChcIi9jYXJ0XCIpO1xyXG59XHJcbmV4cG9ydCBjb25zdCBwb3N0Q2FydERlbGV0ZUl0ZW1zID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBpZCA9IHJlcS5ib2R5LmlkO1xyXG4gICAgYXdhaXQgcmVxLnVzZXIhLnJlbW92ZUZyb21DYXJ0QWxsKGlkKTtcclxuICAgIHJlcy5yZWRpcmVjdChcIi9jYXJ0XCIpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcG9zdENyZWF0ZU9yZGVyID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcmVxLnVzZXIhLnBvcHVsYXRlKCdjYXJ0LnByb2R1Y3RzLnByb2R1Y3RJZCcpLmV4ZWNQb3B1bGF0ZSgpIGFzIElVc2VyUG9wdWxhdGVkO1xyXG5cclxuICAgIGF3YWl0IE9yZGVyLmNyZWF0ZSh7XHJcbiAgICAgICAgdXNlcklkOiByZXEudXNlciEuX2lkLFxyXG4gICAgICAgIHByb2R1Y3RzOiB1c2VyLmNhcnQucHJvZHVjdHMubWFwKHA9Pih7XHJcbiAgICAgICAgICAgIGNudDogcC5jbnQsXHJcbiAgICAgICAgICAgIHByb2R1Y3Q6IHtcclxuICAgICAgICAgICAgICAgIHByaWNlOiBwLnByb2R1Y3RJZC5wcmljZSxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogcC5wcm9kdWN0SWQuX2lkLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IHAucHJvZHVjdElkLnRpdGxlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICAgIHByaWNlOiBDYXJ0SGVscGVyLmNvdW50UHJpY2UodXNlci5jYXJ0LnByb2R1Y3RzKVxyXG4gICAgfSBhcyBJT3JkZXIpO1xyXG4gICAgYXdhaXQgdXNlci5yZW1vdmVGcm9tQ2FydEFsbCgpO1xyXG4gICAgcmVzLnJlZGlyZWN0KCcvb3JkZXJzJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRPcmRlcnMgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IE9yZGVyLmZpbmQoe3VzZXJJZDogcmVxLnVzZXIhLmlkfSlcclxuICAgICAgICAvLyAucG9wdWxhdGUoJ3Byb2R1Y3RzLnByb2R1Y3QucHJvZHVjdElkJylcclxuICAgICAgICAuZXhlYygpO1xyXG5cclxuXHJcbiAgICByZW5kZXJIZWxwZXIocmVxLCByZXMsICdzaG9wL29yZGVycycse1xyXG4gICAgICAgIG9yZGVyczogb3JkZXJzLCBcclxuICAgICAgICBkb2NUaXRsZTogJ015IG9yZGVycycsXHJcbiAgICB9KTtcclxufTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/controllers/shop.ts\n");

/***/ }),

/***/ "./src/models/User.ts":
/*!****************************!*\
  !*** ./src/models/User.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\nconst userSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__[\"Schema\"]({\r\n    name: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    email: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    resetToken: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    resetTokenExpiration: {\r\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"SchemaTypes\"].Date,\r\n        required: false\r\n    },\r\n    pass: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    cart: {\r\n        products: [{\r\n                productId: {\r\n                    type: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"SchemaTypes\"].ObjectId,\r\n                    required: true,\r\n                    ref: 'Product'\r\n                },\r\n                cnt: {\r\n                    type: Number,\r\n                    required: true\r\n                }\r\n            }]\r\n    },\r\n});\r\nuserSchema.methods.addToCart = function (product) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const index = this.cart.products.findIndex(a => a.productId.equals(product._id));\r\n        if (index !== -1) {\r\n            this.cart.products[index].cnt++;\r\n        }\r\n        else {\r\n            this.cart.products.push({\r\n                productId: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"Types\"].ObjectId(product._id),\r\n                cnt: 1\r\n            });\r\n        }\r\n        return yield this.save();\r\n    });\r\n};\r\nuserSchema.methods.removeFromCartOne = function (productId) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const index = this.cart.products.findIndex(a => a.productId.equals(productId));\r\n        if (index !== -1) {\r\n            this.cart.products[index].cnt--;\r\n            if (this.cart.products[index].cnt === 0)\r\n                this.cart.products.splice(index, 1);\r\n        }\r\n        else {\r\n            throw 'ERROR - removeFromCartOne: id doesn\\'t exist';\r\n        }\r\n        return yield this.save();\r\n    });\r\n};\r\nuserSchema.methods.removeFromCartAll = function (productId) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!productId) {\r\n            this.cart.products = [];\r\n            return yield this.save();\r\n        }\r\n        const index = this.cart.products.findIndex(a => a.productId.equals(productId));\r\n        if (index !== -1) {\r\n            this.cart.products.splice(index, 1);\r\n        }\r\n        else {\r\n            throw 'ERROR - removeFromCartOne: id doesn\\'t exist';\r\n        }\r\n        return yield this.save();\r\n    });\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(mongoose__WEBPACK_IMPORTED_MODULE_0__[\"model\"])('User', userSchema));\r\n// import path from 'path';\r\n// import Cart from './cart';\r\n// import { getDb } from '../util/database';\r\n// import { Model, DataTypes, Optional, HasOneGetAssociationMixin, Association } from 'sequelize';\r\n// import mongoConect from '../util/database';\r\n// import { Db, ObjectId, ObjectID } from 'mongodb';\r\n// import Product from './product';\r\n// class User{\r\n//     _id?: ObjectId;\r\n//     name: string;\r\n//     email: string;\r\n//     cart:Cart;\r\n//     /**\r\n//      *\r\n//      */\r\n//     constructor(name:string,email:string, id?:ObjectId, cart?:Cart) {\r\n//         this.name = name;\r\n//         this.email = email;\r\n//         this._id = id ? id : undefined;\r\n//         this.cart = cart?cart:new Cart();\r\n//     }\r\n//     async removeFromCartOne(productId:ObjectId){\r\n//         \r\n//     }\r\n//     static async removeProductFromCarts(productId:ObjectId){\r\n//         const db = getDb();\r\n//         await db.collection('users').updateMany({},{\r\n//             $pull:{\r\n//                 'cart.products': {productId: productId}\r\n//             }\r\n//         });\r\n//     }\r\n//     async removeFromCartAll(productId?:ObjectId){\r\n//         \r\n//     }\r\n//     static dataToUser(data:any){\r\n//         return new User(\r\n//             data.name,\r\n//             data.email,\r\n//             data._id,\r\n//             Cart.dataToCart(data.cart)\r\n//         );\r\n//     }\r\n//     static async fetchAll(){\r\n//         return await getDb().collection('users')\r\n//             .find()\r\n//             .map(p=>this.dataToUser(p))\r\n//             .toArray();\r\n//     }\r\n//     static async findById(id:ObjectId){\r\n//         return this.dataToUser( \r\n//             await getDb().collection('users')\r\n//                 .findOne({_id: id}));\r\n//     }\r\n//     static async deleteById(id:ObjectId){\r\n//         return await getDb().collection('users')\r\n//           .deleteOne({_id:id});\r\n//     }  \r\n//     async save(){\r\n//         const db = getDb();\r\n//         if(this._id){\r\n//             const results = await db.collection('users')\r\n//                 .updateOne({_id: this._id}, {$set: this});\r\n//         }\r\n//         else{\r\n//             const results = await db.collection('users').insertOne(this);\r\n//             this._id = results.insertedId;\r\n//         }\r\n//     }\r\n// }\r\n// // export interface UserAttributes {\r\n// //     id: number,\r\n// //     name: string,\r\n// //     email: string,\r\n// // }\r\n// // interface UserCreationAttributes extends Optional<UserAttributes, \"id\"> { }\r\n// // class User extends Model<UserAttributes, UserCreationAttributes>\r\n// //     implements UserAttributes {\r\n// //     public id!: number;\r\n// //     public name!: string;\r\n// //     public email!: string;\r\n// //     // timestamps!\r\n// //     public readonly createdAt!: Date;\r\n// //     public readonly updatedAt!: Date;\r\n// //     public getCart!: HasOneGetAssociationMixin<Cart>;\r\n// //     public createCart!: HasOneCreateAssociationMixin<Cart>;\r\n// //     public getProducts!: HasManyGetAssociationsMixin<Product>;\r\n// //     public addProduct!: HasManyAddAssociationMixin<Product, number>;\r\n// //     public addProducts!: HasManyAddAssociationsMixin<Product, number>;\r\n// //     public hasProduct!: HasManyHasAssociationMixin<Product, number>;\r\n// //     public countProducts!: HasManyCountAssociationsMixin;\r\n// //     public createProduct!: HasManyCreateAssociationMixin<Product>;\r\n// //     public getOrders!: HasManyGetAssociationsMixin<Order>;\r\n// //     public addOrder!: HasManyAddAssociationMixin<Order, number>;\r\n// //     public addOrders!: HasManyAddAssociationsMixin<Order, number>;\r\n// //     public hasOrder!: HasManyHasAssociationMixin<Order, number>;\r\n// //     public countOrders!: HasManyCountAssociationsMixin;\r\n// //     public createOrder!: HasManyCreateAssociationMixin<Order>;\r\n// //     public readonly products?: Product[]; // Note this is optional since it's only populated when explicitly requested in code\r\n// //     public readonly orderss?: Order[]; // Note this is optional since it's only populated when explicitly requested in code\r\n// //     public readonly cart?: Cart; // Note this is optional since it's only populated when explicitly requested in code\r\n// //     public static associations: {\r\n// //         products: Association<User, Product>;\r\n// //         orders: Association<User, Order>;\r\n// //         cart: Association<User, Cart>;\r\n// //     };\r\n// // }\r\n// // User.init({\r\n// //     id: {\r\n// //         type: DataTypes.INTEGER,\r\n// //         autoIncrement: true,\r\n// //         allowNull: false,\r\n// //         primaryKey: true\r\n// //     },\r\n// //     name: {\r\n// //         type: DataTypes.STRING,\r\n// //         allowNull: false\r\n// //     },\r\n// //     email: {\r\n// //         type: DataTypes.STRING,\r\n// //         allowNull: false,\r\n// //     },\r\n// // }, {\r\n// //     tableName: 'users',\r\n// //     sequelize: TutorialSequelize\r\n// // });\r\n// export default User;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL1VzZXIudHM/NDU4ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBdUU7QUFLdkUsTUFBTSxVQUFVLEdBQUcsSUFBSSwrQ0FBTSxDQUFRO0lBQ2pDLElBQUksRUFBRTtRQUNGLElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLElBQUk7S0FDakI7SUFDRCxLQUFLLEVBQUU7UUFDSCxJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxJQUFJO0tBQ2pCO0lBQ0QsVUFBVSxFQUFFO1FBQ1IsSUFBSSxFQUFFLE1BQU07UUFDWixRQUFRLEVBQUUsS0FBSztLQUNsQjtJQUNELG9CQUFvQixFQUFFO1FBQ2xCLElBQUksRUFBRSxvREFBVyxDQUFDLElBQUk7UUFDdEIsUUFBUSxFQUFFLEtBQUs7S0FDbEI7SUFDRCxJQUFJLEVBQUU7UUFDRixJQUFJLEVBQUMsTUFBTTtRQUNYLFFBQVEsRUFBRSxJQUFJO0tBQ2pCO0lBQ0QsSUFBSSxFQUFFO1FBQ0YsUUFBUSxFQUFFLENBQUM7Z0JBQ1AsU0FBUyxFQUFFO29CQUNQLElBQUksRUFBRSxvREFBVyxDQUFDLFFBQVE7b0JBQzFCLFFBQVEsRUFBRSxJQUFJO29CQUNkLEdBQUcsRUFBRSxTQUFTO2lCQUNqQjtnQkFDRCxHQUFHLEVBQUU7b0JBQ0QsSUFBSSxFQUFFLE1BQU07b0JBQ1osUUFBUSxFQUFFLElBQUk7aUJBQ2pCO2FBQ0osQ0FBQztLQUNMO0NBQ0osQ0FBQyxDQUFDO0FBcUNILFVBQVUsQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLFVBQWdCLE9BQWlCOztRQUM1RCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNqRixJQUFJLEtBQUssS0FB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ZTtBQUNmLHNDQUFzQztBQUN0QyxrQ0FBa0M7QUFDbEMsK0JBQStCO0FBQy9CLDhCQUE4QjtBQUM5QixZQUFZO0FBQ1osaUJBQWlCO0FBQ2pCLHFDQUFxQztBQUNyQyw4QkFBOEI7QUFDOUIsWUFBWTtBQUNaLGtCQUFrQjtBQUNsQixxQ0FBcUM7QUFDckMsK0JBQStCO0FBQy9CLFlBQVk7QUFDWixVQUFVO0FBQ1YsNkJBQTZCO0FBQzdCLHNDQUFzQztBQUN0QyxTQUFTO0FBR1QsdUJBQXVCIiwiZmlsZSI6Ii4vc3JjL21vZGVscy9Vc2VyLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NoZW1hLCBUeXBlcywgbW9kZWwsIERvY3VtZW50LCBTY2hlbWFUeXBlcyB9IGZyb20gJ21vbmdvb3NlJztcclxuaW1wb3J0IHsgdHlwZXMgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IHsgSVByb2R1Y3QgfSBmcm9tICcuL3Byb2R1Y3QnO1xyXG5pbXBvcnQgQ2FydEhlbHBlciBmcm9tICcuL2NhcnRIZWxwZXInO1xyXG5cclxuY29uc3QgdXNlclNjaGVtYSA9IG5ldyBTY2hlbWE8SVVzZXI+KHtcclxuICAgIG5hbWU6IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH0sXHJcbiAgICBlbWFpbDoge1xyXG4gICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgfSxcclxuICAgIHJlc2V0VG9rZW46IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgcmVzZXRUb2tlbkV4cGlyYXRpb246IHtcclxuICAgICAgICB0eXBlOiBTY2hlbWFUeXBlcy5EYXRlLFxyXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIHBhc3M6IHtcclxuICAgICAgICB0eXBlOlN0cmluZyxcclxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgfSxcclxuICAgIGNhcnQ6IHtcclxuICAgICAgICBwcm9kdWN0czogW3tcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBTY2hlbWFUeXBlcy5PYmplY3RJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgcmVmOiAnUHJvZHVjdCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY250OiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfV1cclxuICAgIH0sXHJcbn0pO1xyXG5leHBvcnQgaW50ZXJmYWNlIElVc2VyIGV4dGVuZHMgRG9jdW1lbnQge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgZW1haWw6IHN0cmluZztcclxuICAgIHBhc3M6IHN0cmluZztcclxuICAgIHJlc2V0VG9rZW4/OiBzdHJpbmc7XHJcbiAgICByZXNldFRva2VuRXhwaXJhdGlvbj86IERhdGU7XHJcbiAgICBjYXJ0OiB7XHJcbiAgICAgICAgcHJvZHVjdHM6IHtcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBUeXBlcy5PYmplY3RJZCB8IElQcm9kdWN0O1xyXG4gICAgICAgICAgICBjbnQ6IG51bWJlcjtcclxuICAgICAgICB9W11cclxuICAgIH07XHJcbiAgICBvcmRlcnM6IHtcclxuICAgICAgICBwcm9kdWN0czoge1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IFR5cGVzLk9iamVjdElkIHwgSVByb2R1Y3Q7XHJcbiAgICAgICAgICAgIGNudDogbnVtYmVyO1xyXG4gICAgICAgIH1bXVxyXG4gICAgfVtdO1xyXG4gICAgYWRkVG9DYXJ0OiAocHJvZHVjdDogSVByb2R1Y3QpID0+IFByb21pc2U8SVVzZXI+O1xyXG4gICAgcmVtb3ZlRnJvbUNhcnRPbmU6IChwcm9kdWN0SWQ6IHN0cmluZykgPT4gUHJvbWlzZTxJVXNlcj47XHJcbiAgICByZW1vdmVGcm9tQ2FydEFsbDogKHByb2R1Y3RJZD86IHN0cmluZykgPT4gUHJvbWlzZTxJVXNlcj47XHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBJVXNlclBvcHVsYXRlZCBleHRlbmRzIElVc2VyIHtcclxuICAgIGNhcnQ6IHtcclxuICAgICAgICBwcm9kdWN0czoge1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IElQcm9kdWN0O1xyXG4gICAgICAgICAgICBjbnQ6IG51bWJlcjtcclxuICAgICAgICB9W11cclxuICAgIH0sXHJcbiAgICBvcmRlcnM6IHtcclxuICAgICAgICBwcm9kdWN0czoge1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IElQcm9kdWN0O1xyXG4gICAgICAgICAgICBjbnQ6IG51bWJlcjtcclxuICAgICAgICB9W11cclxuICAgIH1bXTtcclxufVxyXG51c2VyU2NoZW1hLm1ldGhvZHMuYWRkVG9DYXJ0ID0gYXN5bmMgZnVuY3Rpb24gKHByb2R1Y3Q6IElQcm9kdWN0KSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2FydC5wcm9kdWN0cy5maW5kSW5kZXgoYSA9PiBhLnByb2R1Y3RJZC5lcXVhbHMocHJvZHVjdC5faWQpKTtcclxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHNbaW5kZXhdLmNudCsrO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy5jYXJ0LnByb2R1Y3RzLnB1c2goe1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IFR5cGVzLk9iamVjdElkKHByb2R1Y3QuX2lkKSxcclxuICAgICAgICAgICAgY250OiAxXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zYXZlKCk7XHJcbn1cclxudXNlclNjaGVtYS5tZXRob2RzLnJlbW92ZUZyb21DYXJ0T25lID0gYXN5bmMgZnVuY3Rpb24gKHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2FydC5wcm9kdWN0cy5maW5kSW5kZXgoYSA9PiAoYS5wcm9kdWN0SWQgYXMgVHlwZXMuT2JqZWN0SWQpLmVxdWFscyhwcm9kdWN0SWQpKTtcclxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHNbaW5kZXhdLmNudC0tO1xyXG4gICAgICAgIGlmICh0aGlzLmNhcnQucHJvZHVjdHNbaW5kZXhdLmNudCA9PT0gMClcclxuICAgICAgICAgICAgdGhpcy5jYXJ0LnByb2R1Y3RzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyAnRVJST1IgLSByZW1vdmVGcm9tQ2FydE9uZTogaWQgZG9lc25cXCd0IGV4aXN0JztcclxuICAgIH1cclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNhdmUoKTtcclxufVxyXG51c2VyU2NoZW1hLm1ldGhvZHMucmVtb3ZlRnJvbUNhcnRBbGwgPSBhc3luYyBmdW5jdGlvbiAocHJvZHVjdElkPzogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXByb2R1Y3RJZCkge1xyXG4gICAgICAgIHRoaXMuY2FydC5wcm9kdWN0cyA9IFtdO1xyXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnNhdmUoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jYXJ0LnByb2R1Y3RzLmZpbmRJbmRleChhID0+IChhLnByb2R1Y3RJZCBhcyBUeXBlcy5PYmplY3RJZCkuZXF1YWxzKHByb2R1Y3RJZCkpO1xyXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgIHRoaXMuY2FydC5wcm9kdWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgJ0VSUk9SIC0gcmVtb3ZlRnJvbUNhcnRPbmU6IGlkIGRvZXNuXFwndCBleGlzdCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zYXZlKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1vZGVsPElVc2VyPignVXNlcicsIHVzZXJTY2hlbWEpO1xyXG4vLyBpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuLy8gaW1wb3J0IENhcnQgZnJvbSAnLi9jYXJ0JztcclxuLy8gaW1wb3J0IHsgZ2V0RGIgfSBmcm9tICcuLi91dGlsL2RhdGFiYXNlJztcclxuLy8gaW1wb3J0IHsgTW9kZWwsIERhdGFUeXBlcywgT3B0aW9uYWwsIEhhc09uZUdldEFzc29jaWF0aW9uTWl4aW4sIEFzc29jaWF0aW9uIH0gZnJvbSAnc2VxdWVsaXplJztcclxuLy8gaW1wb3J0IG1vbmdvQ29uZWN0IGZyb20gJy4uL3V0aWwvZGF0YWJhc2UnO1xyXG4vLyBpbXBvcnQgeyBEYiwgT2JqZWN0SWQsIE9iamVjdElEIH0gZnJvbSAnbW9uZ29kYic7XHJcbi8vIGltcG9ydCBQcm9kdWN0IGZyb20gJy4vcHJvZHVjdCc7XHJcblxyXG4vLyBjbGFzcyBVc2Vye1xyXG4vLyAgICAgX2lkPzogT2JqZWN0SWQ7XHJcbi8vICAgICBuYW1lOiBzdHJpbmc7XHJcbi8vICAgICBlbWFpbDogc3RyaW5nO1xyXG4vLyAgICAgY2FydDpDYXJ0O1xyXG4vLyAgICAgLyoqXHJcbi8vICAgICAgKlxyXG4vLyAgICAgICovXHJcbi8vICAgICBjb25zdHJ1Y3RvcihuYW1lOnN0cmluZyxlbWFpbDpzdHJpbmcsIGlkPzpPYmplY3RJZCwgY2FydD86Q2FydCkge1xyXG4vLyAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbi8vICAgICAgICAgdGhpcy5lbWFpbCA9IGVtYWlsO1xyXG4vLyAgICAgICAgIHRoaXMuX2lkID0gaWQgPyBpZCA6IHVuZGVmaW5lZDtcclxuLy8gICAgICAgICB0aGlzLmNhcnQgPSBjYXJ0P2NhcnQ6bmV3IENhcnQoKTtcclxuLy8gICAgIH1cclxuXHJcblxyXG5cclxuLy8gICAgIGFzeW5jIHJlbW92ZUZyb21DYXJ0T25lKHByb2R1Y3RJZDpPYmplY3RJZCl7XHJcbi8vICAgICAgICAgXHJcbi8vICAgICB9XHJcbi8vICAgICBzdGF0aWMgYXN5bmMgcmVtb3ZlUHJvZHVjdEZyb21DYXJ0cyhwcm9kdWN0SWQ6T2JqZWN0SWQpe1xyXG4vLyAgICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuLy8gICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCd1c2VycycpLnVwZGF0ZU1hbnkoe30se1xyXG4vLyAgICAgICAgICAgICAkcHVsbDp7XHJcbi8vICAgICAgICAgICAgICAgICAnY2FydC5wcm9kdWN0cyc6IHtwcm9kdWN0SWQ6IHByb2R1Y3RJZH1cclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0pO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgYXN5bmMgcmVtb3ZlRnJvbUNhcnRBbGwocHJvZHVjdElkPzpPYmplY3RJZCl7XHJcbi8vICAgICAgICAgXHJcbi8vICAgICB9XHJcbi8vICAgICBzdGF0aWMgZGF0YVRvVXNlcihkYXRhOmFueSl7XHJcbi8vICAgICAgICAgcmV0dXJuIG5ldyBVc2VyKFxyXG4vLyAgICAgICAgICAgICBkYXRhLm5hbWUsXHJcbi8vICAgICAgICAgICAgIGRhdGEuZW1haWwsXHJcbi8vICAgICAgICAgICAgIGRhdGEuX2lkLFxyXG4vLyAgICAgICAgICAgICBDYXJ0LmRhdGFUb0NhcnQoZGF0YS5jYXJ0KVxyXG4vLyAgICAgICAgICk7XHJcbi8vICAgICB9XHJcbi8vICAgICBzdGF0aWMgYXN5bmMgZmV0Y2hBbGwoKXtcclxuLy8gICAgICAgICByZXR1cm4gYXdhaXQgZ2V0RGIoKS5jb2xsZWN0aW9uKCd1c2VycycpXHJcbi8vICAgICAgICAgICAgIC5maW5kKClcclxuLy8gICAgICAgICAgICAgLm1hcChwPT50aGlzLmRhdGFUb1VzZXIocCkpXHJcbi8vICAgICAgICAgICAgIC50b0FycmF5KCk7XHJcbi8vICAgICB9XHJcbi8vICAgICBzdGF0aWMgYXN5bmMgZmluZEJ5SWQoaWQ6T2JqZWN0SWQpe1xyXG4vLyAgICAgICAgIHJldHVybiB0aGlzLmRhdGFUb1VzZXIoIFxyXG4vLyAgICAgICAgICAgICBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuLy8gICAgICAgICAgICAgICAgIC5maW5kT25lKHtfaWQ6IGlkfSkpO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgc3RhdGljIGFzeW5jIGRlbGV0ZUJ5SWQoaWQ6T2JqZWN0SWQpe1xyXG4vLyAgICAgICAgIHJldHVybiBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuLy8gICAgICAgICAgIC5kZWxldGVPbmUoe19pZDppZH0pO1xyXG4vLyAgICAgfSAgXHJcbi8vICAgICBhc3luYyBzYXZlKCl7XHJcbi8vICAgICAgICAgY29uc3QgZGIgPSBnZXREYigpO1xyXG4vLyAgICAgICAgIGlmKHRoaXMuX2lkKXtcclxuLy8gICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuLy8gICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoe19pZDogdGhpcy5faWR9LCB7JHNldDogdGhpc30pO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgICAgICBlbHNle1xyXG4vLyAgICAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuY29sbGVjdGlvbigndXNlcnMnKS5pbnNlcnRPbmUodGhpcyk7XHJcbi8vICAgICAgICAgICAgIHRoaXMuX2lkID0gcmVzdWx0cy5pbnNlcnRlZElkO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuXHJcbi8vIC8vIGV4cG9ydCBpbnRlcmZhY2UgVXNlckF0dHJpYnV0ZXMge1xyXG4vLyAvLyAgICAgaWQ6IG51bWJlcixcclxuLy8gLy8gICAgIG5hbWU6IHN0cmluZyxcclxuLy8gLy8gICAgIGVtYWlsOiBzdHJpbmcsXHJcbi8vIC8vIH1cclxuLy8gLy8gaW50ZXJmYWNlIFVzZXJDcmVhdGlvbkF0dHJpYnV0ZXMgZXh0ZW5kcyBPcHRpb25hbDxVc2VyQXR0cmlidXRlcywgXCJpZFwiPiB7IH1cclxuXHJcblxyXG4vLyAvLyBjbGFzcyBVc2VyIGV4dGVuZHMgTW9kZWw8VXNlckF0dHJpYnV0ZXMsIFVzZXJDcmVhdGlvbkF0dHJpYnV0ZXM+XHJcbi8vIC8vICAgICBpbXBsZW1lbnRzIFVzZXJBdHRyaWJ1dGVzIHtcclxuLy8gLy8gICAgIHB1YmxpYyBpZCE6IG51bWJlcjtcclxuLy8gLy8gICAgIHB1YmxpYyBuYW1lITogc3RyaW5nO1xyXG4vLyAvLyAgICAgcHVibGljIGVtYWlsITogc3RyaW5nO1xyXG5cclxuLy8gLy8gICAgIC8vIHRpbWVzdGFtcHMhXHJcbi8vIC8vICAgICBwdWJsaWMgcmVhZG9ubHkgY3JlYXRlZEF0ITogRGF0ZTtcclxuLy8gLy8gICAgIHB1YmxpYyByZWFkb25seSB1cGRhdGVkQXQhOiBEYXRlO1xyXG5cclxuLy8gLy8gICAgIHB1YmxpYyBnZXRDYXJ0ITogSGFzT25lR2V0QXNzb2NpYXRpb25NaXhpbjxDYXJ0PjtcclxuLy8gLy8gICAgIHB1YmxpYyBjcmVhdGVDYXJ0ITogSGFzT25lQ3JlYXRlQXNzb2NpYXRpb25NaXhpbjxDYXJ0PjtcclxuXHJcbi8vIC8vICAgICBwdWJsaWMgZ2V0UHJvZHVjdHMhOiBIYXNNYW55R2V0QXNzb2NpYXRpb25zTWl4aW48UHJvZHVjdD47XHJcbi8vIC8vICAgICBwdWJsaWMgYWRkUHJvZHVjdCE6IEhhc01hbnlBZGRBc3NvY2lhdGlvbk1peGluPFByb2R1Y3QsIG51bWJlcj47XHJcbi8vIC8vICAgICBwdWJsaWMgYWRkUHJvZHVjdHMhOiBIYXNNYW55QWRkQXNzb2NpYXRpb25zTWl4aW48UHJvZHVjdCwgbnVtYmVyPjtcclxuLy8gLy8gICAgIHB1YmxpYyBoYXNQcm9kdWN0ITogSGFzTWFueUhhc0Fzc29jaWF0aW9uTWl4aW48UHJvZHVjdCwgbnVtYmVyPjtcclxuLy8gLy8gICAgIHB1YmxpYyBjb3VudFByb2R1Y3RzITogSGFzTWFueUNvdW50QXNzb2NpYXRpb25zTWl4aW47XHJcbi8vIC8vICAgICBwdWJsaWMgY3JlYXRlUHJvZHVjdCE6IEhhc01hbnlDcmVhdGVBc3NvY2lhdGlvbk1peGluPFByb2R1Y3Q+O1xyXG5cclxuLy8gLy8gICAgIHB1YmxpYyBnZXRPcmRlcnMhOiBIYXNNYW55R2V0QXNzb2NpYXRpb25zTWl4aW48T3JkZXI+O1xyXG4vLyAvLyAgICAgcHVibGljIGFkZE9yZGVyITogSGFzTWFueUFkZEFzc29jaWF0aW9uTWl4aW48T3JkZXIsIG51bWJlcj47XHJcbi8vIC8vICAgICBwdWJsaWMgYWRkT3JkZXJzITogSGFzTWFueUFkZEFzc29jaWF0aW9uc01peGluPE9yZGVyLCBudW1iZXI+O1xyXG4vLyAvLyAgICAgcHVibGljIGhhc09yZGVyITogSGFzTWFueUhhc0Fzc29jaWF0aW9uTWl4aW48T3JkZXIsIG51bWJlcj47XHJcbi8vIC8vICAgICBwdWJsaWMgY291bnRPcmRlcnMhOiBIYXNNYW55Q291bnRBc3NvY2lhdGlvbnNNaXhpbjtcclxuLy8gLy8gICAgIHB1YmxpYyBjcmVhdGVPcmRlciE6IEhhc01hbnlDcmVhdGVBc3NvY2lhdGlvbk1peGluPE9yZGVyPjtcclxuXHJcbi8vIC8vICAgICBwdWJsaWMgcmVhZG9ubHkgcHJvZHVjdHM/OiBQcm9kdWN0W107IC8vIE5vdGUgdGhpcyBpcyBvcHRpb25hbCBzaW5jZSBpdCdzIG9ubHkgcG9wdWxhdGVkIHdoZW4gZXhwbGljaXRseSByZXF1ZXN0ZWQgaW4gY29kZVxyXG4vLyAvLyAgICAgcHVibGljIHJlYWRvbmx5IG9yZGVyc3M/OiBPcmRlcltdOyAvLyBOb3RlIHRoaXMgaXMgb3B0aW9uYWwgc2luY2UgaXQncyBvbmx5IHBvcHVsYXRlZCB3aGVuIGV4cGxpY2l0bHkgcmVxdWVzdGVkIGluIGNvZGVcclxuLy8gLy8gICAgIHB1YmxpYyByZWFkb25seSBjYXJ0PzogQ2FydDsgLy8gTm90ZSB0aGlzIGlzIG9wdGlvbmFsIHNpbmNlIGl0J3Mgb25seSBwb3B1bGF0ZWQgd2hlbiBleHBsaWNpdGx5IHJlcXVlc3RlZCBpbiBjb2RlXHJcblxyXG4vLyAvLyAgICAgcHVibGljIHN0YXRpYyBhc3NvY2lhdGlvbnM6IHtcclxuLy8gLy8gICAgICAgICBwcm9kdWN0czogQXNzb2NpYXRpb248VXNlciwgUHJvZHVjdD47XHJcbi8vIC8vICAgICAgICAgb3JkZXJzOiBBc3NvY2lhdGlvbjxVc2VyLCBPcmRlcj47XHJcbi8vIC8vICAgICAgICAgY2FydDogQXNzb2NpYXRpb248VXNlciwgQ2FydD47XHJcbi8vIC8vICAgICB9O1xyXG4vLyAvLyB9XHJcbi8vIC8vIFVzZXIuaW5pdCh7XHJcbi8vIC8vICAgICBpZDoge1xyXG4vLyAvLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5JTlRFR0VSLFxyXG4vLyAvLyAgICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWUsXHJcbi8vIC8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZSxcclxuLy8gLy8gICAgICAgICBwcmltYXJ5S2V5OiB0cnVlXHJcbi8vIC8vICAgICB9LFxyXG4vLyAvLyAgICAgbmFtZToge1xyXG4vLyAvLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5TVFJJTkcsXHJcbi8vIC8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZVxyXG4vLyAvLyAgICAgfSxcclxuLy8gLy8gICAgIGVtYWlsOiB7XHJcbi8vIC8vICAgICAgICAgdHlwZTogRGF0YVR5cGVzLlNUUklORyxcclxuLy8gLy8gICAgICAgICBhbGxvd051bGw6IGZhbHNlLFxyXG4vLyAvLyAgICAgfSxcclxuLy8gLy8gfSwge1xyXG4vLyAvLyAgICAgdGFibGVOYW1lOiAndXNlcnMnLFxyXG4vLyAvLyAgICAgc2VxdWVsaXplOiBUdXRvcmlhbFNlcXVlbGl6ZVxyXG4vLyAvLyB9KTtcclxuXHJcblxyXG4vLyBleHBvcnQgZGVmYXVsdCBVc2VyOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/models/User.ts\n");

/***/ }),

/***/ "./src/models/cartHelper.ts":
/*!**********************************!*\
  !*** ./src/models/cartHelper.ts ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nclass CartHelper {\r\n    static countPrice(cartProducts) {\r\n        const price = cartProducts.reduce((price, { productId: product, cnt }) => {\r\n            return price + product.price * cnt;\r\n        }, 0);\r\n        return price;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CartHelper);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL2NhcnRIZWxwZXIudHM/NjQ2ZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQTtBQUFBLE1BQU0sVUFBVTtJQUNaLE1BQU0sQ0FBQyxVQUFVLENBQUMsWUFBZ0Q7UUFDOUQsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQVksRUFBRSxFQUFDLFNBQVMsRUFBQyxPQUFPLEVBQUUsR0FBRyxFQUFDLEVBQUMsRUFBRTtZQUN4RSxPQUFPLEtBQUssR0FBQyxPQUFPLENBQUMsS0FBSyxHQUFDLEdBQUcsQ0FBQztRQUNuQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDTixPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDO0NBQ0o7QUFHYyx5RUFBVSxFQUFDIiwiZmlsZSI6Ii4vc3JjL21vZGVscy9jYXJ0SGVscGVyLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb2R1Y3QsIHsgSVByb2R1Y3QgfSBmcm9tICcuL3Byb2R1Y3QnO1xyXG5cclxuXHJcbmNsYXNzIENhcnRIZWxwZXJ7XHJcbiAgICBzdGF0aWMgY291bnRQcmljZShjYXJ0UHJvZHVjdHM6e3Byb2R1Y3RJZDogSVByb2R1Y3QsIGNudDpudW1iZXJ9W10pe1xyXG4gICAgICAgIGNvbnN0IHByaWNlID0gY2FydFByb2R1Y3RzLnJlZHVjZSgocHJpY2U6bnVtYmVyLCB7cHJvZHVjdElkOnByb2R1Y3QsIGNudH0pPT57XHJcbiAgICAgICAgICAgIHJldHVybiBwcmljZStwcm9kdWN0LnByaWNlKmNudDtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICByZXR1cm4gcHJpY2U7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJ0SGVscGVyO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/models/cartHelper.ts\n");

/***/ }),

/***/ "./src/models/order.ts":
/*!*****************************!*\
  !*** ./src/models/order.ts ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\r\n;\r\nconst orderSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__[\"Schema\"]({\r\n    products: [{\r\n            product: {\r\n                productId: {\r\n                    type: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"SchemaTypes\"].ObjectId,\r\n                    required: true,\r\n                    ref: 'Product'\r\n                },\r\n                title: {\r\n                    type: String,\r\n                    required: true\r\n                },\r\n                price: {\r\n                    type: Number,\r\n                    required: true\r\n                }\r\n            },\r\n            cnt: {\r\n                type: Number,\r\n                required: true\r\n            }\r\n        }],\r\n    price: Number,\r\n    userId: {\r\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"SchemaTypes\"].ObjectId,\r\n        required: true,\r\n        ref: 'User'\r\n    }\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(mongoose__WEBPACK_IMPORTED_MODULE_0__[\"model\"])('Order', orderSchema));\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL29yZGVyLnRzPzU2ZjIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQXVFO0FBY3RFLENBQUM7QUFDRixNQUFNLFdBQVcsR0FBRyxJQUFJLCtDQUFNLENBQVM7SUFDbkMsUUFBUSxFQUFFLENBQUM7WUFDUCxPQUFPLEVBQUM7Z0JBQ0osU0FBUyxFQUFFO29CQUNQLElBQUksRUFBRSxvREFBVyxDQUFDLFFBQVE7b0JBQzFCLFFBQVEsRUFBRSxJQUFJO29CQUNkLEdBQUcsRUFBRSxTQUFTO2lCQUNqQjtnQkFDRCxLQUFLLEVBQUM7b0JBQ0YsSUFBSSxFQUFFLE1BQU07b0JBQ1osUUFBUSxFQUFFLElBQUk7aUJBQ2pCO2dCQUNELEtBQUssRUFBQztvQkFDRixJQUFJLEVBQUUsTUFBTTtvQkFDWixRQUFRLEVBQUUsSUFBSTtpQkFDakI7YUFDSjtZQUNELEdBQUcsRUFBRTtnQkFDRCxJQUFJLEVBQUUsTUFBTTtnQkFDWixRQUFRLEVBQUUsSUFBSTthQUNqQjtTQUNKLENBQUM7SUFDRixLQUFLLEVBQUUsTUFBTTtJQUNiLE1BQU0sRUFBRTtRQUNKLElBQUksRUFBRSxvREFBVyxDQUFDLFFBQVE7UUFDMUIsUUFBUSxFQUFFLElBQUk7UUFDZCxHQUFHLEVBQUUsTUFBTTtLQUNkO0NBQ0osQ0FBQyxDQUFDO0FBRVkscUhBQUssQ0FBUyxPQUFPLEVBQUUsV0FBVyxDQUFDLEVBQUMiLCJmaWxlIjoiLi9zcmMvbW9kZWxzL29yZGVyLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NoZW1hLCBTY2hlbWFUeXBlcywgVHlwZXMsIG1vZGVsLCBEb2N1bWVudCB9IGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU9yZGVyIGV4dGVuZHMgRG9jdW1lbnQge1xyXG4gICAgcHJvZHVjdHM6e1xyXG4gICAgICAgIHByb2R1Y3Q6IHtcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBUeXBlcy5PYmplY3RJZCxcclxuICAgICAgICAgICAgdGl0bGU6IHN0cmluZyxcclxuICAgICAgICAgICAgcHJpY2U6IG51bWJlclxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY250OiBudW1iZXJcclxuICAgIH1bXSxcclxuICAgIHByaWNlOiBudW1iZXIsXHJcbiAgICB1c2VySWQ6IFR5cGVzLk9iamVjdElkXHJcbn07XHJcbmNvbnN0IG9yZGVyU2NoZW1hID0gbmV3IFNjaGVtYTxJT3JkZXI+KHtcclxuICAgIHByb2R1Y3RzOiBbe1xyXG4gICAgICAgIHByb2R1Y3Q6e1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFNjaGVtYVR5cGVzLk9iamVjdElkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICByZWY6ICdQcm9kdWN0J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aXRsZTp7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwcmljZTp7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbnQ6IHtcclxuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIH1dLFxyXG4gICAgcHJpY2U6IE51bWJlcixcclxuICAgIHVzZXJJZDoge1xyXG4gICAgICAgIHR5cGU6IFNjaGVtYVR5cGVzLk9iamVjdElkLFxyXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIHJlZjogJ1VzZXInXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgbW9kZWw8SU9yZGVyPignT3JkZXInLCBvcmRlclNjaGVtYSk7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/models/order.ts\n");

/***/ }),

/***/ "./src/models/product.ts":
/*!*******************************!*\
  !*** ./src/models/product.ts ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\r\nconst productSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__[\"Schema\"]({\r\n    title: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    price: {\r\n        type: Number,\r\n        required: true\r\n    },\r\n    description: {\r\n        type: String,\r\n        required: true,\r\n    },\r\n    imageUrl: {\r\n        type: String,\r\n        required: true,\r\n        default: 'https://cdn.pixabay.com/photo/2016/03/31/20/51/book-1296045_960_720.png'\r\n    },\r\n    ownerId: {\r\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__[\"SchemaTypes\"].ObjectId,\r\n        ref: 'User',\r\n        required: true\r\n    }\r\n});\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (mongoose__WEBPACK_IMPORTED_MODULE_0___default.a.model('Product', productSchema));\r\n// import path from 'path';\r\n// import Cart from './cart';\r\n// import { getDb } from '../util/database';\r\n// import { Model, DataTypes, Optional, HasOneGetAssociationMixin, Association } from 'sequelize';\r\n// import User from './user';\r\n// import mongoConect from '../util/database';\r\n// import { Db, ObjectId } from 'mongodb';\r\n// class Product{\r\n//     _id?:ObjectId;\r\n//     userId:ObjectId;\r\n//     title:string;\r\n//     price:number;\r\n//     description:string;\r\n//     imageUrl:string|undefined;\r\n//     /**\r\n//      *\r\n//      */\r\n//     constructor(title:string,price:number,description:string,imageUrl:string|undefined, userId:ObjectId, id?:ObjectId) {\r\n//         this.title = title;\r\n//         this.price = price;\r\n//         this.description = description;\r\n//         this.imageUrl = imageUrl;\r\n//         this.userId = userId;\r\n//         this._id = id ? id : undefined;\r\n//     }\r\n//     static dataToProduct(data:any){\r\n//         return new Product(\r\n//             data.title,\r\n//             data.price,\r\n//             data.description,\r\n//             data.imageUrl,\r\n//             data.userId,\r\n//             data._id,\r\n//         );\r\n//     }\r\n//     static async fetchAll(){\r\n//         return await getDb().collection('products')\r\n//             .find()\r\n//             .map(p=>this.dataToProduct(p))\r\n//             .toArray();\r\n//     }\r\n//     static async findById(id:ObjectId){\r\n//         return this.dataToProduct( \r\n//             await getDb().collection('products')\r\n//                 .findOne({_id: id}));\r\n//     }\r\n//     static async deleteById(id:ObjectId){\r\n//         await User.removeProductFromCarts(id);\r\n//         return await getDb().collection('products')\r\n//           .deleteOne({_id:id});\r\n//     }  \r\n//     async save(){\r\n//         const db = getDb();\r\n//         if(!this.imageUrl) \r\n//             this.imageUrl = 'https://cdn.pixabay.com/photo/2016/03/31/20/51/book-1296045_960_720.png';\r\n//         if(this._id){\r\n//             const results = await db.collection('products')\r\n//                 .updateOne({_id: this._id}, {$set: this});\r\n//         }\r\n//         else{\r\n//             const results = await db.collection('products').insertOne(this);\r\n//             this._id = results.insertedId;\r\n//         }\r\n//     }\r\n// }\r\n// // export interface ProductAttributes {\r\n// //     id: number,\r\n// //     title: string,\r\n// //     price: number,\r\n// //     description: string,\r\n// //     imageUrl?: string,\r\n// //     ownerId: number\r\n// // }\r\n// // interface ProductCreationAttributes extends Optional<ProductAttributes, \"id\"> {}\r\n// // class Product extends Model<ProductAttributes, ProductCreationAttributes>\r\n// //     implements ProductAttributes {\r\n// //     public id!: number;\r\n// //     public title!: string;\r\n// //     public price!: number;\r\n// //     public description!: string;\r\n// //     public imageUrl!: string;\r\n// //     public ownerId!: number;\r\n// //     public getOwner!: HasOneGetAssociationMixin<User>;\r\n// //     // timestamps!\r\n// //     public readonly createdAt!: Date;\r\n// //     public readonly updatedAt!: Date;\r\n// //     public readonly owner?: User;\r\n// //     public readonly cartItem?: CartItem;\r\n// //     public readonly orderItem?: OrderItem;\r\n// //     public static associations: {\r\n// //         owner: Association<User, User>;\r\n// //     }; \r\n// // }\r\n// // Product.init({\r\n// //     id: {\r\n// //         type: DataTypes.INTEGER,\r\n// //         autoIncrement: true,\r\n// //         allowNull: false,\r\n// //         primaryKey: true\r\n// //     },\r\n// //     title: {\r\n// //         type: DataTypes.STRING,\r\n// //         allowNull: false\r\n// //     },\r\n// //     price: {\r\n// //         type: DataTypes.DOUBLE,\r\n// //         allowNull: false,\r\n// //     },\r\n// //     imageUrl: {\r\n// //         type: DataTypes.TEXT,\r\n// //         defaultValue: 'https://cdn.pixabay.com/photo/2016/03/31/20/51/book-1296045_960_720.png',\r\n// //         allowNull: false,\r\n// //     },\r\n// //     description: {\r\n// //         type: DataTypes.TEXT,\r\n// //         allowNull: false\r\n// //     },\r\n// //     ownerId: {\r\n// //         type: DataTypes.INTEGER,\r\n// //         allowNull: false\r\n// //     }\r\n// // },{\r\n// //     tableName: 'products',\r\n// //     modelName: 'product',\r\n// //     sequelize: TutorialSequelize \r\n// // });\r\n// // Product.belongsTo(User, {\r\n// //     targetKey: 'id',\r\n// //     foreignKey: 'ownerId',\r\n// //     constraints: true,\r\n// //     onDelete: 'CASCADE',\r\n// //     as: 'owner'\r\n// // });\r\n// // Product.belongsToMany(Cart,{\r\n// //     sourceKey: 'id',\r\n// //     targetKey: 'id',\r\n// //     foreignKey: 'productId',\r\n// //     otherKey: 'cartId',\r\n// //     uniqueKey: 'id',  \r\n// //     through: 'cartItem',\r\n// // });\r\n// // Product.belongsToMany(Order,{\r\n// //     sourceKey: 'id',\r\n// //     targetKey: 'id',\r\n// //     foreignKey: 'productId',\r\n// //     otherKey: 'orderId',\r\n// //     uniqueKey: 'id',  \r\n// //     through: 'orderItem',\r\n// // });\r\n// export default Product;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL3Byb2R1Y3QudHM/YmFhMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBbUU7QUFFbkUsTUFBTSxhQUFhLEdBQUcsSUFBSSwrQ0FBTSxDQUFXO0lBQ3ZDLEtBQUssRUFBQztRQUNGLElBQUksRUFBQyxNQUFNO1FBQ1gsUUFBUSxFQUFFLElBQUk7S0FDakI7SUFDRCxLQUFLLEVBQUM7UUFDRixJQUFJLEVBQUMsTUFBTTtRQUNYLFFBQVEsRUFBQyxJQUFJO0tBQ2hCO0lBQ0QsV0FBVyxFQUFDO1FBQ1IsSUFBSSxFQUFDLE1BQU07UUFDWCxRQUFRLEVBQUMsSUFBSTtLQUNoQjtJQUNELFFBQVEsRUFBQztRQUNMLElBQUksRUFBQyxNQUFNO1FBQ1gsUUFBUSxFQUFDLElBQUk7UUFDYixPQUFPLEVBQUUseUVBQXlFO0tBQ3JGO0lBQ0QsT0FBTyxFQUFDO1FBQ0osSUFBSSxFQUFDLG9EQUFXLENBQUMsUUFBUTtRQUN6QixHQUFHLEVBQUUsTUFBTTtRQUNYLFFBQVEsRUFBRSxJQUFJO0tBQ2pCO0NBQ0osQ0FBQyxDQUFDO0FBUVksOEdBQVEsQ0FBQyxLQUFLLENBQVcsU0FBUyxFQUFFLGFBQWEsQ0FBQyxFQUFDO0FBR2xFLDJCQUEyQjtBQUMzQiw2QkFBNkI7QUFDN0IsNENBQTRDO0FBQzVDLGtHQUFrRztBQUNsRyw2QkFBNkI7QUFDN0IsOENBQThDO0FBQzlDLDBDQUEwQztBQUcxQyxpQkFBaUI7QUFDakIscUJBQXFCO0FBQ3JCLHVCQUF1QjtBQUN2QixvQkFBb0I7QUFDcEIsb0JBQW9CO0FBQ3BCLDBCQUEwQjtBQUMxQixpQ0FBaUM7QUFDakMsVUFBVTtBQUNWLFNBQVM7QUFDVCxVQUFVO0FBQ1YsMkhBQTJIO0FBQzNILDhCQUE4QjtBQUM5Qiw4QkFBOEI7QUFDOUIsMENBQTBDO0FBQzFDLG9DQUFvQztBQUNwQyxnQ0FBZ0M7QUFDaEMsMENBQTBDO0FBQzFDLFFBQVE7QUFDUixzQ0FBc0M7QUFDdEMsOEJBQThCO0FBQzlCLDBCQUEwQjtBQUMxQiwwQkFBMEI7QUFDMUIsZ0NBQWdDO0FBQ2hDLDZCQUE2QjtBQUM3QiwyQkFBMkI7QUFDM0Isd0JBQXdCO0FBQ3hCLGFBQWE7QUFDYixRQUFRO0FBQ1IsK0JBQStCO0FBQy9CLHNEQUFzRDtBQUN0RCxzQkFBc0I7QUFDdEIsNkNBQTZDO0FBQzdDLDBCQUEwQjtBQUMxQixRQUFRO0FBQ1IsMENBQTBDO0FBQzFDLHNDQUFzQztBQUN0QyxtREFBbUQ7QUFDbkQsd0NBQXdDO0FBQ3hDLFFBQVE7QUFDUiw0Q0FBNEM7QUFDNUMsaURBQWlEO0FBQ2pELHNEQUFzRDtBQUN0RCxrQ0FBa0M7QUFDbEMsVUFBVTtBQUNWLG9CQUFvQjtBQUNwQiw4QkFBOEI7QUFDOUIsOEJBQThCO0FBQzlCLHlHQUF5RztBQUN6Ryx3QkFBd0I7QUFDeEIsOERBQThEO0FBQzlELDZEQUE2RDtBQUM3RCxZQUFZO0FBQ1osZ0JBQWdCO0FBQ2hCLCtFQUErRTtBQUMvRSw2Q0FBNkM7QUFDN0MsWUFBWTtBQUNaLFFBQVE7QUFDUixJQUFJO0FBQ0osMENBQTBDO0FBQzFDLHFCQUFxQjtBQUNyQix3QkFBd0I7QUFDeEIsd0JBQXdCO0FBQ3hCLDhCQUE4QjtBQUM5Qiw0QkFBNEI7QUFDNUIseUJBQXlCO0FBQ3pCLE9BQU87QUFDUCxzRkFBc0Y7QUFHdEYsK0VBQStFO0FBQy9FLHdDQUF3QztBQUN4Qyw2QkFBNkI7QUFDN0IsZ0NBQWdDO0FBQ2hDLGdDQUFnQztBQUNoQyxzQ0FBc0M7QUFDdEMsbUNBQW1DO0FBQ25DLGtDQUFrQztBQUVsQyw0REFBNEQ7QUFDNUQsd0JBQXdCO0FBQ3hCLDJDQUEyQztBQUMzQywyQ0FBMkM7QUFFM0MsdUNBQXVDO0FBQ3ZDLDhDQUE4QztBQUM5QyxnREFBZ0Q7QUFDaEQsdUNBQXVDO0FBQ3ZDLDZDQUE2QztBQUM3QyxhQUFhO0FBQ2IsT0FBTztBQUNQLG9CQUFvQjtBQUNwQixlQUFlO0FBQ2Ysc0NBQXNDO0FBQ3RDLGtDQUFrQztBQUNsQywrQkFBK0I7QUFDL0IsOEJBQThCO0FBQzlCLFlBQVk7QUFDWixrQkFBa0I7QUFDbEIscUNBQXFDO0FBQ3JDLDhCQUE4QjtBQUM5QixZQUFZO0FBQ1osa0JBQWtCO0FBQ2xCLHFDQUFxQztBQUNyQywrQkFBK0I7QUFDL0IsWUFBWTtBQUNaLHFCQUFxQjtBQUNyQixtQ0FBbUM7QUFDbkMsc0dBQXNHO0FBQ3RHLCtCQUErQjtBQUMvQixZQUFZO0FBQ1osd0JBQXdCO0FBQ3hCLG1DQUFtQztBQUNuQyw4QkFBOEI7QUFDOUIsWUFBWTtBQUNaLG9CQUFvQjtBQUNwQixzQ0FBc0M7QUFDdEMsOEJBQThCO0FBQzlCLFdBQVc7QUFDWCxTQUFTO0FBQ1QsZ0NBQWdDO0FBQ2hDLCtCQUErQjtBQUMvQix1Q0FBdUM7QUFDdkMsU0FBUztBQUVULCtCQUErQjtBQUMvQiwwQkFBMEI7QUFDMUIsZ0NBQWdDO0FBQ2hDLDRCQUE0QjtBQUM1Qiw4QkFBOEI7QUFDOUIscUJBQXFCO0FBQ3JCLFNBQVM7QUFDVCxrQ0FBa0M7QUFDbEMsMEJBQTBCO0FBQzFCLDBCQUEwQjtBQUMxQixrQ0FBa0M7QUFDbEMsNkJBQTZCO0FBQzdCLDRCQUE0QjtBQUM1Qiw4QkFBOEI7QUFDOUIsU0FBUztBQUNULG1DQUFtQztBQUNuQywwQkFBMEI7QUFDMUIsMEJBQTBCO0FBQzFCLGtDQUFrQztBQUNsQyw4QkFBOEI7QUFDOUIsNEJBQTRCO0FBQzVCLCtCQUErQjtBQUMvQixTQUFTO0FBQ1QsMEJBQTBCIiwiZmlsZSI6Ii4vc3JjL21vZGVscy9wcm9kdWN0LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IFNjaGVtYSwgRG9jdW1lbnQsIFNjaGVtYVR5cGVzIH0gZnJvbSAnbW9uZ29vc2UnO1xyXG5cclxuY29uc3QgcHJvZHVjdFNjaGVtYSA9IG5ldyBTY2hlbWE8SVByb2R1Y3Q+KHtcclxuICAgIHRpdGxlOntcclxuICAgICAgICB0eXBlOlN0cmluZyxcclxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgfSxcclxuICAgIHByaWNlOntcclxuICAgICAgICB0eXBlOk51bWJlcixcclxuICAgICAgICByZXF1aXJlZDp0cnVlXHJcbiAgICB9LFxyXG4gICAgZGVzY3JpcHRpb246e1xyXG4gICAgICAgIHR5cGU6U3RyaW5nLFxyXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXHJcbiAgICB9LFxyXG4gICAgaW1hZ2VVcmw6e1xyXG4gICAgICAgIHR5cGU6U3RyaW5nLFxyXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXHJcbiAgICAgICAgZGVmYXVsdDogJ2h0dHBzOi8vY2RuLnBpeGFiYXkuY29tL3Bob3RvLzIwMTYvMDMvMzEvMjAvNTEvYm9vay0xMjk2MDQ1Xzk2MF83MjAucG5nJ1xyXG4gICAgfSxcclxuICAgIG93bmVySWQ6e1xyXG4gICAgICAgIHR5cGU6U2NoZW1hVHlwZXMuT2JqZWN0SWQsXHJcbiAgICAgICAgcmVmOiAnVXNlcicsXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH1cclxufSk7XHJcbmV4cG9ydCBpbnRlcmZhY2UgSVByb2R1Y3QgZXh0ZW5kcyBEb2N1bWVudHtcclxuICAgIHRpdGxlOnN0cmluZztcclxuICAgIHByaWNlOm51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOnN0cmluZztcclxuICAgIGltYWdlVXJsPzpzdHJpbmc7XHJcbiAgICBvd25lcklkOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWRcclxufVxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbDxJUHJvZHVjdD4oJ1Byb2R1Y3QnLCBwcm9kdWN0U2NoZW1hKTtcclxuXHJcblxyXG4vLyBpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuLy8gaW1wb3J0IENhcnQgZnJvbSAnLi9jYXJ0JztcclxuLy8gaW1wb3J0IHsgZ2V0RGIgfSBmcm9tICcuLi91dGlsL2RhdGFiYXNlJztcclxuLy8gaW1wb3J0IHsgTW9kZWwsIERhdGFUeXBlcywgT3B0aW9uYWwsIEhhc09uZUdldEFzc29jaWF0aW9uTWl4aW4sIEFzc29jaWF0aW9uIH0gZnJvbSAnc2VxdWVsaXplJztcclxuLy8gaW1wb3J0IFVzZXIgZnJvbSAnLi91c2VyJztcclxuLy8gaW1wb3J0IG1vbmdvQ29uZWN0IGZyb20gJy4uL3V0aWwvZGF0YWJhc2UnO1xyXG4vLyBpbXBvcnQgeyBEYiwgT2JqZWN0SWQgfSBmcm9tICdtb25nb2RiJztcclxuXHJcblxyXG4vLyBjbGFzcyBQcm9kdWN0e1xyXG4vLyAgICAgX2lkPzpPYmplY3RJZDtcclxuLy8gICAgIHVzZXJJZDpPYmplY3RJZDtcclxuLy8gICAgIHRpdGxlOnN0cmluZztcclxuLy8gICAgIHByaWNlOm51bWJlcjtcclxuLy8gICAgIGRlc2NyaXB0aW9uOnN0cmluZztcclxuLy8gICAgIGltYWdlVXJsOnN0cmluZ3x1bmRlZmluZWQ7XHJcbi8vICAgICAvKipcclxuLy8gICAgICAqXHJcbi8vICAgICAgKi9cclxuLy8gICAgIGNvbnN0cnVjdG9yKHRpdGxlOnN0cmluZyxwcmljZTpudW1iZXIsZGVzY3JpcHRpb246c3RyaW5nLGltYWdlVXJsOnN0cmluZ3x1bmRlZmluZWQsIHVzZXJJZDpPYmplY3RJZCwgaWQ/Ok9iamVjdElkKSB7XHJcbi8vICAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4vLyAgICAgICAgIHRoaXMucHJpY2UgPSBwcmljZTtcclxuLy8gICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbi8vICAgICAgICAgdGhpcy5pbWFnZVVybCA9IGltYWdlVXJsO1xyXG4vLyAgICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xyXG4vLyAgICAgICAgIHRoaXMuX2lkID0gaWQgPyBpZCA6IHVuZGVmaW5lZDtcclxuLy8gICAgIH1cclxuLy8gICAgIHN0YXRpYyBkYXRhVG9Qcm9kdWN0KGRhdGE6YW55KXtcclxuLy8gICAgICAgICByZXR1cm4gbmV3IFByb2R1Y3QoXHJcbi8vICAgICAgICAgICAgIGRhdGEudGl0bGUsXHJcbi8vICAgICAgICAgICAgIGRhdGEucHJpY2UsXHJcbi8vICAgICAgICAgICAgIGRhdGEuZGVzY3JpcHRpb24sXHJcbi8vICAgICAgICAgICAgIGRhdGEuaW1hZ2VVcmwsXHJcbi8vICAgICAgICAgICAgIGRhdGEudXNlcklkLFxyXG4vLyAgICAgICAgICAgICBkYXRhLl9pZCxcclxuLy8gICAgICAgICApO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgc3RhdGljIGFzeW5jIGZldGNoQWxsKCl7XHJcbi8vICAgICAgICAgcmV0dXJuIGF3YWl0IGdldERiKCkuY29sbGVjdGlvbigncHJvZHVjdHMnKVxyXG4vLyAgICAgICAgICAgICAuZmluZCgpXHJcbi8vICAgICAgICAgICAgIC5tYXAocD0+dGhpcy5kYXRhVG9Qcm9kdWN0KHApKVxyXG4vLyAgICAgICAgICAgICAudG9BcnJheSgpO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgc3RhdGljIGFzeW5jIGZpbmRCeUlkKGlkOk9iamVjdElkKXtcclxuLy8gICAgICAgICByZXR1cm4gdGhpcy5kYXRhVG9Qcm9kdWN0KCBcclxuLy8gICAgICAgICAgICAgYXdhaXQgZ2V0RGIoKS5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXHJcbi8vICAgICAgICAgICAgICAgICAuZmluZE9uZSh7X2lkOiBpZH0pKTtcclxuLy8gICAgIH1cclxuLy8gICAgIHN0YXRpYyBhc3luYyBkZWxldGVCeUlkKGlkOk9iamVjdElkKXtcclxuLy8gICAgICAgICBhd2FpdCBVc2VyLnJlbW92ZVByb2R1Y3RGcm9tQ2FydHMoaWQpO1xyXG4vLyAgICAgICAgIHJldHVybiBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3Byb2R1Y3RzJylcclxuLy8gICAgICAgICAgIC5kZWxldGVPbmUoe19pZDppZH0pO1xyXG4vLyAgICAgfSAgXHJcbi8vICAgICBhc3luYyBzYXZlKCl7XHJcbi8vICAgICAgICAgY29uc3QgZGIgPSBnZXREYigpO1xyXG4vLyAgICAgICAgIGlmKCF0aGlzLmltYWdlVXJsKSBcclxuLy8gICAgICAgICAgICAgdGhpcy5pbWFnZVVybCA9ICdodHRwczovL2Nkbi5waXhhYmF5LmNvbS9waG90by8yMDE2LzAzLzMxLzIwLzUxL2Jvb2stMTI5NjA0NV85NjBfNzIwLnBuZyc7XHJcbi8vICAgICAgICAgaWYodGhpcy5faWQpe1xyXG4vLyAgICAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuY29sbGVjdGlvbigncHJvZHVjdHMnKVxyXG4vLyAgICAgICAgICAgICAgICAgLnVwZGF0ZU9uZSh7X2lkOiB0aGlzLl9pZH0sIHskc2V0OiB0aGlzfSk7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgICAgIGVsc2V7XHJcbi8vICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdwcm9kdWN0cycpLmluc2VydE9uZSh0aGlzKTtcclxuLy8gICAgICAgICAgICAgdGhpcy5faWQgPSByZXN1bHRzLmluc2VydGVkSWQ7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfVxyXG4vLyB9XHJcbi8vIC8vIGV4cG9ydCBpbnRlcmZhY2UgUHJvZHVjdEF0dHJpYnV0ZXMge1xyXG4vLyAvLyAgICAgaWQ6IG51bWJlcixcclxuLy8gLy8gICAgIHRpdGxlOiBzdHJpbmcsXHJcbi8vIC8vICAgICBwcmljZTogbnVtYmVyLFxyXG4vLyAvLyAgICAgZGVzY3JpcHRpb246IHN0cmluZyxcclxuLy8gLy8gICAgIGltYWdlVXJsPzogc3RyaW5nLFxyXG4vLyAvLyAgICAgb3duZXJJZDogbnVtYmVyXHJcbi8vIC8vIH1cclxuLy8gLy8gaW50ZXJmYWNlIFByb2R1Y3RDcmVhdGlvbkF0dHJpYnV0ZXMgZXh0ZW5kcyBPcHRpb25hbDxQcm9kdWN0QXR0cmlidXRlcywgXCJpZFwiPiB7fVxyXG5cclxuXHJcbi8vIC8vIGNsYXNzIFByb2R1Y3QgZXh0ZW5kcyBNb2RlbDxQcm9kdWN0QXR0cmlidXRlcywgUHJvZHVjdENyZWF0aW9uQXR0cmlidXRlcz5cclxuLy8gLy8gICAgIGltcGxlbWVudHMgUHJvZHVjdEF0dHJpYnV0ZXMge1xyXG4vLyAvLyAgICAgcHVibGljIGlkITogbnVtYmVyO1xyXG4vLyAvLyAgICAgcHVibGljIHRpdGxlITogc3RyaW5nO1xyXG4vLyAvLyAgICAgcHVibGljIHByaWNlITogbnVtYmVyO1xyXG4vLyAvLyAgICAgcHVibGljIGRlc2NyaXB0aW9uITogc3RyaW5nO1xyXG4vLyAvLyAgICAgcHVibGljIGltYWdlVXJsITogc3RyaW5nO1xyXG4vLyAvLyAgICAgcHVibGljIG93bmVySWQhOiBudW1iZXI7XHJcblxyXG4vLyAvLyAgICAgcHVibGljIGdldE93bmVyITogSGFzT25lR2V0QXNzb2NpYXRpb25NaXhpbjxVc2VyPjtcclxuLy8gLy8gICAgIC8vIHRpbWVzdGFtcHMhXHJcbi8vIC8vICAgICBwdWJsaWMgcmVhZG9ubHkgY3JlYXRlZEF0ITogRGF0ZTtcclxuLy8gLy8gICAgIHB1YmxpYyByZWFkb25seSB1cGRhdGVkQXQhOiBEYXRlO1xyXG5cclxuLy8gLy8gICAgIHB1YmxpYyByZWFkb25seSBvd25lcj86IFVzZXI7XHJcbi8vIC8vICAgICBwdWJsaWMgcmVhZG9ubHkgY2FydEl0ZW0/OiBDYXJ0SXRlbTtcclxuLy8gLy8gICAgIHB1YmxpYyByZWFkb25seSBvcmRlckl0ZW0/OiBPcmRlckl0ZW07XHJcbi8vIC8vICAgICBwdWJsaWMgc3RhdGljIGFzc29jaWF0aW9uczoge1xyXG4vLyAvLyAgICAgICAgIG93bmVyOiBBc3NvY2lhdGlvbjxVc2VyLCBVc2VyPjtcclxuLy8gLy8gICAgIH07IFxyXG4vLyAvLyB9XHJcbi8vIC8vIFByb2R1Y3QuaW5pdCh7XHJcbi8vIC8vICAgICBpZDoge1xyXG4vLyAvLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5JTlRFR0VSLFxyXG4vLyAvLyAgICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWUsXHJcbi8vIC8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZSxcclxuLy8gLy8gICAgICAgICBwcmltYXJ5S2V5OiB0cnVlXHJcbi8vIC8vICAgICB9LFxyXG4vLyAvLyAgICAgdGl0bGU6IHtcclxuLy8gLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuU1RSSU5HLFxyXG4vLyAvLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2VcclxuLy8gLy8gICAgIH0sXHJcbi8vIC8vICAgICBwcmljZToge1xyXG4vLyAvLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5ET1VCTEUsXHJcbi8vIC8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZSxcclxuLy8gLy8gICAgIH0sXHJcbi8vIC8vICAgICBpbWFnZVVybDoge1xyXG4vLyAvLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5URVhULFxyXG4vLyAvLyAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ2h0dHBzOi8vY2RuLnBpeGFiYXkuY29tL3Bob3RvLzIwMTYvMDMvMzEvMjAvNTEvYm9vay0xMjk2MDQ1Xzk2MF83MjAucG5nJyxcclxuLy8gLy8gICAgICAgICBhbGxvd051bGw6IGZhbHNlLFxyXG4vLyAvLyAgICAgfSxcclxuLy8gLy8gICAgIGRlc2NyaXB0aW9uOiB7XHJcbi8vIC8vICAgICAgICAgdHlwZTogRGF0YVR5cGVzLlRFWFQsXHJcbi8vIC8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZVxyXG4vLyAvLyAgICAgfSxcclxuLy8gLy8gICAgIG93bmVySWQ6IHtcclxuLy8gLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuSU5URUdFUixcclxuLy8gLy8gICAgICAgICBhbGxvd051bGw6IGZhbHNlXHJcbi8vIC8vICAgICB9XHJcbi8vIC8vIH0se1xyXG4vLyAvLyAgICAgdGFibGVOYW1lOiAncHJvZHVjdHMnLFxyXG4vLyAvLyAgICAgbW9kZWxOYW1lOiAncHJvZHVjdCcsXHJcbi8vIC8vICAgICBzZXF1ZWxpemU6IFR1dG9yaWFsU2VxdWVsaXplIFxyXG4vLyAvLyB9KTtcclxuXHJcbi8vIC8vIFByb2R1Y3QuYmVsb25nc1RvKFVzZXIsIHtcclxuLy8gLy8gICAgIHRhcmdldEtleTogJ2lkJyxcclxuLy8gLy8gICAgIGZvcmVpZ25LZXk6ICdvd25lcklkJyxcclxuLy8gLy8gICAgIGNvbnN0cmFpbnRzOiB0cnVlLFxyXG4vLyAvLyAgICAgb25EZWxldGU6ICdDQVNDQURFJyxcclxuLy8gLy8gICAgIGFzOiAnb3duZXInXHJcbi8vIC8vIH0pO1xyXG4vLyAvLyBQcm9kdWN0LmJlbG9uZ3NUb01hbnkoQ2FydCx7XHJcbi8vIC8vICAgICBzb3VyY2VLZXk6ICdpZCcsXHJcbi8vIC8vICAgICB0YXJnZXRLZXk6ICdpZCcsXHJcbi8vIC8vICAgICBmb3JlaWduS2V5OiAncHJvZHVjdElkJyxcclxuLy8gLy8gICAgIG90aGVyS2V5OiAnY2FydElkJyxcclxuLy8gLy8gICAgIHVuaXF1ZUtleTogJ2lkJywgIFxyXG4vLyAvLyAgICAgdGhyb3VnaDogJ2NhcnRJdGVtJyxcclxuLy8gLy8gfSk7XHJcbi8vIC8vIFByb2R1Y3QuYmVsb25nc1RvTWFueShPcmRlcix7XHJcbi8vIC8vICAgICBzb3VyY2VLZXk6ICdpZCcsXHJcbi8vIC8vICAgICB0YXJnZXRLZXk6ICdpZCcsXHJcbi8vIC8vICAgICBmb3JlaWduS2V5OiAncHJvZHVjdElkJyxcclxuLy8gLy8gICAgIG90aGVyS2V5OiAnb3JkZXJJZCcsXHJcbi8vIC8vICAgICB1bmlxdWVLZXk6ICdpZCcsICBcclxuLy8gLy8gICAgIHRocm91Z2g6ICdvcmRlckl0ZW0nLFxyXG4vLyAvLyB9KTtcclxuLy8gZXhwb3J0IGRlZmF1bHQgUHJvZHVjdDsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/models/product.ts\n");

/***/ }),

/***/ "./src/routes/admin.ts":
/*!*****************************!*\
  !*** ./src/routes/admin.ts ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _controllers_admin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controllers/admin */ \"./src/controllers/admin.ts\");\n/* harmony import */ var _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../middleware/isAuth */ \"./middleware/isAuth.ts\");\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! express-validator */ \"express-validator\");\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(express_validator__WEBPACK_IMPORTED_MODULE_3__);\n\r\n\r\n\r\n\r\nconst adminRouter = Object(express__WEBPACK_IMPORTED_MODULE_0__[\"Router\"])();\r\nadminRouter.get('/add-product', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getAddProduct\"]);\r\nadminRouter.post('/add-product', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], [\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('title')\r\n        .trim()\r\n        .isString().withMessage('Title must be string')\r\n        .isLength({ min: 3 }).withMessage('Title must be at least 3 characters'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('image')\r\n        .notEmpty().withMessage('Attached file in not an imamge'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('price')\r\n        .trim()\r\n        .isFloat({ min: 0 }).withMessage('Price must be number greater or equal 0'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('description')\r\n        .trim()\r\n        .isLength({ min: 5, max: 400 }).withMessage('Description should have between 5 and 400 characters')\r\n], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postAddProduct\"]);\r\nadminRouter.get('/products', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getAdminProducts\"]);\r\nadminRouter.get('/edit-product/:id', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getEditProduct\"]);\r\nadminRouter.post('/delete-product/:id', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postDeleteProduct\"]);\r\nadminRouter.post('/edit-product/:id', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], [\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('title')\r\n        .trim()\r\n        .isString().withMessage('Title must be string')\r\n        .isLength({ min: 3 }).withMessage('Title must be at least 3 characters'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('image')\r\n        .notEmpty().withMessage('Attached file in not an image'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('price')\r\n        .trim()\r\n        .isFloat({ min: 0 }).withMessage('Price must be number greater or equal 0'),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_3__[\"body\"])('description')\r\n        .trim()\r\n        .isLength({ min: 5, max: 400 }).withMessage('Description should have between 5 and 400 characters')\r\n], _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postEditProduct\"]);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (adminRouter);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL2FkbWluLnRzPzNmNTEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDdUI7QUFDWDtBQUNGO0FBRTNDLE1BQU0sV0FBVyxHQUFHLHNEQUFNLEVBQUUsQ0FBQztBQUU3QixXQUFXLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSwwREFBTSxFQUFFLGdFQUE2QixDQUFDLENBQUM7QUFFdkUsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsMERBQU0sRUFBRTtJQUNyQyw4REFBSSxDQUFDLE9BQU8sQ0FBQztTQUNSLElBQUksRUFBRTtTQUNOLFFBQVEsRUFBRSxDQUFDLFdBQVcsQ0FBQyxzQkFBc0IsQ0FBQztTQUM5QyxRQUFRLENBQUMsRUFBQyxHQUFHLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMscUNBQXFDLENBQUM7SUFDMUUsOERBQUksQ0FBQyxPQUFPLENBQUM7U0FDUixRQUFRLEVBQUUsQ0FBQyxXQUFXLENBQUMsZ0NBQWdDLENBQUM7SUFDN0QsOERBQUksQ0FBQyxPQUFPLENBQUM7U0FDUixJQUFJLEVBQUU7U0FDTixPQUFPLENBQUMsRUFBQyxHQUFHLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMseUNBQXlDLENBQUM7SUFDN0UsOERBQUksQ0FBQyxhQUFhLENBQUM7U0FDZCxJQUFJLEVBQUU7U0FDTixRQUFRLENBQUMsRUFBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxzREFBc0QsQ0FBQztDQUN4RyxFQUFFLGlFQUE4QixDQUFDLENBQUM7QUFFbkMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsMERBQU0sRUFBRSxtRUFBZ0MsQ0FBQyxDQUFDO0FBRXZFLFdBQVcsQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsMERBQU0sRUFBRSxpRUFBOEIsQ0FBQztBQUU1RSxXQUFXLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLDBEQUFNLEVBQUUsb0VBQWlDLENBQUM7QUFFbEYsV0FBVyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSwwREFBTSxFQUFFO0lBQzFDLDhEQUFJLENBQUMsT0FBTyxDQUFDO1NBQ1IsSUFBSSxFQUFFO1NBQ04sUUFBUSxFQUFFLENBQUMsV0FBVyxDQUFDLHNCQUFzQixDQUFDO1NBQzlDLFFBQVEsQ0FBQyxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxxQ0FBcUMsQ0FBQztJQUUxRSw4REFBSSxDQUFDLE9BQU8sQ0FBQztTQUNSLFFBQVEsRUFBRSxDQUFDLFdBQVcsQ0FBQywrQkFBK0IsQ0FBQztJQUM1RCw4REFBSSxDQUFDLE9BQU8sQ0FBQztTQUNSLElBQUksRUFBRTtTQUNOLE9BQU8sQ0FBQyxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyx5Q0FBeUMsQ0FBQztJQUM3RSw4REFBSSxDQUFDLGFBQWEsQ0FBQztTQUNkLElBQUksRUFBRTtTQUNOLFFBQVEsQ0FBQyxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUMsV0FBVyxDQUFDLHNEQUFzRCxDQUFDO0NBQ3hHLEVBQUcsa0VBQStCLENBQUM7QUFFckIsMEVBQVcsRUFBQyIsImZpbGUiOiIuL3NyYy9yb3V0ZXMvYWRtaW4udHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgKiBhcyBBZG1pbkNvbnRyb2xsZXIgZnJvbSBcIi4uL2NvbnRyb2xsZXJzL2FkbWluXCI7XHJcbmltcG9ydCBpc0F1dGggZnJvbSBcIi4uLy4uL21pZGRsZXdhcmUvaXNBdXRoXCI7XHJcbmltcG9ydCB7IGJvZHksICB9IGZyb20gXCJleHByZXNzLXZhbGlkYXRvclwiO1xyXG5cclxuY29uc3QgYWRtaW5Sb3V0ZXIgPSBSb3V0ZXIoKTtcclxuXHJcbmFkbWluUm91dGVyLmdldCgnL2FkZC1wcm9kdWN0JywgaXNBdXRoLCBBZG1pbkNvbnRyb2xsZXIuZ2V0QWRkUHJvZHVjdCk7XHJcblxyXG5hZG1pblJvdXRlci5wb3N0KCcvYWRkLXByb2R1Y3QnLCBpc0F1dGgsIFtcclxuICAgIGJvZHkoJ3RpdGxlJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLmlzU3RyaW5nKCkud2l0aE1lc3NhZ2UoJ1RpdGxlIG11c3QgYmUgc3RyaW5nJylcclxuICAgICAgICAuaXNMZW5ndGgoe21pbjogM30pLndpdGhNZXNzYWdlKCdUaXRsZSBtdXN0IGJlIGF0IGxlYXN0IDMgY2hhcmFjdGVycycpLFxyXG4gICAgYm9keSgnaW1hZ2UnKVxyXG4gICAgICAgIC5ub3RFbXB0eSgpLndpdGhNZXNzYWdlKCdBdHRhY2hlZCBmaWxlIGluIG5vdCBhbiBpbWFtZ2UnKSxcclxuICAgIGJvZHkoJ3ByaWNlJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLmlzRmxvYXQoe21pbjogMH0pLndpdGhNZXNzYWdlKCdQcmljZSBtdXN0IGJlIG51bWJlciBncmVhdGVyIG9yIGVxdWFsIDAnKSxcclxuICAgIGJvZHkoJ2Rlc2NyaXB0aW9uJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLmlzTGVuZ3RoKHttaW46IDUsIG1heDogNDAwfSkud2l0aE1lc3NhZ2UoJ0Rlc2NyaXB0aW9uIHNob3VsZCBoYXZlIGJldHdlZW4gNSBhbmQgNDAwIGNoYXJhY3RlcnMnKVxyXG5dLCBBZG1pbkNvbnRyb2xsZXIucG9zdEFkZFByb2R1Y3QpO1xyXG5cclxuYWRtaW5Sb3V0ZXIuZ2V0KCcvcHJvZHVjdHMnLCBpc0F1dGgsIEFkbWluQ29udHJvbGxlci5nZXRBZG1pblByb2R1Y3RzKTtcclxuXHJcbmFkbWluUm91dGVyLmdldCgnL2VkaXQtcHJvZHVjdC86aWQnLCBpc0F1dGgsIEFkbWluQ29udHJvbGxlci5nZXRFZGl0UHJvZHVjdClcclxuXHJcbmFkbWluUm91dGVyLnBvc3QoJy9kZWxldGUtcHJvZHVjdC86aWQnLCBpc0F1dGgsIEFkbWluQ29udHJvbGxlci5wb3N0RGVsZXRlUHJvZHVjdClcclxuXHJcbmFkbWluUm91dGVyLnBvc3QoJy9lZGl0LXByb2R1Y3QvOmlkJywgaXNBdXRoLCBbXHJcbiAgICBib2R5KCd0aXRsZScpXHJcbiAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgIC5pc1N0cmluZygpLndpdGhNZXNzYWdlKCdUaXRsZSBtdXN0IGJlIHN0cmluZycpXHJcbiAgICAgICAgLmlzTGVuZ3RoKHttaW46IDN9KS53aXRoTWVzc2FnZSgnVGl0bGUgbXVzdCBiZSBhdCBsZWFzdCAzIGNoYXJhY3RlcnMnKSxcclxuXHJcbiAgICBib2R5KCdpbWFnZScpXHJcbiAgICAgICAgLm5vdEVtcHR5KCkud2l0aE1lc3NhZ2UoJ0F0dGFjaGVkIGZpbGUgaW4gbm90IGFuIGltYWdlJyksXHJcbiAgICBib2R5KCdwcmljZScpXHJcbiAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgIC5pc0Zsb2F0KHttaW46IDB9KS53aXRoTWVzc2FnZSgnUHJpY2UgbXVzdCBiZSBudW1iZXIgZ3JlYXRlciBvciBlcXVhbCAwJyksXHJcbiAgICBib2R5KCdkZXNjcmlwdGlvbicpXHJcbiAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgIC5pc0xlbmd0aCh7bWluOiA1LCBtYXg6IDQwMH0pLndpdGhNZXNzYWdlKCdEZXNjcmlwdGlvbiBzaG91bGQgaGF2ZSBiZXR3ZWVuIDUgYW5kIDQwMCBjaGFyYWN0ZXJzJylcclxuXSwgIEFkbWluQ29udHJvbGxlci5wb3N0RWRpdFByb2R1Y3QpXHJcblxyXG5leHBvcnQgZGVmYXVsdCBhZG1pblJvdXRlcjsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/routes/admin.ts\n");

/***/ }),

/***/ "./src/routes/auth.ts":
/*!****************************!*\
  !*** ./src/routes/auth.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _controllers_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controllers/auth */ \"./src/controllers/auth.ts\");\n/* harmony import */ var _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../middleware/isAuth */ \"./middleware/isAuth.ts\");\n/* harmony import */ var _middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../middleware/isNotAuth */ \"./middleware/isNotAuth.ts\");\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! express-validator */ \"express-validator\");\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(express_validator__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models/User */ \"./src/models/User.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst authRouter = Object(express__WEBPACK_IMPORTED_MODULE_0__[\"Router\"])();\r\nauthRouter.get('/login', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"getLogin\"]);\r\nauthRouter.post('/login', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), [\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_4__[\"body\"])('email')\r\n        .trim()\r\n        .normalizeEmail(),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_4__[\"body\"])('password')\r\n        .trim()\r\n], _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"postLogin\"]);\r\nauthRouter.post('/logout', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"postLogout\"]);\r\nauthRouter.get('/signup', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"getSignup\"]);\r\nauthRouter.post('/signup', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), [\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_4__[\"body\"])('email')\r\n        .trim()\r\n        .isEmail().withMessage(\"Email is invalid\")\r\n        .bail()\r\n        .custom((value) => __awaiter(void 0, void 0, void 0, function* () {\r\n        const user = yield _models_User__WEBPACK_IMPORTED_MODULE_5__[\"default\"].findOne({ email: value });\r\n        if (user)\r\n            throw new Error('Email exists already');\r\n        return true;\r\n    }))\r\n        .normalizeEmail(),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_4__[\"body\"])('password')\r\n        .trim()\r\n        .isLength({ min: 5 }).withMessage(\"Password should have at least 5 characters\")\r\n        .isAlphanumeric().withMessage(\"Password may only consist of text and digits\")\r\n        .custom((value, { req }) => value === req.body.confirmPassword)\r\n        .withMessage(\"Passwords are different\"),\r\n    Object(express_validator__WEBPACK_IMPORTED_MODULE_4__[\"body\"])('confirmPassword')\r\n        .trim()\r\n], _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"postSignup\"]);\r\nauthRouter.get('/reset-password', _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"getResetPassword\"]);\r\nauthRouter.post('/reset-password', _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"postResetPassword\"]);\r\nauthRouter.get('/new-password/:token', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"getNewPassword\"]);\r\nauthRouter.post('/new-password', Object(_middleware_isNotAuth__WEBPACK_IMPORTED_MODULE_3__[\"default\"])('/'), _controllers_auth__WEBPACK_IMPORTED_MODULE_1__[\"postNewPassword\"]);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (authRouter);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL2F1dGgudHM/ZWY4YSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUM7QUFDa0k7QUFDdEg7QUFDTTtBQUNMO0FBQ1o7QUFFbEMsTUFBTSxVQUFVLEdBQUcsc0RBQU0sRUFBRSxDQUFDO0FBRzVCLFVBQVUsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLHFFQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsMERBQVEsQ0FBQyxDQUFDO0FBQ25ELFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLHFFQUFTLENBQUMsR0FBRyxDQUFDLEVBQUM7SUFDckMsOERBQUksQ0FBQyxPQUFPLENBQUM7U0FDUixJQUFJLEVBQUU7U0FDTixjQUFjLEVBQUU7SUFDckIsOERBQUksQ0FBQyxVQUFVLENBQUM7U0FDWCxJQUFJLEVBQUU7Q0FDZCxFQUFFLDJEQUFTLENBQUMsQ0FBQztBQUNkLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLDBEQUFNLEVBQUUsNERBQVUsQ0FBQyxDQUFDO0FBQy9DLFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLHFFQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsMkRBQVMsQ0FBQyxDQUFDO0FBRXJELFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLHFFQUFTLENBQUMsR0FBRyxDQUFDLEVBQUU7SUFDdkMsOERBQUksQ0FBQyxPQUFPLENBQUM7U0FDUixJQUFJLEVBQUU7U0FDTixPQUFPLEVBQUUsQ0FBQyxXQUFXLENBQUMsa0JBQWtCLENBQUM7U0FDekMsSUFBSSxFQUFFO1NBQ04sTUFBTSxDQUFDLENBQU8sS0FBSyxFQUFDLEVBQUU7UUFDbkIsTUFBTSxJQUFJLEdBQUcsTUFBTSxvREFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO1FBQ2hELElBQUcsSUFBSTtZQUNILE1BQU0sSUFBSSxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUM1QyxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDLEVBQUM7U0FDRCxjQUFjLEVBQUU7SUFFckIsOERBQUksQ0FBQyxVQUFVLENBQUM7U0FDWCxJQUFJLEVBQUU7U0FDTixRQUFRLENBQUMsRUFBQyxHQUFHLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsNENBQTRDLENBQUM7U0FDNUUsY0FBYyxFQUFFLENBQUMsV0FBVyxDQUFDLDhDQUE4QyxDQUFDO1NBQzVFLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUUsQ0FBQyxLQUFLLEtBQUcsR0FBRyxDQUFDLElBQUssQ0FBQyxlQUFlLENBQUU7U0FDeEQsV0FBVyxDQUFDLHlCQUF5QixDQUFDO0lBQy9DLDhEQUFJLENBQUMsaUJBQWlCLENBQUM7U0FDbEIsSUFBSSxFQUFFO0NBQ2QsRUFBRSw0REFBVSxDQUFDLENBQUM7QUFFZixVQUFVLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLGtFQUFnQixDQUFDLENBQUM7QUFDcEQsVUFBVSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxtRUFBaUIsQ0FBQyxDQUFDO0FBQ3RELFVBQVUsQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEVBQUUscUVBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxnRUFBYyxDQUFDLENBQUM7QUFDdkUsVUFBVSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUscUVBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxpRUFBZSxDQUFDLENBQUM7QUFFbkQseUVBQVUsRUFBQyIsImZpbGUiOiIuL3NyYy9yb3V0ZXMvYXV0aC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCB7IGdldExvZ2luLCBwb3N0TG9naW4sIHBvc3RMb2dvdXQsIHBvc3RTaWdudXAsIGdldFNpZ251cCwgZ2V0UmVzZXRQYXNzd29yZCwgcG9zdFJlc2V0UGFzc3dvcmQsIGdldE5ld1Bhc3N3b3JkLCBwb3N0TmV3UGFzc3dvcmQgfSBmcm9tIFwiLi4vY29udHJvbGxlcnMvYXV0aFwiO1xyXG5pbXBvcnQgaXNBdXRoIGZyb20gXCIuLi8uLi9taWRkbGV3YXJlL2lzQXV0aFwiO1xyXG5pbXBvcnQgaXNOb3RBdXRoIGZyb20gXCIuLi8uLi9taWRkbGV3YXJlL2lzTm90QXV0aFwiO1xyXG5pbXBvcnQge2NoZWNrLCBib2R5fSBmcm9tICdleHByZXNzLXZhbGlkYXRvcic7XHJcbmltcG9ydCBVc2VyIGZyb20gXCIuLi9tb2RlbHMvVXNlclwiO1xyXG5cclxuY29uc3QgYXV0aFJvdXRlciA9IFJvdXRlcigpO1xyXG5cclxuXHJcbmF1dGhSb3V0ZXIuZ2V0KCcvbG9naW4nLCBpc05vdEF1dGgoJy8nKSwgZ2V0TG9naW4pO1xyXG5hdXRoUm91dGVyLnBvc3QoJy9sb2dpbicsIGlzTm90QXV0aCgnLycpLFtcclxuICAgIGJvZHkoJ2VtYWlsJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLm5vcm1hbGl6ZUVtYWlsKCksXHJcbiAgICBib2R5KCdwYXNzd29yZCcpXHJcbiAgICAgICAgLnRyaW0oKVxyXG5dLCBwb3N0TG9naW4pO1xyXG5hdXRoUm91dGVyLnBvc3QoJy9sb2dvdXQnLCBpc0F1dGgsIHBvc3RMb2dvdXQpO1xyXG5hdXRoUm91dGVyLmdldCgnL3NpZ251cCcsIGlzTm90QXV0aCgnLycpLCBnZXRTaWdudXApO1xyXG5cclxuYXV0aFJvdXRlci5wb3N0KCcvc2lnbnVwJywgaXNOb3RBdXRoKCcvJyksIFtcclxuICAgIGJvZHkoJ2VtYWlsJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLmlzRW1haWwoKS53aXRoTWVzc2FnZShcIkVtYWlsIGlzIGludmFsaWRcIilcclxuICAgICAgICAuYmFpbCgpXHJcbiAgICAgICAgLmN1c3RvbShhc3luYyAodmFsdWUpPT57XHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoe2VtYWlsOiB2YWx1ZX0pO1xyXG4gICAgICAgICAgICBpZih1c2VyKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbWFpbCBleGlzdHMgYWxyZWFkeScpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5ub3JtYWxpemVFbWFpbCgpLFxyXG5cclxuICAgIGJvZHkoJ3Bhc3N3b3JkJylcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLmlzTGVuZ3RoKHttaW46IDV9KS53aXRoTWVzc2FnZShcIlBhc3N3b3JkIHNob3VsZCBoYXZlIGF0IGxlYXN0IDUgY2hhcmFjdGVyc1wiKVxyXG4gICAgICAgIC5pc0FscGhhbnVtZXJpYygpLndpdGhNZXNzYWdlKFwiUGFzc3dvcmQgbWF5IG9ubHkgY29uc2lzdCBvZiB0ZXh0IGFuZCBkaWdpdHNcIilcclxuICAgICAgICAuY3VzdG9tKCh2YWx1ZSwge3JlcX0pID0+IHZhbHVlPT09cmVxLmJvZHkhLmNvbmZpcm1QYXNzd29yZCApXHJcbiAgICAgICAgICAgIC53aXRoTWVzc2FnZShcIlBhc3N3b3JkcyBhcmUgZGlmZmVyZW50XCIpLFxyXG4gICAgYm9keSgnY29uZmlybVBhc3N3b3JkJylcclxuICAgICAgICAudHJpbSgpXHJcbl0sIHBvc3RTaWdudXApO1xyXG5cclxuYXV0aFJvdXRlci5nZXQoJy9yZXNldC1wYXNzd29yZCcsIGdldFJlc2V0UGFzc3dvcmQpO1xyXG5hdXRoUm91dGVyLnBvc3QoJy9yZXNldC1wYXNzd29yZCcsIHBvc3RSZXNldFBhc3N3b3JkKTtcclxuYXV0aFJvdXRlci5nZXQoJy9uZXctcGFzc3dvcmQvOnRva2VuJywgaXNOb3RBdXRoKCcvJyksIGdldE5ld1Bhc3N3b3JkKTtcclxuYXV0aFJvdXRlci5wb3N0KCcvbmV3LXBhc3N3b3JkJywgaXNOb3RBdXRoKCcvJyksIHBvc3ROZXdQYXNzd29yZCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhdXRoUm91dGVyOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/routes/auth.ts\n");

/***/ }),

/***/ "./src/routes/shop.ts":
/*!****************************!*\
  !*** ./src/routes/shop.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _controllers_shop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controllers/shop */ \"./src/controllers/shop.ts\");\n/* harmony import */ var _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../middleware/isAuth */ \"./middleware/isAuth.ts\");\n\r\n\r\n\r\nconst shopRouter = Object(express__WEBPACK_IMPORTED_MODULE_0__[\"Router\"])();\r\nshopRouter.get('/', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getIndex\"]);\r\nshopRouter.get('/products', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getProducts\"]);\r\nshopRouter.get('/products/:id', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getProduct\"]);\r\nshopRouter.get('/cart', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getCart\"]);\r\nshopRouter.post('/cart', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCart\"]);\r\nshopRouter.post('/cart-delete-item', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCartDeleteItem\"]);\r\nshopRouter.post('/cart-delete-items', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCartDeleteItems\"]);\r\nshopRouter.get('/orders', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getOrders\"]);\r\nshopRouter.post('/create-order', _middleware_isAuth__WEBPACK_IMPORTED_MODULE_2__[\"default\"], _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCreateOrder\"]);\r\n// // shopRouter.get('/checkout', ShopController.getCheckout);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (shopRouter);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL3Nob3AudHM/M2ZjNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ3FCO0FBQ1Q7QUFDN0MsTUFBTSxVQUFVLEdBQUcsc0RBQU0sRUFBRSxDQUFDO0FBRTVCLFVBQVUsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLDBEQUF1QixDQUFDLENBQUM7QUFDN0MsVUFBVSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsNkRBQTBCLENBQUMsQ0FBQztBQUN4RCxVQUFVLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSw0REFBeUIsQ0FBQyxDQUFDO0FBQzNELFVBQVUsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLDBEQUFNLEVBQUUseURBQXNCLENBQUMsQ0FBQztBQUN4RCxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSwwREFBTSxFQUFFLDBEQUF1QixDQUFDLENBQUM7QUFDMUQsVUFBVSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSwwREFBTSxFQUFFLG9FQUFpQyxDQUFDLENBQUM7QUFDaEYsVUFBVSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsRUFBRSwwREFBTSxFQUFFLHFFQUFrQyxDQUFDLENBQUM7QUFDbEYsVUFBVSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsMERBQU0sRUFBRSwyREFBd0IsQ0FBQyxDQUFDO0FBQzVELFVBQVUsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLDBEQUFNLEVBQUUsaUVBQThCLENBQUMsQ0FBQztBQUN6RSw4REFBOEQ7QUFFL0MseUVBQVUsRUFBQyIsImZpbGUiOiIuL3NyYy9yb3V0ZXMvc2hvcC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCAqIGFzIFNob3BDb250cm9sbGVyIGZyb20gXCIuLi9jb250cm9sbGVycy9zaG9wXCI7XHJcbmltcG9ydCBpc0F1dGggZnJvbSBcIi4uLy4uL21pZGRsZXdhcmUvaXNBdXRoXCI7XHJcbmNvbnN0IHNob3BSb3V0ZXIgPSBSb3V0ZXIoKTtcclxuXHJcbnNob3BSb3V0ZXIuZ2V0KCcvJywgU2hvcENvbnRyb2xsZXIuZ2V0SW5kZXgpO1xyXG5zaG9wUm91dGVyLmdldCgnL3Byb2R1Y3RzJywgU2hvcENvbnRyb2xsZXIuZ2V0UHJvZHVjdHMpO1xyXG5zaG9wUm91dGVyLmdldCgnL3Byb2R1Y3RzLzppZCcsIFNob3BDb250cm9sbGVyLmdldFByb2R1Y3QpO1xyXG5zaG9wUm91dGVyLmdldCgnL2NhcnQnLCBpc0F1dGgsIFNob3BDb250cm9sbGVyLmdldENhcnQpO1xyXG5zaG9wUm91dGVyLnBvc3QoJy9jYXJ0JywgaXNBdXRoLCBTaG9wQ29udHJvbGxlci5wb3N0Q2FydCk7XHJcbnNob3BSb3V0ZXIucG9zdCgnL2NhcnQtZGVsZXRlLWl0ZW0nLCBpc0F1dGgsIFNob3BDb250cm9sbGVyLnBvc3RDYXJ0RGVsZXRlSXRlbSk7XHJcbnNob3BSb3V0ZXIucG9zdCgnL2NhcnQtZGVsZXRlLWl0ZW1zJywgaXNBdXRoLCBTaG9wQ29udHJvbGxlci5wb3N0Q2FydERlbGV0ZUl0ZW1zKTtcclxuc2hvcFJvdXRlci5nZXQoJy9vcmRlcnMnLCBpc0F1dGgsIFNob3BDb250cm9sbGVyLmdldE9yZGVycyk7XHJcbnNob3BSb3V0ZXIucG9zdCgnL2NyZWF0ZS1vcmRlcicsIGlzQXV0aCwgU2hvcENvbnRyb2xsZXIucG9zdENyZWF0ZU9yZGVyKTtcclxuLy8gLy8gc2hvcFJvdXRlci5nZXQoJy9jaGVja291dCcsIFNob3BDb250cm9sbGVyLmdldENoZWNrb3V0KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHNob3BSb3V0ZXI7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/routes/shop.ts\n");

/***/ }),

/***/ "./src/util/ResponseHelper.ts":
/*!************************************!*\
  !*** ./src/util/ResponseHelper.ts ***!
  \************************************/
/*! exports provided: renderHelper, getValidationMsg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"renderHelper\", function() { return renderHelper; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getValidationMsg\", function() { return getValidationMsg; });\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express-validator */ \"express-validator\");\n/* harmony import */ var express_validator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express_validator__WEBPACK_IMPORTED_MODULE_0__);\n\r\nconst renderHelper = (req, res, view, args) => {\r\n    // let cookie = req.get('Cookie')\r\n    //     ?.split(';')\r\n    //     .reduce((obj, str)=>{\r\n    //         const val = str.trim().split('=');\r\n    //         obj[val[0]] = (val.length>=2 ? val[1] : null);\r\n    //         return obj;\r\n    //     }, {} as StringMap);\r\n    // if(cookie===undefined)\r\n    //     cookie = {};\r\n    const options = Object.assign(Object.assign({}, args), { path: args.path || view, csrfToken: req.csrfToken(), isAuthenticated: req.session.isLoggedIn === true });\r\n    res.render(view, options);\r\n};\r\nconst getValidationMsg = (req) => {\r\n    const errors = Object(express_validator__WEBPACK_IMPORTED_MODULE_0__[\"validationResult\"])(req);\r\n    if (!errors.isEmpty()) {\r\n        const errorMessage = `Correct the form to continue:<br>`\r\n            + errors.array().map((err, idx) => {\r\n                return `${idx + 1}) ${err.msg}`;\r\n            }).join(\"<br>\");\r\n        const invalid = errors.array().reduce((obj, err) => {\r\n            obj[err.param] = true;\r\n            return obj;\r\n        }, {});\r\n        return { errorMessage, invalid };\r\n    }\r\n    return null;\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9SZXNwb25zZUhlbHBlci50cz82YWEzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBcUQ7QUFHOUMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQVksRUFBRSxJQUFTLEVBQUUsRUFBRTtJQUNqRixpQ0FBaUM7SUFDakMsbUJBQW1CO0lBQ25CLDRCQUE0QjtJQUM1Qiw2Q0FBNkM7SUFDN0MseURBQXlEO0lBQ3pELHNCQUFzQjtJQUN0QiwyQkFBMkI7SUFDM0IseUJBQXlCO0lBQ3pCLG1CQUFtQjtJQUNuQixNQUFNLE9BQU8sbUNBQ04sSUFBSSxLQUNQLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksRUFDdkIsU0FBUyxFQUFFLEdBQUcsQ0FBQyxTQUFTLEVBQUUsRUFDMUIsZUFBZSxFQUFFLEdBQUcsQ0FBQyxPQUFRLENBQUMsVUFBVSxLQUFLLElBQUksR0FDcEQsQ0FBQztJQUNGLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQzlCLENBQUM7QUFFTSxNQUFNLGdCQUFnQixHQUFHLENBQUMsR0FBVyxFQUFDLEVBQUU7SUFDM0MsTUFBTSxNQUFNLEdBQUcsMEVBQWdCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDckMsSUFBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBQztRQUNqQixNQUFNLFlBQVksR0FBRyxtQ0FBbUM7Y0FDbEQsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUMsRUFBRTtnQkFDN0IsT0FBTyxHQUFHLEdBQUcsR0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNwQixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBMkIsRUFBRSxHQUFHLEVBQUMsRUFBRTtZQUN0RSxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQztZQUN0QixPQUFPLEdBQUcsQ0FBQztRQUNmLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVQLE9BQU8sRUFBQyxZQUFZLEVBQUUsT0FBTyxFQUFDLENBQUM7S0FDbEM7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDIiwiZmlsZSI6Ii4vc3JjL3V0aWwvUmVzcG9uc2VIZWxwZXIudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXNwb25zZSwgUmVxdWVzdCB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCB7IHZhbGlkYXRpb25SZXN1bHQgfSBmcm9tIFwiZXhwcmVzcy12YWxpZGF0b3JcIjtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgcmVuZGVySGVscGVyID0gKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgdmlldzogc3RyaW5nLCBhcmdzOiBhbnkpID0+IHtcclxuICAgIC8vIGxldCBjb29raWUgPSByZXEuZ2V0KCdDb29raWUnKVxyXG4gICAgLy8gICAgID8uc3BsaXQoJzsnKVxyXG4gICAgLy8gICAgIC5yZWR1Y2UoKG9iaiwgc3RyKT0+e1xyXG4gICAgLy8gICAgICAgICBjb25zdCB2YWwgPSBzdHIudHJpbSgpLnNwbGl0KCc9Jyk7XHJcbiAgICAvLyAgICAgICAgIG9ialt2YWxbMF1dID0gKHZhbC5sZW5ndGg+PTIgPyB2YWxbMV0gOiBudWxsKTtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIC8vICAgICB9LCB7fSBhcyBTdHJpbmdNYXApO1xyXG4gICAgLy8gaWYoY29va2llPT09dW5kZWZpbmVkKVxyXG4gICAgLy8gICAgIGNvb2tpZSA9IHt9O1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAuLi5hcmdzLFxyXG4gICAgICAgIHBhdGg6IGFyZ3MucGF0aCB8fCB2aWV3LFxyXG4gICAgICAgIGNzcmZUb2tlbjogcmVxLmNzcmZUb2tlbigpLFxyXG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogcmVxLnNlc3Npb24hLmlzTG9nZ2VkSW4gPT09IHRydWVcclxuICAgIH07XHJcbiAgICByZXMucmVuZGVyKHZpZXcsIG9wdGlvbnMpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VmFsaWRhdGlvbk1zZyA9IChyZXE6UmVxdWVzdCk9PntcclxuICAgIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRpb25SZXN1bHQocmVxKTtcclxuICAgIGlmKCFlcnJvcnMuaXNFbXB0eSgpKXtcclxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgQ29ycmVjdCB0aGUgZm9ybSB0byBjb250aW51ZTo8YnI+YFxyXG4gICAgICAgICAgICArIGVycm9ycy5hcnJheSgpLm1hcCgoZXJyLCBpZHgpPT57XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aWR4KzF9KSAke2Vyci5tc2d9YDtcclxuICAgICAgICAgICAgfSkuam9pbihcIjxicj5cIik7XHJcbiAgICAgICAgY29uc3QgaW52YWxpZCA9IGVycm9ycy5hcnJheSgpLnJlZHVjZSgob2JqOlJlY29yZDxzdHJpbmcsIGJvb2xlYW4+LCBlcnIpPT57XHJcbiAgICAgICAgICAgIG9ialtlcnIucGFyYW1dID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICB9LCB7fSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7ZXJyb3JNZXNzYWdlLCBpbnZhbGlkfTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/ResponseHelper.ts\n");

/***/ }),

/***/ "@sendgrid/mail":
/*!*********************************!*\
  !*** external "@sendgrid/mail" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@sendgrid/mail\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAc2VuZGdyaWQvbWFpbFwiPzJmN2YiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiQHNlbmRncmlkL21haWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJAc2VuZGdyaWQvbWFpbFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///@sendgrid/mail\n");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"bcryptjs\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJiY3J5cHRqc1wiP2NlNTUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYmNyeXB0anMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJiY3J5cHRqc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///bcryptjs\n");

/***/ }),

/***/ "body-parser":
/*!******************************!*\
  !*** external "body-parser" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"body-parser\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiPzgxODgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYm9keS1wYXJzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///body-parser\n");

/***/ }),

/***/ "connect-flash":
/*!********************************!*\
  !*** external "connect-flash" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"connect-flash\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb25uZWN0LWZsYXNoXCI/MzMyMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJjb25uZWN0LWZsYXNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY29ubmVjdC1mbGFzaFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///connect-flash\n");

/***/ }),

/***/ "connect-mongodb-session":
/*!******************************************!*\
  !*** external "connect-mongodb-session" ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"connect-mongodb-session\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb25uZWN0LW1vbmdvZGItc2Vzc2lvblwiPzNhMmEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiY29ubmVjdC1tb25nb2RiLXNlc3Npb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjb25uZWN0LW1vbmdvZGItc2Vzc2lvblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///connect-mongodb-session\n");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjcnlwdG9cIj80Yzc2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImNyeXB0by5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNyeXB0b1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///crypto\n");

/***/ }),

/***/ "csurf":
/*!************************!*\
  !*** external "csurf" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"csurf\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjc3VyZlwiPzkxODMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiY3N1cmYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjc3VyZlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///csurf\n");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dotenv\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJkb3RlbnZcIj9lNzBmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImRvdGVudi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvdGVudlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///dotenv\n");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzXCI/MjJmZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJleHByZXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///express\n");

/***/ }),

/***/ "express-session":
/*!**********************************!*\
  !*** external "express-session" ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express-session\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzLXNlc3Npb25cIj82MzRjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImV4cHJlc3Mtc2Vzc2lvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImV4cHJlc3Mtc2Vzc2lvblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///express-session\n");

/***/ }),

/***/ "express-validator":
/*!************************************!*\
  !*** external "express-validator" ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express-validator\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzLXZhbGlkYXRvclwiPzJmYTciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiZXhwcmVzcy12YWxpZGF0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJleHByZXNzLXZhbGlkYXRvclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///express-validator\n");

/***/ }),

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mongoose\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb25nb29zZVwiP2ZmZDciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibW9uZ29vc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///mongoose\n");

/***/ }),

/***/ "multer":
/*!*************************!*\
  !*** external "multer" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"multer\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtdWx0ZXJcIj9hNzA0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im11bHRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm11bHRlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///multer\n");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"path\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwYXRoXCI/NzRiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJwYXRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicGF0aFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///path\n");

/***/ })

/******/ });