/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/app.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/app.ts":
/*!********************!*\
  !*** ./src/app.ts ***!
  \********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var body_parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! body-parser */ \"body-parser\");\n/* harmony import */ var body_parser__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(body_parser__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _util_database__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/database */ \"./src/util/database.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _routes_admin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./routes/admin */ \"./src/routes/admin.ts\");\n/* harmony import */ var _routes_shop__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./routes/shop */ \"./src/routes/shop.ts\");\n/* harmony import */ var _models_user__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./models/user */ \"./src/models/user.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_7__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst app = express__WEBPACK_IMPORTED_MODULE_0___default()();\r\napp.set('view engine', 'ejs');\r\napp.set('views', Object(path__WEBPACK_IMPORTED_MODULE_3__[\"resolve\"])('views'));\r\napp.use(body_parser__WEBPACK_IMPORTED_MODULE_1___default.a.urlencoded({ extended: true }));\r\napp.use(express__WEBPACK_IMPORTED_MODULE_0___default.a.static(Object(path__WEBPACK_IMPORTED_MODULE_3__[\"resolve\"])('public')));\r\napp.use((req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const user = yield _models_user__WEBPACK_IMPORTED_MODULE_6__[\"default\"].findById(new mongodb__WEBPACK_IMPORTED_MODULE_7__[\"ObjectId\"]('5f40feac77514e76dd49950b'));\r\n    if (!user) {\r\n        console.log(\"ERROR: nie istnieje user!!!\");\r\n    }\r\n    req.user = user;\r\n    next();\r\n}));\r\napp.use('/admin', _routes_admin__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\r\napp.use(_routes_shop__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\r\n// app.use(errorsController.use404);\r\nconst start = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    try {\r\n        yield Object(_util_database__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\r\n        app.listen(3000);\r\n    }\r\n    catch (error) {\r\n        console.log(\"ERROR\", error.message);\r\n    }\r\n});\r\nstart();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYXBwLnRzPzA2NmUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE4QjtBQUNPO0FBQ0s7QUFDWDtBQUNVO0FBQ0Y7QUFDTjtBQUNFO0FBV25DLE1BQU0sR0FBRyxHQUFHLDhDQUFPLEVBQUUsQ0FBQztBQUV0QixHQUFHLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUM5QixHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxvREFBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFFbkMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxrREFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakQsR0FBRyxDQUFDLEdBQUcsQ0FBQyw4Q0FBTyxDQUFDLE1BQU0sQ0FBQyxvREFBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUUzQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQU8sR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUMsRUFBRTtJQUM1QixNQUFNLElBQUksR0FBRyxNQUFNLG9EQUFJLENBQUMsUUFBUSxDQUFDLElBQUksZ0RBQVEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQzFFLElBQUcsQ0FBQyxJQUFJLEVBQUM7UUFDTCxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7S0FDOUM7SUFDRCxHQUFHLENBQUMsSUFBSSxHQUFHLElBQUssQ0FBQztJQUNqQixJQUFJLEVBQUUsQ0FBQztBQUNYLENBQUMsRUFBQyxDQUFDO0FBQ0gsR0FBRyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUscURBQVcsQ0FBQyxDQUFDO0FBQy9CLEdBQUcsQ0FBQyxHQUFHLENBQUMsb0RBQVUsQ0FBQyxDQUFDO0FBRXBCLG9DQUFvQztBQUdwQyxNQUFNLEtBQUssR0FBRyxHQUFPLEVBQUU7SUFDbkIsSUFBSTtRQUNBLE1BQU0sOERBQVcsRUFBRSxDQUFDO1FBQ3BCLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDcEI7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFHLEtBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztLQUNsRDtBQUNMLENBQUMsRUFBQztBQUNGLEtBQUssRUFBRSxDQUFDIiwiZmlsZSI6Ii4vc3JjL2FwcC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xyXG5pbXBvcnQgYm9keVBhcnNlciBmcm9tICdib2R5LXBhcnNlcic7XHJcbmltcG9ydCBtb25nb0NvbmVjdCBmcm9tICcuL3V0aWwvZGF0YWJhc2UnO1xyXG5pbXBvcnQgeyByZXNvbHZlIH0gZnJvbSAncGF0aCc7XHJcbmltcG9ydCBhZG1pblJvdXRlciBmcm9tICcuL3JvdXRlcy9hZG1pbic7XHJcbmltcG9ydCBzaG9wUm91dGVyIGZyb20gJy4vcm91dGVzL3Nob3AnO1xyXG5pbXBvcnQgVXNlciBmcm9tICcuL21vZGVscy91c2VyJztcclxuaW1wb3J0IHsgT2JqZWN0SWQgfSBmcm9tICdtb25nb2RiJztcclxuXHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBuYW1lc3BhY2UgRXhwcmVzcyB7XHJcbiAgICAgICAgaW50ZXJmYWNlIFJlcXVlc3Qge1xyXG4gICAgICAgICAgICB1c2VyOiBVc2VyXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcblxyXG5hcHAuc2V0KCd2aWV3IGVuZ2luZScsICdlanMnKTtcclxuYXBwLnNldCgndmlld3MnLCByZXNvbHZlKCd2aWV3cycpKTtcclxuXHJcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHtleHRlbmRlZDogdHJ1ZX0pKTtcclxuYXBwLnVzZShleHByZXNzLnN0YXRpYyhyZXNvbHZlKCdwdWJsaWMnKSkpO1xyXG5cclxuYXBwLnVzZShhc3luYyAocmVxLCByZXMsIG5leHQpPT57XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChuZXcgT2JqZWN0SWQoJzVmNDBmZWFjNzc1MTRlNzZkZDQ5OTUwYicpKVxyXG4gICAgaWYoIXVzZXIpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IG5pZSBpc3RuaWVqZSB1c2VyISEhXCIpO1xyXG4gICAgfVxyXG4gICAgcmVxLnVzZXIgPSB1c2VyITtcclxuICAgIG5leHQoKTtcclxufSk7XHJcbmFwcC51c2UoJy9hZG1pbicsIGFkbWluUm91dGVyKTtcclxuYXBwLnVzZShzaG9wUm91dGVyKTtcclxuXHJcbi8vIGFwcC51c2UoZXJyb3JzQ29udHJvbGxlci51c2U0MDQpO1xyXG5cclxuXHJcbmNvbnN0IHN0YXJ0ID0gYXN5bmMoKT0+e1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBtb25nb0NvbmVjdCgpO1xyXG4gICAgICAgIGFwcC5saXN0ZW4oMzAwMCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1JcIiwgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKTsgICAgICAgIFxyXG4gICAgfVxyXG59OyAgICBcclxuc3RhcnQoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/app.ts\n");

/***/ }),

/***/ "./src/controllers/admin.ts":
/*!**********************************!*\
  !*** ./src/controllers/admin.ts ***!
  \**********************************/
/*! exports provided: getAddProduct, postAddProduct, getAdminProducts, getEditProduct, postEditProduct, postDeleteProduct */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAddProduct\", function() { return getAddProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postAddProduct\", function() { return postAddProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAdminProducts\", function() { return getAdminProducts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEditProduct\", function() { return getEditProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postEditProduct\", function() { return postEditProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postDeleteProduct\", function() { return postDeleteProduct; });\n/* harmony import */ var _models_product__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/product */ \"./src/models/product.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\nconst getAddProduct = (req, res, next) => {\r\n    res.render('admin/edit-product', {\r\n        docTitle: 'Add Product',\r\n        path: '/admin/edit-product'\r\n    });\r\n};\r\nconst postAddProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const imageUrl = String(req.body.imageUrl).trim();\r\n    const newProduct = new _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"](req.body.title, Number(req.body.price), req.body.description, imageUrl.length > 0 ? imageUrl : undefined, req.user._id);\r\n    yield newProduct.save();\r\n    res.redirect('/');\r\n});\r\nconst getAdminProducts = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchAll();\r\n    res.render('admin/products', {\r\n        products: products,\r\n        docTitle: 'Admin Products',\r\n        path: '/admin/products'\r\n    });\r\n});\r\nconst getEditProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_1__[\"ObjectId\"](req.params.id);\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(id);\r\n    if (!product) {\r\n        console.log(\"ERROR: admin: getEditProduct --- product not found\");\r\n        res.redirect('/');\r\n        return;\r\n    }\r\n    res.render('admin/edit-product', {\r\n        docTitle: 'Edit product',\r\n        path: '/admin/edit-product',\r\n        product: product\r\n    });\r\n});\r\nconst postEditProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_1__[\"ObjectId\"](req.params.id);\r\n    const product = new _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"](req.body.title, Number(req.body.price), req.body.description, req.body.imageUrl, req.user._id, id);\r\n    yield product.save();\r\n    res.redirect('/admin/products');\r\n});\r\nconst postDeleteProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_1__[\"ObjectId\"](req.params.id);\r\n    yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].deleteById(id);\r\n    res.redirect('/admin/products');\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvYWRtaW4udHM/NmU5MiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ3dDO0FBQ0w7QUFJNUIsTUFBTSxhQUFhLEdBQUcsQ0FBQyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUMxRSxHQUFHLENBQUMsTUFBTSxDQUFDLG9CQUFvQixFQUFFO1FBQzdCLFFBQVEsRUFBRSxhQUFhO1FBQ3ZCLElBQUksRUFBRSxxQkFBcUI7S0FBQyxDQUFDLENBQUM7QUFDdEMsQ0FBQyxDQUFDO0FBQ0ssTUFBTSxjQUFjLEdBQUcsQ0FBTyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNqRixNQUFNLFFBQVEsR0FBVSxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN6RCxNQUFNLFVBQVUsR0FBRyxJQUFJLHVEQUFPLENBQzFCLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUNkLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUN0QixHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFDcEIsUUFBUSxDQUFDLE1BQU0sR0FBQyxDQUFDLEVBQUMsU0FBUSxFQUFDLFVBQVMsRUFDcEMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFJLENBQUMsQ0FBQztJQUNuQixNQUFNLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN4QixHQUFHLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3RCLENBQUMsRUFBQztBQUNLLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBTyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNuRixNQUFNLFFBQVEsR0FBSSxNQUFNLHVEQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDM0MsR0FBRyxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTtRQUN6QixRQUFRLEVBQUUsUUFBUTtRQUNsQixRQUFRLEVBQUUsZ0JBQWdCO1FBQzFCLElBQUksRUFBRSxpQkFBaUI7S0FDMUIsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxFQUFDO0FBQ0ssTUFBTSxjQUFjLEdBQUcsQ0FBTyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNqRixNQUFNLEVBQUUsR0FBRyxJQUFJLGdEQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN2QyxNQUFNLE9BQU8sR0FBRyxNQUFNLHVEQUFPLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzNDLElBQUcsQ0FBQyxPQUFPLEVBQUM7UUFDUixPQUFPLENBQUMsR0FBRyxDQUFDLG9EQUFvRCxDQUFDLENBQUM7UUFDbEUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNsQixPQUFPO0tBQ1Y7SUFDRCxHQUFHLENBQUMsTUFBTSxDQUFDLG9CQUFvQixFQUFFO1FBQzdCLFFBQVEsRUFBRSxjQUFjO1FBQ3hCLElBQUksRUFBRSxxQkFBcUI7UUFDM0IsT0FBTyxFQUFFLE9BQU87S0FBQyxDQUFDLENBQUM7QUFDM0IsQ0FBQyxFQUFDO0FBQ0ssTUFBTSxlQUFlLEdBQUcsQ0FBTyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNsRixNQUFNLEVBQUUsR0FBRyxJQUFJLGdEQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN2QyxNQUFNLE9BQU8sR0FBRyxJQUFJLHVEQUFPLENBQ3ZCLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUNkLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUN0QixHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFDcEIsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQ2pCLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBSSxFQUNiLEVBQUUsQ0FBQyxDQUFDO0lBQ1IsTUFBTSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7SUFFckIsR0FBRyxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsRUFBQztBQUNLLE1BQU0saUJBQWlCLEdBQUcsQ0FBTyxHQUFXLEVBQUUsR0FBWSxFQUFFLElBQWlCLEVBQUUsRUFBRTtJQUNwRixNQUFNLEVBQUUsR0FBRyxJQUFJLGdEQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUV2QyxNQUFNLHVEQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzdCLEdBQUcsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUNwQyxDQUFDIiwiZmlsZSI6Ii4vc3JjL2NvbnRyb2xsZXJzL2FkbWluLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXNwb25zZSwgUmVxdWVzdCB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCBQcm9kdWN0IGZyb20gXCIuLi9tb2RlbHMvcHJvZHVjdFwiO1xyXG5pbXBvcnQgeyBPYmplY3RJZCB9IGZyb20gXCJtb25nb2RiXCI7XHJcblxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRBZGRQcm9kdWN0ID0gKHJlcTpSZXF1ZXN0LCByZXM6UmVzcG9uc2UsIG5leHQ6TmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICByZXMucmVuZGVyKCdhZG1pbi9lZGl0LXByb2R1Y3QnLCB7XHJcbiAgICAgICAgZG9jVGl0bGU6ICdBZGQgUHJvZHVjdCcsIFxyXG4gICAgICAgIHBhdGg6ICcvYWRtaW4vZWRpdC1wcm9kdWN0J30pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcG9zdEFkZFByb2R1Y3QgPSBhc3luYyAocmVxOlJlcXVlc3QsIHJlczpSZXNwb25zZSwgbmV4dDpOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGltYWdlVXJsOnN0cmluZyA9IFN0cmluZyhyZXEuYm9keS5pbWFnZVVybCkudHJpbSgpO1xyXG4gICAgY29uc3QgbmV3UHJvZHVjdCA9IG5ldyBQcm9kdWN0KFxyXG4gICAgICAgIHJlcS5ib2R5LnRpdGxlLFxyXG4gICAgICAgIE51bWJlcihyZXEuYm9keS5wcmljZSksIFxyXG4gICAgICAgIHJlcS5ib2R5LmRlc2NyaXB0aW9uLCBcclxuICAgICAgICBpbWFnZVVybC5sZW5ndGg+MD9pbWFnZVVybDp1bmRlZmluZWQsXHJcbiAgICAgICAgcmVxLnVzZXIuX2lkISk7XHJcbiAgICBhd2FpdCBuZXdQcm9kdWN0LnNhdmUoKTtcclxuICAgIHJlcy5yZWRpcmVjdCgnLycpO1xyXG59O1xyXG5leHBvcnQgY29uc3QgZ2V0QWRtaW5Qcm9kdWN0cyA9IGFzeW5jIChyZXE6UmVxdWVzdCwgcmVzOlJlc3BvbnNlLCBuZXh0Ok5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgcHJvZHVjdHMgPSAgYXdhaXQgUHJvZHVjdC5mZXRjaEFsbCgpO1xyXG4gICAgcmVzLnJlbmRlcignYWRtaW4vcHJvZHVjdHMnLCB7XHJcbiAgICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzLCBcclxuICAgICAgICBkb2NUaXRsZTogJ0FkbWluIFByb2R1Y3RzJywgXHJcbiAgICAgICAgcGF0aDogJy9hZG1pbi9wcm9kdWN0cydcclxuICAgIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgZ2V0RWRpdFByb2R1Y3QgPSBhc3luYyAocmVxOlJlcXVlc3QsIHJlczpSZXNwb25zZSwgbmV4dDpOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGlkID0gbmV3IE9iamVjdElkKHJlcS5wYXJhbXMuaWQpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoaWQpO1xyXG4gICAgaWYoIXByb2R1Y3Qpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IGFkbWluOiBnZXRFZGl0UHJvZHVjdCAtLS0gcHJvZHVjdCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmVzLnJlbmRlcignYWRtaW4vZWRpdC1wcm9kdWN0Jywge1xyXG4gICAgICAgIGRvY1RpdGxlOiAnRWRpdCBwcm9kdWN0JywgXHJcbiAgICAgICAgcGF0aDogJy9hZG1pbi9lZGl0LXByb2R1Y3QnLFxyXG4gICAgICAgIHByb2R1Y3Q6IHByb2R1Y3R9KTtcclxufTtcclxuZXhwb3J0IGNvbnN0IHBvc3RFZGl0UHJvZHVjdCA9IGFzeW5jIChyZXE6UmVxdWVzdCwgcmVzOlJlc3BvbnNlLCBuZXh0Ok5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSBuZXcgT2JqZWN0SWQocmVxLnBhcmFtcy5pZCk7XHJcbiAgICBjb25zdCBwcm9kdWN0ID0gbmV3IFByb2R1Y3QoXHJcbiAgICAgICAgcmVxLmJvZHkudGl0bGUsXHJcbiAgICAgICAgTnVtYmVyKHJlcS5ib2R5LnByaWNlKSxcclxuICAgICAgICByZXEuYm9keS5kZXNjcmlwdGlvbixcclxuICAgICAgICByZXEuYm9keS5pbWFnZVVybCxcclxuICAgICAgICByZXEudXNlci5faWQhLFxyXG4gICAgICAgIGlkKTtcclxuICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xyXG5cclxuICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3Byb2R1Y3RzJyk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBwb3N0RGVsZXRlUHJvZHVjdCA9IGFzeW5jIChyZXE6UmVxdWVzdCwgcmVzOlJlc3BvbnNlLCBuZXh0Ok5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSBuZXcgT2JqZWN0SWQocmVxLnBhcmFtcy5pZCk7XHJcblxyXG4gICAgYXdhaXQgUHJvZHVjdC5kZWxldGVCeUlkKGlkKTtcclxuICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3Byb2R1Y3RzJyk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/controllers/admin.ts\n");

/***/ }),

/***/ "./src/controllers/shop.ts":
/*!*********************************!*\
  !*** ./src/controllers/shop.ts ***!
  \*********************************/
/*! exports provided: getIndex, getProducts, getProduct, getCart, postCart, postCartDeleteItem, postCartDeleteItems, postCreateOrder, getOrders */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getIndex\", function() { return getIndex; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getProducts\", function() { return getProducts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getProduct\", function() { return getProduct; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCart\", function() { return getCart; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCart\", function() { return postCart; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCartDeleteItem\", function() { return postCartDeleteItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCartDeleteItems\", function() { return postCartDeleteItems; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"postCreateOrder\", function() { return postCreateOrder; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getOrders\", function() { return getOrders; });\n/* harmony import */ var _models_product__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/product */ \"./src/models/product.ts\");\n/* harmony import */ var _models_cart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/cart */ \"./src/models/cart.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_2__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n//// USERS\r\nconst getIndex = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchAll();\r\n    res.render('shop/index', {\r\n        products: products,\r\n        docTitle: 'My Shop',\r\n        path: '/shop/index'\r\n    });\r\n});\r\nconst getProducts = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const products = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].fetchAll();\r\n    res.render('shop/product-list', {\r\n        products: products,\r\n        docTitle: 'Products',\r\n        path: '/shop/product-list'\r\n    });\r\n});\r\nconst getProduct = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_2__[\"ObjectId\"](req.params.id);\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(id);\r\n    if (!product) {\r\n        console.log(\"ERROR: shop: getProduct --- product not found\");\r\n        res.redirect('/');\r\n        return;\r\n    }\r\n    res.render('shop/product-detail', {\r\n        product: yield product,\r\n        docTitle: product.title,\r\n        path: '/shop/products'\r\n    });\r\n});\r\nconst getCart = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const cart = req.user.cart;\r\n    const cartProducts = yield cart.fetchProducts();\r\n    const price = _models_cart__WEBPACK_IMPORTED_MODULE_1__[\"default\"].countPrice(cartProducts);\r\n    res.render('shop/cart', {\r\n        docTitle: 'My Cart',\r\n        path: '/shop/cart',\r\n        products: cartProducts,\r\n        price: price\r\n    });\r\n});\r\nconst postCart = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_2__[\"ObjectId\"](req.body.productId);\r\n    const product = yield _models_product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findById(id);\r\n    if (!product) {\r\n        console.log(\"ERROR: shop: postCart --- product not found\");\r\n        res.redirect('/');\r\n        return;\r\n    }\r\n    yield req.user.addToCart(product._id);\r\n    res.redirect(\"/cart\");\r\n});\r\n// export const getCheckout = async (req: Request, res: Response, next: NextFunction) => {\r\n//     res.render('shop/checkout', {\r\n//         // products: await Product.fetchAll(), \r\n//         docTitle: 'My Cart',\r\n//         path: '/shop/checkout'\r\n//     });\r\n// };\r\nconst postCartDeleteItem = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_2__[\"ObjectId\"](req.body.id);\r\n    yield req.user.removeFromCartOne(id);\r\n    res.redirect(\"/cart\");\r\n});\r\nconst postCartDeleteItems = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = new mongodb__WEBPACK_IMPORTED_MODULE_2__[\"ObjectId\"](req.body.id);\r\n    yield req.user.removeFromCartAll(id);\r\n    res.redirect(\"/cart\");\r\n});\r\nconst postCreateOrder = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const id = req.body.id;\r\n    yield req.user.addOrder();\r\n    res.redirect('/orders');\r\n});\r\nconst getOrders = (req, res, next) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const orders = yield req.user.getOrders();\r\n    res.render('shop/orders', {\r\n        orders: orders,\r\n        docTitle: 'My orders',\r\n        path: '/shop/orders'\r\n    });\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbGxlcnMvc2hvcC50cz85OWNjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ3dDO0FBQ047QUFHQztBQUduQyxVQUFVO0FBRUgsTUFBTSxRQUFRLEdBQUcsQ0FBTyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQWtCLEVBQUUsRUFBRTtJQUM5RSxNQUFNLFFBQVEsR0FBRyxNQUFNLHVEQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDMUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUU7UUFDckIsUUFBUSxFQUFFLFFBQVE7UUFDbEIsUUFBUSxFQUFFLFNBQVM7UUFDbkIsSUFBSSxFQUFFLGFBQWE7S0FDdEIsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxFQUFDO0FBRUssTUFBTSxXQUFXLEdBQUcsQ0FBTyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQWtCLEVBQUUsRUFBRTtJQUNqRixNQUFNLFFBQVEsR0FBRyxNQUFNLHVEQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDMUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRTtRQUM1QixRQUFRLEVBQUUsUUFBUTtRQUNsQixRQUFRLEVBQUUsVUFBVTtRQUNwQixJQUFJLEVBQUUsb0JBQW9CO0tBQzdCLENBQUMsQ0FBQztBQUNQLENBQUMsRUFBQztBQUVLLE1BQU0sVUFBVSxHQUFHLENBQU8sR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7SUFDaEYsTUFBTSxFQUFFLEdBQUcsSUFBSSxnREFBUSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdkMsTUFBTSxPQUFPLEdBQUcsTUFBTSx1REFBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMzQyxJQUFJLENBQUMsT0FBTyxFQUFFO1FBQ1YsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO1FBQzdE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TSxNQUFNLFNBQVMsR0FBRyxDQUFPLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO0lBQy9FLE1BQU0sTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMxQyxHQUFHLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRTtRQUN0QixNQUFNLEVBQUUsTUFBTTtRQUNkLFFBQVEsRUFBRSxXQUFXO1FBQ3JCLElBQUksRUFBRSxjQUFjO0tBQ3ZCLENBQUMsQ0FBQztBQUNQLENBQUMsRUFBQyIsImZpbGUiOiIuL3NyYy9jb250cm9sbGVycy9zaG9wLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyLCBOZXh0RnVuY3Rpb24sIFJlc3BvbnNlLCBSZXF1ZXN0IH0gZnJvbSBcImV4cHJlc3NcIjtcclxuaW1wb3J0IFByb2R1Y3QgZnJvbSBcIi4uL21vZGVscy9wcm9kdWN0XCI7XHJcbmltcG9ydCBDYXJ0IGZyb20gXCIuLi9tb2RlbHMvY2FydFwiO1xyXG5pbXBvcnQgeyBDb25zb2xlIH0gZnJvbSBcImNvbnNvbGVcIjtcclxuaW1wb3J0IHsgTW9kZWwgfSBmcm9tIFwic2VxdWVsaXplXCI7XHJcbmltcG9ydCB7IE9iamVjdElkIH0gZnJvbSBcIm1vbmdvZGJcIjtcclxuaW1wb3J0IHsgdXNlckluZm8gfSBmcm9tIFwib3NcIjtcclxuXHJcbi8vLy8gVVNFUlNcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRJbmRleCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0LmZldGNoQWxsKCk7XHJcbiAgICByZXMucmVuZGVyKCdzaG9wL2luZGV4Jywge1xyXG4gICAgICAgIHByb2R1Y3RzOiBwcm9kdWN0cyxcclxuICAgICAgICBkb2NUaXRsZTogJ015IFNob3AnLFxyXG4gICAgICAgIHBhdGg6ICcvc2hvcC9pbmRleCdcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFByb2R1Y3RzID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3QuZmV0Y2hBbGwoKTtcclxuICAgIHJlcy5yZW5kZXIoJ3Nob3AvcHJvZHVjdC1saXN0Jywge1xyXG4gICAgICAgIHByb2R1Y3RzOiBwcm9kdWN0cyxcclxuICAgICAgICBkb2NUaXRsZTogJ1Byb2R1Y3RzJyxcclxuICAgICAgICBwYXRoOiAnL3Nob3AvcHJvZHVjdC1saXN0J1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0UHJvZHVjdCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSBuZXcgT2JqZWN0SWQocmVxLnBhcmFtcy5pZCk7XHJcbiAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChpZCk7XHJcbiAgICBpZiAoIXByb2R1Y3QpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVSUk9SOiBzaG9wOiBnZXRQcm9kdWN0IC0tLSBwcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy8nKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZXMucmVuZGVyKCdzaG9wL3Byb2R1Y3QtZGV0YWlsJywge1xyXG4gICAgICAgIHByb2R1Y3Q6IGF3YWl0IHByb2R1Y3QsXHJcbiAgICAgICAgZG9jVGl0bGU6IHByb2R1Y3QudGl0bGUsXHJcbiAgICAgICAgcGF0aDogJy9zaG9wL3Byb2R1Y3RzJ1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0Q2FydCA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgY2FydCA9IHJlcS51c2VyLmNhcnQ7XHJcbiAgICBjb25zdCBjYXJ0UHJvZHVjdHMgPSBhd2FpdCBjYXJ0LmZldGNoUHJvZHVjdHMoKTtcclxuICAgIGNvbnN0IHByaWNlID0gQ2FydC5jb3VudFByaWNlKGNhcnRQcm9kdWN0cyk7XHJcbiAgICByZXMucmVuZGVyKCdzaG9wL2NhcnQnLCB7XHJcbiAgICAgICAgZG9jVGl0bGU6ICdNeSBDYXJ0JyxcclxuICAgICAgICBwYXRoOiAnL3Nob3AvY2FydCcsXHJcbiAgICAgICAgcHJvZHVjdHM6IGNhcnRQcm9kdWN0cyxcclxuICAgICAgICBwcmljZTogcHJpY2VcclxuICAgIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgcG9zdENhcnQgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGlkID0gIG5ldyBPYmplY3RJZChyZXEuYm9keS5wcm9kdWN0SWQpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoaWQpO1xyXG4gICAgaWYoIXByb2R1Y3Qpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IHNob3A6IHBvc3RDYXJ0IC0tLSBwcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy8nKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBhd2FpdCByZXEudXNlci5hZGRUb0NhcnQocHJvZHVjdC5faWQhKTtcclxuICAgIHJlcy5yZWRpcmVjdChcIi9jYXJ0XCIpO1xyXG59O1xyXG4vLyBleHBvcnQgY29uc3QgZ2V0Q2hlY2tvdXQgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuLy8gICAgIHJlcy5yZW5kZXIoJ3Nob3AvY2hlY2tvdXQnLCB7XHJcbi8vICAgICAgICAgLy8gcHJvZHVjdHM6IGF3YWl0IFByb2R1Y3QuZmV0Y2hBbGwoKSwgXHJcbi8vICAgICAgICAgZG9jVGl0bGU6ICdNeSBDYXJ0JyxcclxuLy8gICAgICAgICBwYXRoOiAnL3Nob3AvY2hlY2tvdXQnXHJcbi8vICAgICB9KTtcclxuLy8gfTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgY29uc3QgcG9zdENhcnREZWxldGVJdGVtID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBpZCA9IG5ldyBPYmplY3RJZChyZXEuYm9keS5pZCk7XHJcbiAgICBhd2FpdCByZXEudXNlci5yZW1vdmVGcm9tQ2FydE9uZShpZCk7XHJcbiAgICByZXMucmVkaXJlY3QoXCIvY2FydFwiKTtcclxufVxyXG5leHBvcnQgY29uc3QgcG9zdENhcnREZWxldGVJdGVtcyA9IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xyXG4gICAgY29uc3QgaWQgPSBuZXcgT2JqZWN0SWQocmVxLmJvZHkuaWQpO1xyXG4gICAgYXdhaXQgcmVxLnVzZXIucmVtb3ZlRnJvbUNhcnRBbGwoaWQpO1xyXG4gICAgcmVzLnJlZGlyZWN0KFwiL2NhcnRcIik7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwb3N0Q3JlYXRlT3JkZXIgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IGlkID0gcmVxLmJvZHkuaWQ7XHJcbiAgICBhd2FpdCByZXEudXNlci5hZGRPcmRlcigpO1xyXG4gICAgcmVzLnJlZGlyZWN0KCcvb3JkZXJzJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRPcmRlcnMgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcclxuICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IHJlcS51c2VyLmdldE9yZGVycygpO1xyXG4gICAgcmVzLnJlbmRlcignc2hvcC9vcmRlcnMnLCB7XHJcbiAgICAgICAgb3JkZXJzOiBvcmRlcnMsIFxyXG4gICAgICAgIGRvY1RpdGxlOiAnTXkgb3JkZXJzJyxcclxuICAgICAgICBwYXRoOiAnL3Nob3Avb3JkZXJzJ1xyXG4gICAgfSk7XHJcbn07Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/controllers/shop.ts\n");

/***/ }),

/***/ "./src/models/cart.ts":
/*!****************************!*\
  !*** ./src/models/cart.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _product__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./product */ \"./src/models/product.ts\");\n/* harmony import */ var _util_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/database */ \"./src/util/database.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\nclass Cart {\r\n    /**\r\n     *\r\n     */\r\n    constructor() {\r\n        this.products = [];\r\n    }\r\n    static countPrice(cartProducts) {\r\n        const price = cartProducts.reduce((price, { product, cnt }) => {\r\n            return price + product.price * cnt;\r\n        }, 0);\r\n        return price;\r\n    }\r\n    fetchProducts() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            const ids = this.products.map(a => a.productId);\r\n            const products = yield db.collection('products').find({\r\n                _id: { $in: ids }\r\n            })\r\n                .map(p => _product__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dataToProduct(p))\r\n                .toArray();\r\n            const idToProduct = new Map(products.map(p => { var _a; return [(_a = p._id) === null || _a === void 0 ? void 0 : _a.toHexString(), p]; }));\r\n            return this.products.map(p => ({\r\n                product: idToProduct.get(p.productId.toHexString()),\r\n                cnt: p.cnt\r\n            }));\r\n        });\r\n    }\r\n    static dataToCart(data) {\r\n        return Object.assign(new Cart(), Object.assign({}, data));\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Cart);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL2NhcnQudHM/YWQ3NyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBZ0M7QUFFUztBQUd6QyxNQUFNLElBQUk7SUFFTjs7T0FFRztJQUNIO1FBQ0ksSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUNELE1BQU0sQ0FBQyxVQUFVLENBQUMsWUFBNkM7UUFDM0QsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQVksRUFBRSxFQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUMsRUFBQyxFQUFFO1lBQzlELE9BQU8sS0FBSyxHQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUMsR0FBRyxDQUFDO1FBQ25DLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNOLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFDSyxhQUFhOztZQUNmLE1BQU0sRUFBRSxHQUFHLDREQUFLLEVBQUUsQ0FBQztZQUNuQixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUUsRUFBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRTlDLE1BQU0sUUFBUSxHQUFHLE1BQU0sRUFBRSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQ2xELEdBQUcsRUFBRSxFQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUM7YUFDbEIsQ0FBQztpQkFDRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxnREFBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDbEMsT0FBTyxFQUFFLENBQUM7WUFDZixNQUFNLFdBQVcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRSx5QkFBQyxDQUFDLENBQUMsR0FBRywwQ0FBRSxXQUFXLElBQUksQ0FBQyxDQUFDLElBQUMsQ0FBQyxDQUFDO1lBQ3hFLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFFLEVBQUM7Z0JBQ3pCLE9BQU8sRUFBRSxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUU7Z0JBQ3BELEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRzthQUFDLENBQUMsQ0FBcUMsQ0FBQztRQUMxRCxDQUFDO0tBQUE7SUFDRCxNQUFNLENBQUMsVUFBVSxDQUFDLElBQVE7UUFDdEIsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxFQUFFLG9CQUFNLElBQUksRUFBRSxDQUFDO0lBQ2hELENBQUM7Q0FDSjtBQUdjLG1FQUFJLEVBQUMiLCJmaWxlIjoiLi9zcmMvbW9kZWxzL2NhcnQudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvZHVjdCBmcm9tICcuL3Byb2R1Y3QnO1xyXG5pbXBvcnQgeyBPYmplY3RJZCB9IGZyb20gJ21vbmdvZGInO1xyXG5pbXBvcnQgeyBnZXREYiB9IGZyb20gJy4uL3V0aWwvZGF0YWJhc2UnO1xyXG5cclxuXHJcbmNsYXNzIENhcnR7XHJcbiAgICBwcm9kdWN0czoge3Byb2R1Y3RJZDogT2JqZWN0SWQsIGNudDpudW1iZXJ9W107XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMucHJvZHVjdHMgPSBbXTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjb3VudFByaWNlKGNhcnRQcm9kdWN0czp7cHJvZHVjdDogUHJvZHVjdCwgY250Om51bWJlcn1bXSl7XHJcbiAgICAgICAgY29uc3QgcHJpY2UgPSBjYXJ0UHJvZHVjdHMucmVkdWNlKChwcmljZTpudW1iZXIsIHtwcm9kdWN0LCBjbnR9KT0+e1xyXG4gICAgICAgICAgICByZXR1cm4gcHJpY2UrcHJvZHVjdC5wcmljZSpjbnQ7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgcmV0dXJuIHByaWNlO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZmV0Y2hQcm9kdWN0cygpe1xyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBjb25zdCBpZHMgPSB0aGlzLnByb2R1Y3RzLm1hcChhPT5hLnByb2R1Y3RJZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIuY29sbGVjdGlvbigncHJvZHVjdHMnKS5maW5kKHtcclxuICAgICAgICAgICAgX2lkOiB7JGluOiBpZHN9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcChwID0+IFByb2R1Y3QuZGF0YVRvUHJvZHVjdChwKSlcclxuICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgICAgICBjb25zdCBpZFRvUHJvZHVjdCA9IG5ldyBNYXAocHJvZHVjdHMubWFwKHA9PltwLl9pZD8udG9IZXhTdHJpbmcoKSwgcF0pKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9kdWN0cy5tYXAocD0+KHtcclxuICAgICAgICAgICAgcHJvZHVjdDogaWRUb1Byb2R1Y3QuZ2V0KHAucHJvZHVjdElkLnRvSGV4U3RyaW5nKCkpISwgXHJcbiAgICAgICAgICAgIGNudDogcC5jbnR9KSkgYXMge3Byb2R1Y3Q6IFByb2R1Y3QsIGNudDpudW1iZXJ9W107XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZGF0YVRvQ2FydChkYXRhOmFueSl7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24obmV3IENhcnQoKSwgey4uLmRhdGF9KTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcnQ7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/models/cart.ts\n");

/***/ }),

/***/ "./src/models/product.ts":
/*!*******************************!*\
  !*** ./src/models/product.ts ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _util_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/database */ \"./src/util/database.ts\");\n/* harmony import */ var _user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./user */ \"./src/models/user.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\nclass Product {\r\n    /**\r\n     *\r\n     */\r\n    constructor(title, price, description, imageUrl, userId, id) {\r\n        this.title = title;\r\n        this.price = price;\r\n        this.description = description;\r\n        this.imageUrl = imageUrl;\r\n        this.userId = userId;\r\n        this._id = id ? id : undefined;\r\n    }\r\n    static dataToProduct(data) {\r\n        return new Product(data.title, data.price, data.description, data.imageUrl, data.userId, data._id);\r\n    }\r\n    static fetchAll() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield Object(_util_database__WEBPACK_IMPORTED_MODULE_0__[\"getDb\"])().collection('products')\r\n                .find()\r\n                .map(p => this.dataToProduct(p))\r\n                .toArray();\r\n        });\r\n    }\r\n    static findById(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.dataToProduct(yield Object(_util_database__WEBPACK_IMPORTED_MODULE_0__[\"getDb\"])().collection('products')\r\n                .findOne({ _id: id }));\r\n        });\r\n    }\r\n    static deleteById(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield _user__WEBPACK_IMPORTED_MODULE_1__[\"default\"].removeProductFromCarts(id);\r\n            return yield Object(_util_database__WEBPACK_IMPORTED_MODULE_0__[\"getDb\"])().collection('products')\r\n                .deleteOne({ _id: id });\r\n        });\r\n    }\r\n    save() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_0__[\"getDb\"])();\r\n            if (!this.imageUrl)\r\n                this.imageUrl = 'https://cdn.pixabay.com/photo/2016/03/31/20/51/book-1296045_960_720.png';\r\n            if (this._id) {\r\n                const results = yield db.collection('products')\r\n                    .updateOne({ _id: this._id }, { $set: this });\r\n            }\r\n            else {\r\n                const results = yield db.collection('products').insertOne(this);\r\n                this._id = results.insertedId;\r\n            }\r\n        });\r\n    }\r\n}\r\n// export interface ProductAttributes {\r\n//     id: number,\r\n//     title: string,\r\n//     price: number,\r\n//     description: string,\r\n//     imageUrl?: string,\r\n//     ownerId: number\r\n// }\r\n// interface ProductCreationAttributes extends Optional<ProductAttributes, \"id\"> {}\r\n// class Product extends Model<ProductAttributes, ProductCreationAttributes>\r\n//     implements ProductAttributes {\r\n//     public id!: number;\r\n//     public title!: string;\r\n//     public price!: number;\r\n//     public description!: string;\r\n//     public imageUrl!: string;\r\n//     public ownerId!: number;\r\n//     public getOwner!: HasOneGetAssociationMixin<User>;\r\n//     // timestamps!\r\n//     public readonly createdAt!: Date;\r\n//     public readonly updatedAt!: Date;\r\n//     public readonly owner?: User;\r\n//     public readonly cartItem?: CartItem;\r\n//     public readonly orderItem?: OrderItem;\r\n//     public static associations: {\r\n//         owner: Association<User, User>;\r\n//     }; \r\n// }\r\n// Product.init({\r\n//     id: {\r\n//         type: DataTypes.INTEGER,\r\n//         autoIncrement: true,\r\n//         allowNull: false,\r\n//         primaryKey: true\r\n//     },\r\n//     title: {\r\n//         type: DataTypes.STRING,\r\n//         allowNull: false\r\n//     },\r\n//     price: {\r\n//         type: DataTypes.DOUBLE,\r\n//         allowNull: false,\r\n//     },\r\n//     imageUrl: {\r\n//         type: DataTypes.TEXT,\r\n//         defaultValue: 'https://cdn.pixabay.com/photo/2016/03/31/20/51/book-1296045_960_720.png',\r\n//         allowNull: false,\r\n//     },\r\n//     description: {\r\n//         type: DataTypes.TEXT,\r\n//         allowNull: false\r\n//     },\r\n//     ownerId: {\r\n//         type: DataTypes.INTEGER,\r\n//         allowNull: false\r\n//     }\r\n// },{\r\n//     tableName: 'products',\r\n//     modelName: 'product',\r\n//     sequelize: TutorialSequelize \r\n// });\r\n// Product.belongsTo(User, {\r\n//     targetKey: 'id',\r\n//     foreignKey: 'ownerId',\r\n//     constraints: true,\r\n//     onDelete: 'CASCADE',\r\n//     as: 'owner'\r\n// });\r\n// Product.belongsToMany(Cart,{\r\n//     sourceKey: 'id',\r\n//     targetKey: 'id',\r\n//     foreignKey: 'productId',\r\n//     otherKey: 'cartId',\r\n//     uniqueKey: 'id',  \r\n//     through: 'cartItem',\r\n// });\r\n// Product.belongsToMany(Order,{\r\n//     sourceKey: 'id',\r\n//     targetKey: 'id',\r\n//     foreignKey: 'productId',\r\n//     otherKey: 'orderId',\r\n//     uniqueKey: 'id',  \r\n//     through: 'orderItem',\r\n// });\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Product);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL3Byb2R1Y3QudHM/YmFhMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFFeUM7QUFFZjtBQUsxQixNQUFNLE9BQU87SUFPVDs7T0FFRztJQUNILFlBQVksS0FBWSxFQUFDLEtBQVksRUFBQyxXQUFrQixFQUFDLFFBQXlCLEVBQUUsTUFBZSxFQUFFLEVBQVk7UUFDN0csSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQ25DLENBQUM7SUFDRCxNQUFNLENBQUMsYUFBYSxDQUFDLElBQVE7UUFDekIsT0FBTyxJQUFJLE9BQU8sQ0FDZCxJQUFJLENBQUMsS0FBSyxFQUNWLElBQUksQ0FBQyxLQUFLLEVBQ1YsSUFBSSxDQUFDLFdBQVcsRUFDaEIsSUFBSSxDQUFDLFFBQVEsRUFDYixJQUFJLENBQUMsTUFBTSxFQUNYLElBQUksQ0FBQyxHQUFHLENBQ1gsQ0FBQztJQUNOLENBQUM7SUFDRCxNQUFNLENBQU8sUUFBUTs7WUFDakIsT0FBTyxNQUFNLDREQUFLLEVBQUUsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDO2lCQUN0QyxJQUFJLEVBQUU7aUJBQ04sR0FBRyxDQUFDLENBQUMsR0FBRSxLQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUM3QixPQUFPLEVBQUUsQ0FBQztRQUNuQixDQUFDO0tBQUE7SUFDRCxNQUFNLENBQU8sUUFBUSxDQUFDLEVBQVc7O1lBQzdCLE9BQU8sSUFB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QjtBQUMzQix5QkFBeUI7QUFDekIsNEJBQTRCO0FBQzVCLE1BQU07QUFDUyxzRUFBTyxFQUFDIiwiZmlsZSI6Ii4vc3JjL21vZGVscy9wcm9kdWN0LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCBDYXJ0IGZyb20gJy4vY2FydCc7XHJcbmltcG9ydCB7IGdldERiIH0gZnJvbSAnLi4vdXRpbC9kYXRhYmFzZSc7XHJcbmltcG9ydCB7IE1vZGVsLCBEYXRhVHlwZXMsIE9wdGlvbmFsLCBIYXNPbmVHZXRBc3NvY2lhdGlvbk1peGluLCBBc3NvY2lhdGlvbiB9IGZyb20gJ3NlcXVlbGl6ZSc7XHJcbmltcG9ydCBVc2VyIGZyb20gJy4vdXNlcic7XHJcbmltcG9ydCBtb25nb0NvbmVjdCBmcm9tICcuLi91dGlsL2RhdGFiYXNlJztcclxuaW1wb3J0IHsgRGIsIE9iamVjdElkIH0gZnJvbSAnbW9uZ29kYic7XHJcblxyXG5cclxuY2xhc3MgUHJvZHVjdHtcclxuICAgIF9pZD86T2JqZWN0SWQ7XHJcbiAgICB1c2VySWQ6T2JqZWN0SWQ7XHJcbiAgICB0aXRsZTpzdHJpbmc7XHJcbiAgICBwcmljZTpudW1iZXI7XHJcbiAgICBkZXNjcmlwdGlvbjpzdHJpbmc7XHJcbiAgICBpbWFnZVVybDpzdHJpbmd8dW5kZWZpbmVkO1xyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZTpzdHJpbmcscHJpY2U6bnVtYmVyLGRlc2NyaXB0aW9uOnN0cmluZyxpbWFnZVVybDpzdHJpbmd8dW5kZWZpbmVkLCB1c2VySWQ6T2JqZWN0SWQsIGlkPzpPYmplY3RJZCkge1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLnByaWNlID0gcHJpY2U7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VVcmwgPSBpbWFnZVVybDtcclxuICAgICAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLl9pZCA9IGlkID8gaWQgOiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZGF0YVRvUHJvZHVjdChkYXRhOmFueSl7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9kdWN0KFxyXG4gICAgICAgICAgICBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICBkYXRhLnByaWNlLFxyXG4gICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICBkYXRhLmltYWdlVXJsLFxyXG4gICAgICAgICAgICBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgZGF0YS5faWQsXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBhc3luYyBmZXRjaEFsbCgpe1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3Byb2R1Y3RzJylcclxuICAgICAgICAgICAgLmZpbmQoKVxyXG4gICAgICAgICAgICAubWFwKHA9PnRoaXMuZGF0YVRvUHJvZHVjdChwKSlcclxuICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBhc3luYyBmaW5kQnlJZChpZDpPYmplY3RJZCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVRvUHJvZHVjdCggXHJcbiAgICAgICAgICAgIGF3YWl0IGdldERiKCkuY29sbGVjdGlvbigncHJvZHVjdHMnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmUoe19pZDogaWR9KSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgZGVsZXRlQnlJZChpZDpPYmplY3RJZCl7XHJcbiAgICAgICAgYXdhaXQgVXNlci5yZW1vdmVQcm9kdWN0RnJvbUNhcnRzKGlkKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgZ2V0RGIoKS5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXHJcbiAgICAgICAgICAuZGVsZXRlT25lKHtfaWQ6aWR9KTtcclxuICAgIH0gIFxyXG4gICAgYXN5bmMgc2F2ZSgpe1xyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBpZighdGhpcy5pbWFnZVVybCkgXHJcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VVcmwgPSAnaHR0cHM6Ly9jZG4ucGl4YWJheS5jb20vcGhvdG8vMjAxNi8wMy8zMS8yMC81MS9ib29rLTEyOTYwNDVfOTYwXzcyMC5wbmcnO1xyXG4gICAgICAgIGlmKHRoaXMuX2lkKXtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3Byb2R1Y3RzJylcclxuICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoe19pZDogdGhpcy5faWR9LCB7JHNldDogdGhpc30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuY29sbGVjdGlvbigncHJvZHVjdHMnKS5pbnNlcnRPbmUodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2lkID0gcmVzdWx0cy5pbnNlcnRlZElkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vLyBleHBvcnQgaW50ZXJmYWNlIFByb2R1Y3RBdHRyaWJ1dGVzIHtcclxuLy8gICAgIGlkOiBudW1iZXIsXHJcbi8vICAgICB0aXRsZTogc3RyaW5nLFxyXG4vLyAgICAgcHJpY2U6IG51bWJlcixcclxuLy8gICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbi8vICAgICBpbWFnZVVybD86IHN0cmluZyxcclxuLy8gICAgIG93bmVySWQ6IG51bWJlclxyXG4vLyB9XHJcbi8vIGludGVyZmFjZSBQcm9kdWN0Q3JlYXRpb25BdHRyaWJ1dGVzIGV4dGVuZHMgT3B0aW9uYWw8UHJvZHVjdEF0dHJpYnV0ZXMsIFwiaWRcIj4ge31cclxuXHJcblxyXG4vLyBjbGFzcyBQcm9kdWN0IGV4dGVuZHMgTW9kZWw8UHJvZHVjdEF0dHJpYnV0ZXMsIFByb2R1Y3RDcmVhdGlvbkF0dHJpYnV0ZXM+XHJcbi8vICAgICBpbXBsZW1lbnRzIFByb2R1Y3RBdHRyaWJ1dGVzIHtcclxuLy8gICAgIHB1YmxpYyBpZCE6IG51bWJlcjtcclxuLy8gICAgIHB1YmxpYyB0aXRsZSE6IHN0cmluZztcclxuLy8gICAgIHB1YmxpYyBwcmljZSE6IG51bWJlcjtcclxuLy8gICAgIHB1YmxpYyBkZXNjcmlwdGlvbiE6IHN0cmluZztcclxuLy8gICAgIHB1YmxpYyBpbWFnZVVybCE6IHN0cmluZztcclxuLy8gICAgIHB1YmxpYyBvd25lcklkITogbnVtYmVyO1xyXG5cclxuLy8gICAgIHB1YmxpYyBnZXRPd25lciE6IEhhc09uZUdldEFzc29jaWF0aW9uTWl4aW48VXNlcj47XHJcbi8vICAgICAvLyB0aW1lc3RhbXBzIVxyXG4vLyAgICAgcHVibGljIHJlYWRvbmx5IGNyZWF0ZWRBdCE6IERhdGU7XHJcbi8vICAgICBwdWJsaWMgcmVhZG9ubHkgdXBkYXRlZEF0ITogRGF0ZTtcclxuXHJcbi8vICAgICBwdWJsaWMgcmVhZG9ubHkgb3duZXI/OiBVc2VyO1xyXG4vLyAgICAgcHVibGljIHJlYWRvbmx5IGNhcnRJdGVtPzogQ2FydEl0ZW07XHJcbi8vICAgICBwdWJsaWMgcmVhZG9ubHkgb3JkZXJJdGVtPzogT3JkZXJJdGVtO1xyXG4vLyAgICAgcHVibGljIHN0YXRpYyBhc3NvY2lhdGlvbnM6IHtcclxuLy8gICAgICAgICBvd25lcjogQXNzb2NpYXRpb248VXNlciwgVXNlcj47XHJcbi8vICAgICB9OyBcclxuLy8gfVxyXG4vLyBQcm9kdWN0LmluaXQoe1xyXG4vLyAgICAgaWQ6IHtcclxuLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuSU5URUdFUixcclxuLy8gICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlLFxyXG4vLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2UsXHJcbi8vICAgICAgICAgcHJpbWFyeUtleTogdHJ1ZVxyXG4vLyAgICAgfSxcclxuLy8gICAgIHRpdGxlOiB7XHJcbi8vICAgICAgICAgdHlwZTogRGF0YVR5cGVzLlNUUklORyxcclxuLy8gICAgICAgICBhbGxvd051bGw6IGZhbHNlXHJcbi8vICAgICB9LFxyXG4vLyAgICAgcHJpY2U6IHtcclxuLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuRE9VQkxFLFxyXG4vLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2UsXHJcbi8vICAgICB9LFxyXG4vLyAgICAgaW1hZ2VVcmw6IHtcclxuLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuVEVYVCxcclxuLy8gICAgICAgICBkZWZhdWx0VmFsdWU6ICdodHRwczovL2Nkbi5waXhhYmF5LmNvbS9waG90by8yMDE2LzAzLzMxLzIwLzUxL2Jvb2stMTI5NjA0NV85NjBfNzIwLnBuZycsXHJcbi8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZSxcclxuLy8gICAgIH0sXHJcbi8vICAgICBkZXNjcmlwdGlvbjoge1xyXG4vLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5URVhULFxyXG4vLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2VcclxuLy8gICAgIH0sXHJcbi8vICAgICBvd25lcklkOiB7XHJcbi8vICAgICAgICAgdHlwZTogRGF0YVR5cGVzLklOVEVHRVIsXHJcbi8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZVxyXG4vLyAgICAgfVxyXG4vLyB9LHtcclxuLy8gICAgIHRhYmxlTmFtZTogJ3Byb2R1Y3RzJyxcclxuLy8gICAgIG1vZGVsTmFtZTogJ3Byb2R1Y3QnLFxyXG4vLyAgICAgc2VxdWVsaXplOiBUdXRvcmlhbFNlcXVlbGl6ZSBcclxuLy8gfSk7XHJcblxyXG4vLyBQcm9kdWN0LmJlbG9uZ3NUbyhVc2VyLCB7XHJcbi8vICAgICB0YXJnZXRLZXk6ICdpZCcsXHJcbi8vICAgICBmb3JlaWduS2V5OiAnb3duZXJJZCcsXHJcbi8vICAgICBjb25zdHJhaW50czogdHJ1ZSxcclxuLy8gICAgIG9uRGVsZXRlOiAnQ0FTQ0FERScsXHJcbi8vICAgICBhczogJ293bmVyJ1xyXG4vLyB9KTtcclxuLy8gUHJvZHVjdC5iZWxvbmdzVG9NYW55KENhcnQse1xyXG4vLyAgICAgc291cmNlS2V5OiAnaWQnLFxyXG4vLyAgICAgdGFyZ2V0S2V5OiAnaWQnLFxyXG4vLyAgICAgZm9yZWlnbktleTogJ3Byb2R1Y3RJZCcsXHJcbi8vICAgICBvdGhlcktleTogJ2NhcnRJZCcsXHJcbi8vICAgICB1bmlxdWVLZXk6ICdpZCcsICBcclxuLy8gICAgIHRocm91Z2g6ICdjYXJ0SXRlbScsXHJcbi8vIH0pO1xyXG4vLyBQcm9kdWN0LmJlbG9uZ3NUb01hbnkoT3JkZXIse1xyXG4vLyAgICAgc291cmNlS2V5OiAnaWQnLFxyXG4vLyAgICAgdGFyZ2V0S2V5OiAnaWQnLFxyXG4vLyAgICAgZm9yZWlnbktleTogJ3Byb2R1Y3RJZCcsXHJcbi8vICAgICBvdGhlcktleTogJ29yZGVySWQnLFxyXG4vLyAgICAgdW5pcXVlS2V5OiAnaWQnLCAgXHJcbi8vICAgICB0aHJvdWdoOiAnb3JkZXJJdGVtJyxcclxuLy8gfSk7XHJcbmV4cG9ydCBkZWZhdWx0IFByb2R1Y3Q7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/models/product.ts\n");

/***/ }),

/***/ "./src/models/user.ts":
/*!****************************!*\
  !*** ./src/models/user.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _cart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cart */ \"./src/models/cart.ts\");\n/* harmony import */ var _util_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/database */ \"./src/util/database.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_2__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\nclass User {\r\n    /**\r\n     *\r\n     */\r\n    constructor(name, email, id, cart) {\r\n        this.name = name;\r\n        this.email = email;\r\n        this._id = id ? id : undefined;\r\n        this.cart = cart ? cart : new _cart__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\n    }\r\n    addOrder() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            const productsData = yield this.cart.fetchProducts();\r\n            const price = _cart__WEBPACK_IMPORTED_MODULE_0__[\"default\"].countPrice(productsData);\r\n            yield db.collection('orders').insertOne({\r\n                userId: this._id,\r\n                cart: this.cart,\r\n                price: price\r\n            });\r\n            yield this.removeFromCartAll();\r\n        });\r\n    }\r\n    getOrders() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            const orders = yield db.collection('orders').find({\r\n                userId: this._id\r\n            }).toArray();\r\n            const productIds = Object.keys(orders.reduce((ids, order) => {\r\n                for (const product of order.cart.products) {\r\n                    ids[product.productId] = true;\r\n                }\r\n                return ids;\r\n            }, {})).map(p => new mongodb__WEBPACK_IMPORTED_MODULE_2__[\"ObjectId\"](p));\r\n            const products = yield db.collection('products').find({\r\n                _id: { $in: productIds }\r\n            }).toArray();\r\n            const idToProduct = new Map(products.map(p => [p._id.toHexString(), p]));\r\n            const ordersWithProducts = orders.map(order => ({\r\n                products: order.cart.products.map(({ productId, cnt }) => ({\r\n                    product: idToProduct.get(productId.toHexString()),\r\n                    cnt: cnt\r\n                })),\r\n                price: order.price,\r\n                _id: order._id\r\n            }));\r\n            return ordersWithProducts;\r\n        });\r\n    }\r\n    addToCart(productId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const index = this.cart.products.findIndex(a => a.productId.equals(productId));\r\n            if (index !== -1) {\r\n                this.cart.products[index].cnt++;\r\n            }\r\n            else {\r\n                this.cart.products.push({\r\n                    productId: productId,\r\n                    cnt: 1\r\n                });\r\n            }\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            yield db.collection('users').updateOne({ _id: this._id }, { $set: {\r\n                    cart: this.cart\r\n                } });\r\n        });\r\n    }\r\n    removeFromCartOne(productId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const index = this.cart.products.findIndex(a => a.productId.equals(productId));\r\n            if (index !== -1) {\r\n                this.cart.products[index].cnt--;\r\n                if (this.cart.products[index].cnt === 0)\r\n                    this.cart.products.splice(index, 1);\r\n            }\r\n            else {\r\n                throw 'ERROR - removeFromCartOne: id doesn\\'t exist';\r\n            }\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            yield db.collection('users').updateOne({ _id: this._id }, { $set: {\r\n                    cart: this.cart\r\n                } });\r\n        });\r\n    }\r\n    static removeProductFromCarts(productId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            yield db.collection('users').updateMany({}, {\r\n                $pull: {\r\n                    'cart.products': { productId: productId }\r\n                }\r\n            });\r\n        });\r\n    }\r\n    removeFromCartAll(productId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (productId === undefined) {\r\n                const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n                this.cart.products = [];\r\n                yield db.collection('users').updateOne({ _id: this._id }, { $set: {\r\n                        cart: this.cart\r\n                    } });\r\n                return;\r\n            }\r\n            const index = this.cart.products.findIndex(a => a.productId.equals(productId));\r\n            if (index !== -1) {\r\n                this.cart.products.splice(index, 1);\r\n            }\r\n            else {\r\n                throw 'ERROR - removeFromCartOne: id doesn\\'t exist';\r\n            }\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            yield db.collection('users').updateOne({ _id: this._id }, { $set: {\r\n                    cart: this.cart\r\n                } });\r\n        });\r\n    }\r\n    static dataToUser(data) {\r\n        return new User(data.name, data.email, data._id, _cart__WEBPACK_IMPORTED_MODULE_0__[\"default\"].dataToCart(data.cart));\r\n    }\r\n    static fetchAll() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])().collection('users')\r\n                .find()\r\n                .map(p => this.dataToUser(p))\r\n                .toArray();\r\n        });\r\n    }\r\n    static findById(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.dataToUser(yield Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])().collection('users')\r\n                .findOne({ _id: id }));\r\n        });\r\n    }\r\n    static deleteById(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])().collection('users')\r\n                .deleteOne({ _id: id });\r\n        });\r\n    }\r\n    save() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const db = Object(_util_database__WEBPACK_IMPORTED_MODULE_1__[\"getDb\"])();\r\n            if (this._id) {\r\n                const results = yield db.collection('users')\r\n                    .updateOne({ _id: this._id }, { $set: this });\r\n            }\r\n            else {\r\n                const results = yield db.collection('users').insertOne(this);\r\n                this._id = results.insertedId;\r\n            }\r\n        });\r\n    }\r\n}\r\n// export interface UserAttributes {\r\n//     id: number,\r\n//     name: string,\r\n//     email: string,\r\n// }\r\n// interface UserCreationAttributes extends Optional<UserAttributes, \"id\"> { }\r\n// class User extends Model<UserAttributes, UserCreationAttributes>\r\n//     implements UserAttributes {\r\n//     public id!: number;\r\n//     public name!: string;\r\n//     public email!: string;\r\n//     // timestamps!\r\n//     public readonly createdAt!: Date;\r\n//     public readonly updatedAt!: Date;\r\n//     public getCart!: HasOneGetAssociationMixin<Cart>;\r\n//     public createCart!: HasOneCreateAssociationMixin<Cart>;\r\n//     public getProducts!: HasManyGetAssociationsMixin<Product>;\r\n//     public addProduct!: HasManyAddAssociationMixin<Product, number>;\r\n//     public addProducts!: HasManyAddAssociationsMixin<Product, number>;\r\n//     public hasProduct!: HasManyHasAssociationMixin<Product, number>;\r\n//     public countProducts!: HasManyCountAssociationsMixin;\r\n//     public createProduct!: HasManyCreateAssociationMixin<Product>;\r\n//     public getOrders!: HasManyGetAssociationsMixin<Order>;\r\n//     public addOrder!: HasManyAddAssociationMixin<Order, number>;\r\n//     public addOrders!: HasManyAddAssociationsMixin<Order, number>;\r\n//     public hasOrder!: HasManyHasAssociationMixin<Order, number>;\r\n//     public countOrders!: HasManyCountAssociationsMixin;\r\n//     public createOrder!: HasManyCreateAssociationMixin<Order>;\r\n//     public readonly products?: Product[]; // Note this is optional since it's only populated when explicitly requested in code\r\n//     public readonly orderss?: Order[]; // Note this is optional since it's only populated when explicitly requested in code\r\n//     public readonly cart?: Cart; // Note this is optional since it's only populated when explicitly requested in code\r\n//     public static associations: {\r\n//         products: Association<User, Product>;\r\n//         orders: Association<User, Order>;\r\n//         cart: Association<User, Cart>;\r\n//     };\r\n// }\r\n// User.init({\r\n//     id: {\r\n//         type: DataTypes.INTEGER,\r\n//         autoIncrement: true,\r\n//         allowNull: false,\r\n//         primaryKey: true\r\n//     },\r\n//     name: {\r\n//         type: DataTypes.STRING,\r\n//         allowNull: false\r\n//     },\r\n//     email: {\r\n//         type: DataTypes.STRING,\r\n//         allowNull: false,\r\n//     },\r\n// }, {\r\n//     tableName: 'users',\r\n//     sequelize: TutorialSequelize\r\n// });\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (User);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWxzL3VzZXIudHM/M2EzZCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUUwQjtBQUNlO0FBR1E7QUFHakQsTUFBTSxJQUFJO0lBS047O09BRUc7SUFDSCxZQUFZLElBQVcsRUFBQyxLQUFZLEVBQUUsRUFBWSxFQUFFLElBQVU7UUFDMUQsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQy9CLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxFQUFDLEtBQUksRUFBQyxLQUFJLDZDQUFJLEVBQUUsQ0FBQztJQUNyQyxDQUFDO0lBRUssUUFBUTs7WUFDVixNQUFNLEVBQUUsR0FBRyw0REFBSyxFQUFFLENBQUM7WUFDbkIsTUFBTSxZQUFZLEdBQUcsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ3JELE1BQU0sS0FBSyxHQUFHLDZDQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRTVDLE1BQU0sRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3BDLE1BQU0sRUFBRSxJQUFJLENBQUMsR0FBRztnQkFDaEIsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO2dCQUNmLEtBQUssRUFBRSxLQUFLO2FBQUMsQ0FBQyxDQUFDO1lBQ25CLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDbkMsQ0FBQztLQUFBO0lBQ0ssU0FBUzs7WUFDWCxNQUFNLEVBQUUsR0FBRyw0REFBSyxFQUFFLENBQUM7WUFDbkIsTUFBTSxNQUFNLEdBQUcsTUFBTSxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElB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Q2xDLDBCQUEwQjtBQUMxQiw0QkFBNEI7QUFDNUIsNkJBQTZCO0FBRTdCLHFCQUFxQjtBQUNyQix3Q0FBd0M7QUFDeEMsd0NBQXdDO0FBRXhDLHdEQUF3RDtBQUN4RCw4REFBOEQ7QUFFOUQsaUVBQWlFO0FBQ2pFLHVFQUF1RTtBQUN2RSx5RUFBeUU7QUFDekUsdUVBQXVFO0FBQ3ZFLDREQUE0RDtBQUM1RCxxRUFBcUU7QUFFckUsNkRBQTZEO0FBQzdELG1FQUFtRTtBQUNuRSxxRUFBcUU7QUFDckUsbUVBQW1FO0FBQ25FLDBEQUEwRDtBQUMxRCxpRUFBaUU7QUFFakUsaUlBQWlJO0FBQ2pJLDhIQUE4SDtBQUM5SCx3SEFBd0g7QUFFeEgsb0NBQW9DO0FBQ3BDLGdEQUFnRDtBQUNoRCw0Q0FBNEM7QUFDNUMseUNBQXlDO0FBQ3pDLFNBQVM7QUFDVCxJQUFJO0FBQ0osY0FBYztBQUNkLFlBQVk7QUFDWixtQ0FBbUM7QUFDbkMsK0JBQStCO0FBQy9CLDRCQUE0QjtBQUM1QiwyQkFBMkI7QUFDM0IsU0FBUztBQUNULGNBQWM7QUFDZCxrQ0FBa0M7QUFDbEMsMkJBQTJCO0FBQzNCLFNBQVM7QUFDVCxlQUFlO0FBQ2Ysa0NBQWtDO0FBQ2xDLDRCQUE0QjtBQUM1QixTQUFTO0FBQ1QsT0FBTztBQUNQLDBCQUEwQjtBQUMxQixtQ0FBbUM7QUFDbkMsTUFBTTtBQUdTLG1FQUFJLEVBQUMiLCJmaWxlIjoiLi9zcmMvbW9kZWxzL3VzZXIudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCBDYXJ0IGZyb20gJy4vY2FydCc7XHJcbmltcG9ydCB7IGdldERiIH0gZnJvbSAnLi4vdXRpbC9kYXRhYmFzZSc7XHJcbmltcG9ydCB7IE1vZGVsLCBEYXRhVHlwZXMsIE9wdGlvbmFsLCBIYXNPbmVHZXRBc3NvY2lhdGlvbk1peGluLCBBc3NvY2lhdGlvbiB9IGZyb20gJ3NlcXVlbGl6ZSc7XHJcbmltcG9ydCBtb25nb0NvbmVjdCBmcm9tICcuLi91dGlsL2RhdGFiYXNlJztcclxuaW1wb3J0IHsgRGIsIE9iamVjdElkLCBPYmplY3RJRCB9IGZyb20gJ21vbmdvZGInO1xyXG5pbXBvcnQgUHJvZHVjdCBmcm9tICcuL3Byb2R1Y3QnO1xyXG5cclxuY2xhc3MgVXNlcntcclxuICAgIF9pZD86IE9iamVjdElkO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgZW1haWw6IHN0cmluZztcclxuICAgIGNhcnQ6Q2FydDtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IobmFtZTpzdHJpbmcsZW1haWw6c3RyaW5nLCBpZD86T2JqZWN0SWQsIGNhcnQ/OkNhcnQpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuZW1haWwgPSBlbWFpbDtcclxuICAgICAgICB0aGlzLl9pZCA9IGlkID8gaWQgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5jYXJ0ID0gY2FydD9jYXJ0Om5ldyBDYXJ0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYWRkT3JkZXIoKXtcclxuICAgICAgICBjb25zdCBkYiA9IGdldERiKCk7XHJcbiAgICAgICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgdGhpcy5jYXJ0LmZldGNoUHJvZHVjdHMoKTtcclxuICAgICAgICBjb25zdCBwcmljZSA9IENhcnQuY291bnRQcmljZShwcm9kdWN0c0RhdGEpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdvcmRlcnMnKS5pbnNlcnRPbmUoe1xyXG4gICAgICAgICAgICB1c2VySWQ6IHRoaXMuX2lkLFxyXG4gICAgICAgICAgICBjYXJ0OiB0aGlzLmNhcnQsXHJcbiAgICAgICAgICAgIHByaWNlOiBwcmljZX0pO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucmVtb3ZlRnJvbUNhcnRBbGwoKTtcclxuICAgIH1cclxuICAgIGFzeW5jIGdldE9yZGVycygpe1xyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBjb25zdCBvcmRlcnMgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdvcmRlcnMnKS5maW5kKHtcclxuICAgICAgICAgICAgdXNlcklkOiB0aGlzLl9pZFxyXG4gICAgICAgIH0pLnRvQXJyYXkoKTtcclxuICAgICAgICBjb25zdCBwcm9kdWN0SWRzID0gT2JqZWN0LmtleXMob3JkZXJzLnJlZHVjZSgoaWRzLCBvcmRlcik9PntcclxuICAgICAgICAgICAgZm9yKGNvbnN0IHByb2R1Y3Qgb2Ygb3JkZXIuY2FydC5wcm9kdWN0cyl7XHJcbiAgICAgICAgICAgICAgICBpZHNbcHJvZHVjdC5wcm9kdWN0SWRdID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaWRzO1xyXG4gICAgICAgIH0sIHt9KSkubWFwKHA9Pm5ldyBPYmplY3RJZChwKSk7XHJcbiAgICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdwcm9kdWN0cycpLmZpbmQoe1xyXG4gICAgICAgICAgICBfaWQ6IHskaW46IHByb2R1Y3RJZHN9XHJcbiAgICAgICAgfSkudG9BcnJheSgpO1xyXG4gICAgICAgIGNvbnN0IGlkVG9Qcm9kdWN0ID0gbmV3IE1hcDxzdHJpbmcsIFByb2R1Y3Q+KHByb2R1Y3RzLm1hcChwPT5bcC5faWQudG9IZXhTdHJpbmcoKSwgcF0pKTtcclxuICAgICAgICBjb25zdCBvcmRlcnNXaXRoUHJvZHVjdHMgPSBvcmRlcnMubWFwKG9yZGVyPT4oe1xyXG4gICAgICAgICAgICBwcm9kdWN0czogKG9yZGVyLmNhcnQgYXMgQ2FydCkucHJvZHVjdHMubWFwKCh7cHJvZHVjdElkLCBjbnR9KT0+KHtcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGlkVG9Qcm9kdWN0LmdldChwcm9kdWN0SWQudG9IZXhTdHJpbmcoKSkhLFxyXG4gICAgICAgICAgICAgICAgY250OiBjbnRcclxuICAgICAgICAgICAgfSkpLFxyXG4gICAgICAgICAgICBwcmljZTogb3JkZXIucHJpY2UsXHJcbiAgICAgICAgICAgIF9pZDogb3JkZXIuX2lkXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHJldHVybiBvcmRlcnNXaXRoUHJvZHVjdHM7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYWRkVG9DYXJ0KHByb2R1Y3RJZDpPYmplY3RJZCl7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNhcnQucHJvZHVjdHMuZmluZEluZGV4KGE9PmEucHJvZHVjdElkLmVxdWFscyhwcm9kdWN0SWQpKTtcclxuICAgICAgICBpZihpbmRleCAhPT0gLTEpe1xyXG4gICAgICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHNbaW5kZXhdLmNudCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIGNudDogMVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGIgPSBnZXREYigpO1xyXG4gICAgICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykudXBkYXRlT25lKFxyXG4gICAgICAgICAgICB7X2lkOiB0aGlzLl9pZH0sXHJcbiAgICAgICAgICAgIHskc2V0OntcclxuICAgICAgICAgICAgICAgIGNhcnQ6IHRoaXMuY2FydFxyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBhc3luYyByZW1vdmVGcm9tQ2FydE9uZShwcm9kdWN0SWQ6T2JqZWN0SWQpe1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jYXJ0LnByb2R1Y3RzLmZpbmRJbmRleChhPT5hLnByb2R1Y3RJZC5lcXVhbHMocHJvZHVjdElkKSk7XHJcbiAgICAgICAgaWYoaW5kZXggIT09IC0xKXtcclxuICAgICAgICAgICAgdGhpcy5jYXJ0LnByb2R1Y3RzW2luZGV4XS5jbnQtLTtcclxuICAgICAgICAgICAgaWYodGhpcy5jYXJ0LnByb2R1Y3RzW2luZGV4XS5jbnQgPT09IDApXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhyb3cgJ0VSUk9SIC0gcmVtb3ZlRnJvbUNhcnRPbmU6IGlkIGRvZXNuXFwndCBleGlzdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCd1c2VycycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAge19pZDogdGhpcy5faWR9LFxyXG4gICAgICAgICAgICB7JHNldDp7XHJcbiAgICAgICAgICAgICAgICBjYXJ0OiB0aGlzLmNhcnRcclxuICAgICAgICAgICAgfX1cclxuICAgICAgICApXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgcmVtb3ZlUHJvZHVjdEZyb21DYXJ0cyhwcm9kdWN0SWQ6T2JqZWN0SWQpe1xyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCd1c2VycycpLnVwZGF0ZU1hbnkoe30se1xyXG4gICAgICAgICAgICAkcHVsbDp7XHJcbiAgICAgICAgICAgICAgICAnY2FydC5wcm9kdWN0cyc6IHtwcm9kdWN0SWQ6IHByb2R1Y3RJZH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgcmVtb3ZlRnJvbUNhcnRBbGwocHJvZHVjdElkPzpPYmplY3RJZCl7XHJcbiAgICAgICAgaWYocHJvZHVjdElkID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBjb25zdCBkYiA9IGdldERiKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FydC5wcm9kdWN0cyA9IFtdO1xyXG4gICAgICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCd1c2VycycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAgICAgIHtfaWQ6IHRoaXMuX2lkfSxcclxuICAgICAgICAgICAgICAgIHskc2V0OntcclxuICAgICAgICAgICAgICAgICAgICBjYXJ0OiB0aGlzLmNhcnRcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNhcnQucHJvZHVjdHMuZmluZEluZGV4KGE9PmEucHJvZHVjdElkLmVxdWFscyhwcm9kdWN0SWQpKTtcclxuICAgICAgICBpZihpbmRleCAhPT0gLTEpe1xyXG4gICAgICAgICAgICB0aGlzLmNhcnQucHJvZHVjdHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhyb3cgJ0VSUk9SIC0gcmVtb3ZlRnJvbUNhcnRPbmU6IGlkIGRvZXNuXFwndCBleGlzdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRiID0gZ2V0RGIoKTtcclxuICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCd1c2VycycpLnVwZGF0ZU9uZShcclxuICAgICAgICAgICAge19pZDogdGhpcy5faWR9LFxyXG4gICAgICAgICAgICB7JHNldDp7XHJcbiAgICAgICAgICAgICAgICBjYXJ0OiB0aGlzLmNhcnRcclxuICAgICAgICAgICAgfX1cclxuICAgICAgICApXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZGF0YVRvVXNlcihkYXRhOmFueSl7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBVc2VyKFxyXG4gICAgICAgICAgICBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgIGRhdGEuZW1haWwsXHJcbiAgICAgICAgICAgIGRhdGEuX2lkLFxyXG4gICAgICAgICAgICBDYXJ0LmRhdGFUb0NhcnQoZGF0YS5jYXJ0KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgZmV0Y2hBbGwoKXtcclxuICAgICAgICByZXR1cm4gYXdhaXQgZ2V0RGIoKS5jb2xsZWN0aW9uKCd1c2VycycpXHJcbiAgICAgICAgICAgIC5maW5kKClcclxuICAgICAgICAgICAgLm1hcChwPT50aGlzLmRhdGFUb1VzZXIocCkpXHJcbiAgICAgICAgICAgIC50b0FycmF5KCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgZmluZEJ5SWQoaWQ6T2JqZWN0SWQpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFUb1VzZXIoIFxyXG4gICAgICAgICAgICBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuICAgICAgICAgICAgICAgIC5maW5kT25lKHtfaWQ6IGlkfSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGFzeW5jIGRlbGV0ZUJ5SWQoaWQ6T2JqZWN0SWQpe1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBnZXREYigpLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuICAgICAgICAgIC5kZWxldGVPbmUoe19pZDppZH0pO1xyXG4gICAgfSAgXHJcbiAgICBhc3luYyBzYXZlKCl7XHJcbiAgICAgICAgY29uc3QgZGIgPSBnZXREYigpO1xyXG4gICAgICAgIGlmKHRoaXMuX2lkKXtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJylcclxuICAgICAgICAgICAgICAgIC51cGRhdGVPbmUoe19pZDogdGhpcy5faWR9LCB7JHNldDogdGhpc30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuY29sbGVjdGlvbigndXNlcnMnKS5pbnNlcnRPbmUodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2lkID0gcmVzdWx0cy5pbnNlcnRlZElkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8vIGV4cG9ydCBpbnRlcmZhY2UgVXNlckF0dHJpYnV0ZXMge1xyXG4vLyAgICAgaWQ6IG51bWJlcixcclxuLy8gICAgIG5hbWU6IHN0cmluZyxcclxuLy8gICAgIGVtYWlsOiBzdHJpbmcsXHJcbi8vIH1cclxuLy8gaW50ZXJmYWNlIFVzZXJDcmVhdGlvbkF0dHJpYnV0ZXMgZXh0ZW5kcyBPcHRpb25hbDxVc2VyQXR0cmlidXRlcywgXCJpZFwiPiB7IH1cclxuXHJcblxyXG4vLyBjbGFzcyBVc2VyIGV4dGVuZHMgTW9kZWw8VXNlckF0dHJpYnV0ZXMsIFVzZXJDcmVhdGlvbkF0dHJpYnV0ZXM+XHJcbi8vICAgICBpbXBsZW1lbnRzIFVzZXJBdHRyaWJ1dGVzIHtcclxuLy8gICAgIHB1YmxpYyBpZCE6IG51bWJlcjtcclxuLy8gICAgIHB1YmxpYyBuYW1lITogc3RyaW5nO1xyXG4vLyAgICAgcHVibGljIGVtYWlsITogc3RyaW5nO1xyXG5cclxuLy8gICAgIC8vIHRpbWVzdGFtcHMhXHJcbi8vICAgICBwdWJsaWMgcmVhZG9ubHkgY3JlYXRlZEF0ITogRGF0ZTtcclxuLy8gICAgIHB1YmxpYyByZWFkb25seSB1cGRhdGVkQXQhOiBEYXRlO1xyXG5cclxuLy8gICAgIHB1YmxpYyBnZXRDYXJ0ITogSGFzT25lR2V0QXNzb2NpYXRpb25NaXhpbjxDYXJ0PjtcclxuLy8gICAgIHB1YmxpYyBjcmVhdGVDYXJ0ITogSGFzT25lQ3JlYXRlQXNzb2NpYXRpb25NaXhpbjxDYXJ0PjtcclxuXHJcbi8vICAgICBwdWJsaWMgZ2V0UHJvZHVjdHMhOiBIYXNNYW55R2V0QXNzb2NpYXRpb25zTWl4aW48UHJvZHVjdD47XHJcbi8vICAgICBwdWJsaWMgYWRkUHJvZHVjdCE6IEhhc01hbnlBZGRBc3NvY2lhdGlvbk1peGluPFByb2R1Y3QsIG51bWJlcj47XHJcbi8vICAgICBwdWJsaWMgYWRkUHJvZHVjdHMhOiBIYXNNYW55QWRkQXNzb2NpYXRpb25zTWl4aW48UHJvZHVjdCwgbnVtYmVyPjtcclxuLy8gICAgIHB1YmxpYyBoYXNQcm9kdWN0ITogSGFzTWFueUhhc0Fzc29jaWF0aW9uTWl4aW48UHJvZHVjdCwgbnVtYmVyPjtcclxuLy8gICAgIHB1YmxpYyBjb3VudFByb2R1Y3RzITogSGFzTWFueUNvdW50QXNzb2NpYXRpb25zTWl4aW47XHJcbi8vICAgICBwdWJsaWMgY3JlYXRlUHJvZHVjdCE6IEhhc01hbnlDcmVhdGVBc3NvY2lhdGlvbk1peGluPFByb2R1Y3Q+O1xyXG4gICAgXHJcbi8vICAgICBwdWJsaWMgZ2V0T3JkZXJzITogSGFzTWFueUdldEFzc29jaWF0aW9uc01peGluPE9yZGVyPjtcclxuLy8gICAgIHB1YmxpYyBhZGRPcmRlciE6IEhhc01hbnlBZGRBc3NvY2lhdGlvbk1peGluPE9yZGVyLCBudW1iZXI+O1xyXG4vLyAgICAgcHVibGljIGFkZE9yZGVycyE6IEhhc01hbnlBZGRBc3NvY2lhdGlvbnNNaXhpbjxPcmRlciwgbnVtYmVyPjtcclxuLy8gICAgIHB1YmxpYyBoYXNPcmRlciE6IEhhc01hbnlIYXNBc3NvY2lhdGlvbk1peGluPE9yZGVyLCBudW1iZXI+O1xyXG4vLyAgICAgcHVibGljIGNvdW50T3JkZXJzITogSGFzTWFueUNvdW50QXNzb2NpYXRpb25zTWl4aW47XHJcbi8vICAgICBwdWJsaWMgY3JlYXRlT3JkZXIhOiBIYXNNYW55Q3JlYXRlQXNzb2NpYXRpb25NaXhpbjxPcmRlcj47XHJcblxyXG4vLyAgICAgcHVibGljIHJlYWRvbmx5IHByb2R1Y3RzPzogUHJvZHVjdFtdOyAvLyBOb3RlIHRoaXMgaXMgb3B0aW9uYWwgc2luY2UgaXQncyBvbmx5IHBvcHVsYXRlZCB3aGVuIGV4cGxpY2l0bHkgcmVxdWVzdGVkIGluIGNvZGVcclxuLy8gICAgIHB1YmxpYyByZWFkb25seSBvcmRlcnNzPzogT3JkZXJbXTsgLy8gTm90ZSB0aGlzIGlzIG9wdGlvbmFsIHNpbmNlIGl0J3Mgb25seSBwb3B1bGF0ZWQgd2hlbiBleHBsaWNpdGx5IHJlcXVlc3RlZCBpbiBjb2RlXHJcbi8vICAgICBwdWJsaWMgcmVhZG9ubHkgY2FydD86IENhcnQ7IC8vIE5vdGUgdGhpcyBpcyBvcHRpb25hbCBzaW5jZSBpdCdzIG9ubHkgcG9wdWxhdGVkIHdoZW4gZXhwbGljaXRseSByZXF1ZXN0ZWQgaW4gY29kZVxyXG5cclxuLy8gICAgIHB1YmxpYyBzdGF0aWMgYXNzb2NpYXRpb25zOiB7XHJcbi8vICAgICAgICAgcHJvZHVjdHM6IEFzc29jaWF0aW9uPFVzZXIsIFByb2R1Y3Q+O1xyXG4vLyAgICAgICAgIG9yZGVyczogQXNzb2NpYXRpb248VXNlciwgT3JkZXI+O1xyXG4vLyAgICAgICAgIGNhcnQ6IEFzc29jaWF0aW9uPFVzZXIsIENhcnQ+O1xyXG4vLyAgICAgfTtcclxuLy8gfVxyXG4vLyBVc2VyLmluaXQoe1xyXG4vLyAgICAgaWQ6IHtcclxuLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuSU5URUdFUixcclxuLy8gICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlLFxyXG4vLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2UsXHJcbi8vICAgICAgICAgcHJpbWFyeUtleTogdHJ1ZVxyXG4vLyAgICAgfSxcclxuLy8gICAgIG5hbWU6IHtcclxuLy8gICAgICAgICB0eXBlOiBEYXRhVHlwZXMuU1RSSU5HLFxyXG4vLyAgICAgICAgIGFsbG93TnVsbDogZmFsc2VcclxuLy8gICAgIH0sXHJcbi8vICAgICBlbWFpbDoge1xyXG4vLyAgICAgICAgIHR5cGU6IERhdGFUeXBlcy5TVFJJTkcsXHJcbi8vICAgICAgICAgYWxsb3dOdWxsOiBmYWxzZSxcclxuLy8gICAgIH0sXHJcbi8vIH0sIHtcclxuLy8gICAgIHRhYmxlTmFtZTogJ3VzZXJzJyxcclxuLy8gICAgIHNlcXVlbGl6ZTogVHV0b3JpYWxTZXF1ZWxpemVcclxuLy8gfSk7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlcjsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/models/user.ts\n");

/***/ }),

/***/ "./src/routes/admin.ts":
/*!*****************************!*\
  !*** ./src/routes/admin.ts ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _controllers_admin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controllers/admin */ \"./src/controllers/admin.ts\");\n\r\n\r\nconst adminRouter = Object(express__WEBPACK_IMPORTED_MODULE_0__[\"Router\"])();\r\nadminRouter.get('/add-product', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getAddProduct\"]);\r\nadminRouter.get('/products', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getAdminProducts\"]);\r\nadminRouter.post('/add-product', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postAddProduct\"]);\r\nadminRouter.post('/delete-product/:id', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postDeleteProduct\"]);\r\nadminRouter.get('/edit-product/:id', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"getEditProduct\"]);\r\nadminRouter.post('/edit-product/:id', _controllers_admin__WEBPACK_IMPORTED_MODULE_1__[\"postEditProduct\"]);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (adminRouter);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL2FkbWluLnRzPzNmNTEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDdUI7QUFFeEQsTUFBTSxXQUFXLEdBQUcsc0RBQU0sRUFBRSxDQUFDO0FBRTdCLFdBQVcsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLGdFQUE2QixDQUFDLENBQUM7QUFDL0QsV0FBVyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsbUVBQWdDLENBQUMsQ0FBQztBQUMvRCxXQUFXLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxpRUFBOEIsQ0FBQyxDQUFDO0FBQ2pFLFdBQVcsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsb0VBQWlDLENBQUM7QUFDMUUsV0FBVyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxpRUFBOEIsQ0FBQztBQUNwRSxXQUFXLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLGtFQUErQixDQUFDO0FBRXZELDBFQUFXLEVBQUMiLCJmaWxlIjoiLi9zcmMvcm91dGVzL2FkbWluLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSBcImV4cHJlc3NcIjtcclxuaW1wb3J0ICogYXMgQWRtaW5Db250cm9sbGVyIGZyb20gXCIuLi9jb250cm9sbGVycy9hZG1pblwiO1xyXG5cclxuY29uc3QgYWRtaW5Sb3V0ZXIgPSBSb3V0ZXIoKTtcclxuXHJcbmFkbWluUm91dGVyLmdldCgnL2FkZC1wcm9kdWN0JywgQWRtaW5Db250cm9sbGVyLmdldEFkZFByb2R1Y3QpO1xyXG5hZG1pblJvdXRlci5nZXQoJy9wcm9kdWN0cycsIEFkbWluQ29udHJvbGxlci5nZXRBZG1pblByb2R1Y3RzKTtcclxuYWRtaW5Sb3V0ZXIucG9zdCgnL2FkZC1wcm9kdWN0JywgQWRtaW5Db250cm9sbGVyLnBvc3RBZGRQcm9kdWN0KTtcclxuYWRtaW5Sb3V0ZXIucG9zdCgnL2RlbGV0ZS1wcm9kdWN0LzppZCcsIEFkbWluQ29udHJvbGxlci5wb3N0RGVsZXRlUHJvZHVjdClcclxuYWRtaW5Sb3V0ZXIuZ2V0KCcvZWRpdC1wcm9kdWN0LzppZCcsIEFkbWluQ29udHJvbGxlci5nZXRFZGl0UHJvZHVjdClcclxuYWRtaW5Sb3V0ZXIucG9zdCgnL2VkaXQtcHJvZHVjdC86aWQnLCBBZG1pbkNvbnRyb2xsZXIucG9zdEVkaXRQcm9kdWN0KVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYWRtaW5Sb3V0ZXI7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/routes/admin.ts\n");

/***/ }),

/***/ "./src/routes/shop.ts":
/*!****************************!*\
  !*** ./src/routes/shop.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _controllers_shop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controllers/shop */ \"./src/controllers/shop.ts\");\n\r\n\r\nconst shopRouter = Object(express__WEBPACK_IMPORTED_MODULE_0__[\"Router\"])();\r\nshopRouter.get('/', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getIndex\"]);\r\nshopRouter.get('/products', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getProducts\"]);\r\nshopRouter.get('/products/:id', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getProduct\"]);\r\nshopRouter.get('/cart', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getCart\"]);\r\nshopRouter.post('/cart', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCart\"]);\r\nshopRouter.post('/cart-delete-item', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCartDeleteItem\"]);\r\nshopRouter.post('/cart-delete-items', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCartDeleteItems\"]);\r\n// shopRouter.get('/checkout', ShopController.getCheckout);\r\nshopRouter.get('/orders', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"getOrders\"]);\r\nshopRouter.post('/create-order', _controllers_shop__WEBPACK_IMPORTED_MODULE_1__[\"postCreateOrder\"]);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (shopRouter);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL3Nob3AudHM/M2ZjNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNxQjtBQUN0RCxNQUFNLFVBQVUsR0FBRyxzREFBTSxFQUFFLENBQUM7QUFFNUIsVUFBVSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsMERBQXVCLENBQUMsQ0FBQztBQUM3QyxVQUFVLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSw2REFBMEIsQ0FBQyxDQUFDO0FBQ3hELFVBQVUsQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFFLDREQUF5QixDQUFDLENBQUM7QUFDM0QsVUFBVSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUseURBQXNCLENBQUMsQ0FBQztBQUNoRCxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSwwREFBdUIsQ0FBQyxDQUFDO0FBQ2xELFVBQVUsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsb0VBQWlDLENBQUMsQ0FBQztBQUN4RSxVQUFVLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLHFFQUFrQyxDQUFDLENBQUM7QUFDMUUsMkRBQTJEO0FBQzNELFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLDJEQUF3QixDQUFDLENBQUM7QUFDcEQsVUFBVSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsaUVBQThCLENBQUMsQ0FBQztBQUNsRCx5RUFBVSxFQUFDIiwiZmlsZSI6Ii4vc3JjL3JvdXRlcy9zaG9wLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSBcImV4cHJlc3NcIjtcclxuaW1wb3J0ICogYXMgU2hvcENvbnRyb2xsZXIgZnJvbSBcIi4uL2NvbnRyb2xsZXJzL3Nob3BcIjtcclxuY29uc3Qgc2hvcFJvdXRlciA9IFJvdXRlcigpO1xyXG5cclxuc2hvcFJvdXRlci5nZXQoJy8nLCBTaG9wQ29udHJvbGxlci5nZXRJbmRleCk7XHJcbnNob3BSb3V0ZXIuZ2V0KCcvcHJvZHVjdHMnLCBTaG9wQ29udHJvbGxlci5nZXRQcm9kdWN0cyk7XHJcbnNob3BSb3V0ZXIuZ2V0KCcvcHJvZHVjdHMvOmlkJywgU2hvcENvbnRyb2xsZXIuZ2V0UHJvZHVjdCk7XHJcbnNob3BSb3V0ZXIuZ2V0KCcvY2FydCcsIFNob3BDb250cm9sbGVyLmdldENhcnQpO1xyXG5zaG9wUm91dGVyLnBvc3QoJy9jYXJ0JywgU2hvcENvbnRyb2xsZXIucG9zdENhcnQpO1xyXG5zaG9wUm91dGVyLnBvc3QoJy9jYXJ0LWRlbGV0ZS1pdGVtJywgU2hvcENvbnRyb2xsZXIucG9zdENhcnREZWxldGVJdGVtKTtcclxuc2hvcFJvdXRlci5wb3N0KCcvY2FydC1kZWxldGUtaXRlbXMnLCBTaG9wQ29udHJvbGxlci5wb3N0Q2FydERlbGV0ZUl0ZW1zKTtcclxuLy8gc2hvcFJvdXRlci5nZXQoJy9jaGVja291dCcsIFNob3BDb250cm9sbGVyLmdldENoZWNrb3V0KTtcclxuc2hvcFJvdXRlci5nZXQoJy9vcmRlcnMnLCBTaG9wQ29udHJvbGxlci5nZXRPcmRlcnMpO1xyXG5zaG9wUm91dGVyLnBvc3QoJy9jcmVhdGUtb3JkZXInLCBTaG9wQ29udHJvbGxlci5wb3N0Q3JlYXRlT3JkZXIpO1xyXG5leHBvcnQgZGVmYXVsdCBzaG9wUm91dGVyOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/routes/shop.ts\n");

/***/ }),

/***/ "./src/util/database.ts":
/*!******************************!*\
  !*** ./src/util/database.ts ***!
  \******************************/
/*! exports provided: getDb, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDb\", function() { return getDb; });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\nlet _db;\r\nconst mongoConect = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    try {\r\n        const client = yield mongodb__WEBPACK_IMPORTED_MODULE_0___default.a.connect('mongodb+srv://mati:G3aSiJHAv3ZOjSBE@cluster0.mvhqt.mongodb.net/tutorial?retryWrites=true&w=majority', {\r\n            useNewUrlParser: true,\r\n            useUnifiedTopology: true\r\n        });\r\n        _db = client.db();\r\n    }\r\n    catch (error) {\r\n        console.log(error);\r\n        throw error;\r\n    }\r\n});\r\nconst getDb = () => {\r\n    if (_db) {\r\n        return _db;\r\n    }\r\n    throw 'No database found!';\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (mongoConect);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9kYXRhYmFzZS50cz9iNmMyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBK0M7QUFHL0MsSUFBSSxHQUFjLENBQUM7QUFFbkIsTUFBTSxXQUFXLEdBQUcsR0FBUSxFQUFFO0lBQzVCLElBQUk7UUFDRixNQUFNLE1BQU0sR0FBRyxNQUFNLDhDQUFPLENBQUMsT0FBTyxDQUFDLHFHQUFxRyxFQUFDO1lBQ3pJLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLGtCQUFrQixFQUFFLElBQUk7U0FDekIsQ0FBQyxDQUFDO1FBQ0gsR0FBRyxHQUFHLE1BQU0sQ0FBQyxFQUFFLEVBQUUsQ0FBQztLQUNuQjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQixNQUFNLEtBQUssQ0FBQztLQUNiO0FBQ0gsQ0FBQztBQUNNLE1BQU0sS0FBSyxHQUFHLEdBQUUsRUFBRTtJQUN2QixJQUFHLEdBQUcsRUFBQztRQUNMLE9BQU8sR0FBRyxDQUFDO0tBQ1o7SUFDRCxNQUFNLG9CQUFvQixDQUFDO0FBQzdCLENBQUM7QUFFYywwRUFBVyxFQUFDIiwiZmlsZSI6Ii4vc3JjL3V0aWwvZGF0YWJhc2UudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29kYiwgeyBNb25nb0NsaWVudCB9IGZyb20gJ21vbmdvZGInO1xyXG5pbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnY29uc29sZSc7XHJcblxyXG5sZXQgX2RiOm1vbmdvZGIuRGI7XHJcblxyXG5jb25zdCBtb25nb0NvbmVjdCA9IGFzeW5jICgpPT57XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IG1vbmdvZGIuY29ubmVjdCgnbW9uZ29kYitzcnY6Ly9tYXRpOkczYVNpSkhBdjNaT2pTQkVAY2x1c3RlcjAubXZocXQubW9uZ29kYi5uZXQvdHV0b3JpYWw/cmV0cnlXcml0ZXM9dHJ1ZSZ3PW1ham9yaXR5Jyx7XHJcbiAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcclxuICAgICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlXHJcbiAgICB9KTtcclxuICAgIF9kYiA9IGNsaWVudC5kYigpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuZXhwb3J0IGNvbnN0IGdldERiID0gKCk9PntcclxuICBpZihfZGIpe1xyXG4gICAgcmV0dXJuIF9kYjtcclxuICB9XHJcbiAgdGhyb3cgJ05vIGRhdGFiYXNlIGZvdW5kISc7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1vbmdvQ29uZWN0OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/util/database.ts\n");

/***/ }),

/***/ "body-parser":
/*!******************************!*\
  !*** external "body-parser" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"body-parser\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiPzgxODgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYm9keS1wYXJzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///body-parser\n");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzXCI/MjJmZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJleHByZXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///express\n");

/***/ }),

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mongodb\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb25nb2RiXCI/ZGVmZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJtb25nb2RiLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibW9uZ29kYlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///mongodb\n");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"path\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwYXRoXCI/NzRiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJwYXRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicGF0aFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///path\n");

/***/ })

/******/ });